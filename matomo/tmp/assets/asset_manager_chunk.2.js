/* Matomo Javascript - cb=6cdd095d63eaf8299688721ccbe9df81*/

(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["Goals"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["Goals"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,a){return function(e){var t={};function a(l){if(t[l])return t[l].exports;var o=t[l]={i:l,l:!1,exports:{}};return e[l].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=e,a.c=t,a.d=function(e,t,l){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(l,o,function(t){return e[t]}.bind(null,o));return l},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="plugins/Goals/vue/dist/",a(a.s="fae3")}({"19dc":function(t,a){t.exports=e},"8bbf":function(e,a){e.exports=t},a5a2:function(e,t){e.exports=a},fae3:function(e,t,a){"use strict";if(a.r(t),a.d(t,"GoalPageLink",(function(){return c})),a.d(t,"ManageGoals",(function(){return Ge})),a.d(t,"ManageGoalsStore",(function(){return ve})),"undefined"!==typeof window){var l=window.document.currentScript,o=l&&l.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(a.p=o[1])}var n=a("19dc");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
const{$:r}=window,i={mounted(e,t){if(!n["Matomo"].helper.isReportingPage())return;const a=r(e).text(),l=r("<a></a>");l.text(a),l.attr("title",Object(n["translate"])("Goals_ClickToViewThisGoal")),l.click(e=>{e.preventDefault(),n["MatomoUrl"].updateHash(Object.assign(Object.assign({},n["MatomoUrl"].hashParsed.value),{},{category:"Goals_Goals",subcategory:t.value.idGoal}))}),r(e).html(l[0])}};var c=i;n["Matomo"].on("Matomo.processDynamicHtml",e=>{e.find("[goal-page-link]").each((e,t)=>{if(r(t).attr("goal-page-link-handled"))return;const a=r(t).attr("goal-page-link");a&&i.mounted(t,{instance:null,value:{idGoal:a},oldValue:null,modifiers:{},dir:{}}),r(t).attr("goal-page-link-handled","1")})});var s=a("8bbf");const d={class:"manageGoals"},u={id:"entityEditContainer",feature:"true",class:"managegoals"},b={class:"contentHelp"},m=["innerHTML"],p={key:0},O=Object(s["createElementVNode"])("br",null,null,-1),j=Object(s["createElementVNode"])("br",null,null,-1),h=["innerHTML"],g={class:"first"},v={key:1},y={key:0},_={colspan:"8"},G=Object(s["createElementVNode"])("br",null,null,-1),E=Object(s["createElementVNode"])("br",null,null,-1),V=Object(s["createElementVNode"])("br",null,null,-1),N=["id"],w={class:"first"},f={class:"matchAttribute"},S={key:0},T={key:1},D=Object(s["createElementVNode"])("br",null,null,-1),C=["innerHTML"],k={key:1,style:{"padding-top":"2px"}},x=["onClick","title"],M=["onClick","title"],A={key:0,class:"tableActionBar"},B=Object(s["createElementVNode"])("span",{class:"icon-add"},null,-1),L={class:"ui-confirm",ref:"confirm"},H=["value"],F=["value"],U={class:"addEditGoal"},P=["innerHTML"],$={class:"row goalIsTriggeredWhen"},I={class:"col s12"},R={class:"row"},z={class:"col s12 m6 goalTriggerType"},q={class:"col s12 m6"},W=["innerHTML"],J={class:"row whereTheMatchAttrbiute"},Y={class:"col s12"},K={class:"row"},Q={class:"col s12 m6 l4"},X={key:0,class:"col s12 m6 l4"},Z={key:1,class:"col s12 m6 l4"},ee={class:"col s12 m6 l4"},te={id:"examples_pattern",class:"col s12"},ae=Object(s["createElementVNode"])("br",null,null,-1),le=Object(s["createElementVNode"])("br",null,null,-1),oe=Object(s["createElementVNode"])("br",null,null,-1),ne=Object(s["createElementVNode"])("br",null,null,-1),re=Object(s["createElementVNode"])("br",null,null,-1),ie=Object(s["createElementVNode"])("br",null,null,-1),ce=Object(s["createElementVNode"])("br",null,null,-1),se=Object(s["createElementVNode"])("br",null,null,-1),de={ref:"endedittable"},ue=Object(s["createElementVNode"])("input",{type:"hidden",name:"goalIdUpdate",value:""},null,-1),be={key:0},me=["innerHTML"],pe=Object(s["createElementVNode"])("a",{id:"bottom"},null,-1);function Oe(e,t,a,l,o,n){var r;const i=Object(s["resolveComponent"])("ActivityIndicator"),c=Object(s["resolveComponent"])("ContentBlock"),Oe=Object(s["resolveComponent"])("Field"),je=Object(s["resolveComponent"])("Alert"),he=Object(s["resolveComponent"])("VueEntryContainer"),ge=Object(s["resolveComponent"])("SaveButton"),ve=Object(s["resolveDirective"])("content-table"),ye=Object(s["resolveDirective"])("form");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",d,[Object(s["withDirectives"])(Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("div",u,[Object(s["createVNode"])(c,{"content-title":e.translate("Goals_ManageGoals")},{default:Object(s["withCtx"])(()=>[Object(s["createVNode"])(i,{loading:e.isLoading},null,8,["loading"]),Object(s["createElementVNode"])("div",b,[Object(s["createElementVNode"])("span",{innerHTML:e.$sanitize(e.learnMoreAboutGoalTracking)},null,8,m),e.ecommerceEnabled?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",p,[O,j,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("Goals_Optional"))+" "+Object(s["toDisplayString"])(e.translate("Goals_Ecommerce"))+": ",1),Object(s["createElementVNode"])("span",{innerHTML:e.$sanitize(e.youCanEnableEcommerceReports)},null,8,h)]))]),Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("table",null,[Object(s["createElementVNode"])("thead",null,[Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("th",g,Object(s["toDisplayString"])(e.translate("General_Id")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("Goals_GoalName")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("General_Description")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("Goals_GoalIsTriggeredWhen")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("General_ColumnRevenue")),1),e.beforeGoalListActionsHeadComponent?(Object(s["openBlock"])(),Object(s["createBlock"])(Object(s["resolveDynamicComponent"])(e.beforeGoalListActionsHeadComponent),{key:0})):Object(s["createCommentVNode"])("",!0),e.userCanEditGoals?(Object(s["openBlock"])(),Object(s["createElementBlock"])("th",v,Object(s["toDisplayString"])(e.translate("General_Actions")),1)):Object(s["createCommentVNode"])("",!0)])]),Object(s["createElementVNode"])("tbody",null,[Object.keys(e.goals||{}).length?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",y,[Object(s["createElementVNode"])("td",_,[G,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("Goals_ThereIsNoGoalToManage",e.siteName))+" ",1),E,V])])),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.goals||[],t=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",{id:t.idgoal,key:t.idgoal},[Object(s["createElementVNode"])("td",w,Object(s["toDisplayString"])(t.idgoal),1),Object(s["createElementVNode"])("td",null,Object(s["toDisplayString"])(t.name),1),Object(s["createElementVNode"])("td",null,Object(s["toDisplayString"])(t.description),1),Object(s["createElementVNode"])("td",null,[Object(s["createElementVNode"])("span",f,Object(s["toDisplayString"])(e.goalMatchAttributeTranslations[t.match_attribute]||t.match_attribute),1),"visit_duration"===t.match_attribute?(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",S,Object(s["toDisplayString"])(e.lcfirst(e.translate("General_OperationGreaterThan")))+" "+Object(s["toDisplayString"])(e.translate("Intl_NMinutes",t.pattern)),1)):t.pattern_type?(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",T,[D,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("Goals_Pattern"))+" "+Object(s["toDisplayString"])(t.pattern_type)+": "+Object(s["toDisplayString"])(t.pattern),1)])):Object(s["createCommentVNode"])("",!0)]),Object(s["createElementVNode"])("td",{class:"center",innerHTML:e.$sanitize(0===t.revenue||"0"===t.revenue?"-":t.revenue_pretty)},null,8,C),e.beforeGoalListActionsBodyComponent[t.idgoal]?(Object(s["openBlock"])(),Object(s["createBlock"])(Object(s["resolveDynamicComponent"])(e.beforeGoalListActionsBodyComponent[t.idgoal]),{key:0})):Object(s["createCommentVNode"])("",!0),e.userCanEditGoals?(Object(s["openBlock"])(),Object(s["createElementBlock"])("td",k,[e.userCanEditGoals?(Object(s["openBlock"])(),Object(s["createElementBlock"])("button",{key:0,onClick:a=>e.editGoal(t.idgoal),class:"table-action icon-edit",title:e.translate("General_Edit")},null,8,x)):Object(s["createCommentVNode"])("",!0),e.userCanEditGoals?(Object(s["openBlock"])(),Object(s["createElementBlock"])("button",{key:1,onClick:a=>e.deleteGoal(t.idgoal),class:"table-action icon-delete",title:e.translate("General_Delete")},null,8,M)):Object(s["createCommentVNode"])("",!0)])):Object(s["createCommentVNode"])("",!0)],8,N))),128))])])),[[ve]]),e.userCanEditGoals&&!e.onlyShowAddNewGoal?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",A,[Object(s["createElementVNode"])("button",{id:"add-goal",onClick:t[0]||(t[0]=t=>e.createGoal())},[B,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("Goals_AddNewGoal")),1)])])):Object(s["createCommentVNode"])("",!0)]),_:1},8,["content-title"])],512),[[s["vShow"],e.showGoalList]]),Object(s["createElementVNode"])("div",L,[Object(s["createElementVNode"])("h2",null,Object(s["toDisplayString"])(e.translate("Goals_DeleteGoalConfirm",`"${null===(r=e.goalToDelete)||void 0===r?void 0:r.name}"`)),1),Object(s["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,H),Object(s["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,F)],512)],512),[[s["vShow"],!e.onlyShowAddNewGoal]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("div",U,[Object(s["createVNode"])(c,{"content-title":e.goal.idgoal?e.translate("Goals_UpdateGoal"):e.translate("Goals_AddNewGoal")},{default:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("div",{innerHTML:e.$sanitize(e.addNewGoalIntro)},null,8,P),Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("div",null,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(Oe,{uicontrol:"text",name:"goal_name",modelValue:e.goal.name,"onUpdate:modelValue":t[1]||(t[1]=t=>e.goal.name=t),maxlength:50,title:e.translate("Goals_GoalName"),onChange:e.goalNameChanged},null,8,["modelValue","title","onChange"])]),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(Oe,{uicontrol:"text",name:"goal_description",modelValue:e.goal.description,"onUpdate:modelValue":t[2]||(t[2]=t=>e.goal.description=t),maxlength:255,title:e.translate("General_Description")},null,8,["modelValue","title"])]),Object(s["createElementVNode"])("div",$,[Object(s["createElementVNode"])("div",I,[Object(s["createElementVNode"])("h3",null,Object(s["toDisplayString"])(e.translate("Goals_GoalIsTriggered")),1)])]),Object(s["createElementVNode"])("div",R,[Object(s["createElementVNode"])("div",z,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(Oe,{uicontrol:"select",name:"trigger_type","model-value":e.triggerType,"onUpdate:modelValue":t[3]||(t[3]=t=>{e.triggerType=t,e.changedTriggerType()}),"full-width":!0,options:e.goalTriggerTypeOptions},null,8,["model-value","options"])])]),Object(s["createElementVNode"])("div",q,[Object(s["withDirectives"])(Object(s["createVNode"])(je,{severity:"info"},{default:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("span",{innerHTML:e.$sanitize(e.whereVisitedPageManuallyCallsJsTrackerText)},null,8,W)]),_:1},512),[[s["vShow"],"manually"===e.triggerType]]),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createVNode"])(Oe,{uicontrol:"radio",name:"match_attribute","full-width":!0,"model-value":e.goal.match_attribute,"onUpdate:modelValue":t[4]||(t[4]=t=>{e.goal.match_attribute=t,e.initPatternType()}),options:e.goalMatchAttributeOptions},null,8,["model-value","options"]),[[s["vShow"],"manually"!==e.triggerType]])])])]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",J,[Object(s["createElementVNode"])("h3",Y,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("Goals_WhereThe"))+" ",1),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.translate("Goals_URL")),513),[[s["vShow"],"url"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.translate("Goals_PageTitle")),513),[[s["vShow"],"title"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.translate("Goals_Filename")),513),[[s["vShow"],"file"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.translate("Goals_ExternalWebsiteUrl")),513),[[s["vShow"],"external_website"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.translate("Goals_VisitDuration")),513),[[s["vShow"],"visit_duration"===e.goal.match_attribute]])])],512),[[s["vShow"],"manually"!==e.triggerType]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",K,[Object(s["withDirectives"])(Object(s["createElementVNode"])("div",Q,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(Oe,{uicontrol:"select",name:"event_type",modelValue:e.eventType,"onUpdate:modelValue":t[5]||(t[5]=t=>e.eventType=t),"full-width":!0,options:e.eventTypeOptions},null,8,["modelValue","options"])])],512),[[s["vShow"],"event"===e.goal.match_attribute]]),e.isMatchAttributeNumeric?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",X,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(Oe,{uicontrol:"select",name:"pattern_type",modelValue:e.goal.pattern_type,"onUpdate:modelValue":t[6]||(t[6]=t=>e.goal.pattern_type=t),"full-width":!0,options:e.patternTypeOptions},null,8,["modelValue","options"])])])),e.isMatchAttributeNumeric?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Z,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(Oe,{uicontrol:"select",name:"pattern_type",modelValue:e.goal.pattern_type,"onUpdate:modelValue":t[7]||(t[7]=t=>e.goal.pattern_type=t),"full-width":!0,options:e.numericComparisonTypeOptions},null,8,["modelValue","options"])])])):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("div",ee,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(Oe,{uicontrol:"text",name:"pattern",modelValue:e.goal.pattern,"onUpdate:modelValue":t[8]||(t[8]=t=>e.goal.pattern=t),maxlength:255,title:e.patternFieldLabel,"full-width":!0},null,8,["modelValue","title"])])]),Object(s["createElementVNode"])("div",te,[Object(s["createVNode"])(je,{severity:"info"},{default:Object(s["withCtx"])(()=>[Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_Contains","'checkout/confirmation'"))+" ",1),ae,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_IsExactly","'http://example.com/thank-you.html'"))+" ",1),le,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_MatchesExpression","'(.*)\\/demo\\/(.*)'")),1)],512),[[s["vShow"],"url"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_Contains","'Order confirmation'")),513),[[s["vShow"],"title"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_Contains","'files/brochure.pdf'"))+" ",1),oe,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_IsExactly","'http://example.com/files/brochure.pdf'"))+" ",1),ne,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_MatchesExpression","'(.*)\\.zip'")),1)],512),[[s["vShow"],"file"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_Contains","'amazon.com'"))+" ",1),re,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_IsExactly","'http://mypartner.com/landing.html'"))+" ",1),ie,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.matchesExpressionExternal),1)],512),[[s["vShow"],"external_website"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_Contains","'video'"))+" ",1),ce,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_IsExactly","'click'"))+" ",1),se,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_MatchesExpression","'(.*)_banner'"))+'" ',1)],512),[[s["vShow"],"event"===e.goal.match_attribute]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(e.translate("General_ForExampleShort"))+" "+Object(s["toDisplayString"])(e.translate("Goals_AtLeastMinutes","5","0.5")),513),[[s["vShow"],"visit_duration"===e.goal.match_attribute]])]),_:1})])],512),[[s["vShow"],"manually"!==e.triggerType]]),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createVNode"])(Oe,{uicontrol:"checkbox",name:"case_sensitive",modelValue:e.goal.case_sensitive,"onUpdate:modelValue":t[9]||(t[9]=t=>e.goal.case_sensitive=t),title:e.caseSensitiveTitle},null,8,["modelValue","title"]),[[s["vShow"],"manually"!==e.triggerType&&!e.isMatchAttributeNumeric]])]),Object(s["createElementVNode"])("div",null,["visit_duration"!==e.goal.match_attribute?(Object(s["openBlock"])(),Object(s["createBlock"])(Oe,{key:0,uicontrol:"radio",name:"allow_multiple","model-value":e.goal.allow_multiple&&"0"!==e.goal.allow_multiple?1:0,"onUpdate:modelValue":t[10]||(t[10]=t=>e.goal.allow_multiple=t),options:e.allowMultipleOptions,introduction:e.translate("Goals_AllowMultipleConversionsPerVisit"),"inline-help":e.translate("Goals_HelpOneConversionPerVisit")},null,8,["model-value","options","introduction","inline-help"])):Object(s["createCommentVNode"])("",!0)]),Object(s["createElementVNode"])("h3",null,Object(s["toDisplayString"])(e.translate("Goals_GoalRevenue"))+" "+Object(s["toDisplayString"])(e.translate("Goals_Optional")),1),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(Oe,{uicontrol:"number",name:"revenue",modelValue:e.goal.revenue,"onUpdate:modelValue":t[11]||(t[11]=t=>e.goal.revenue=t),placeholder:e.translate("Goals_DefaultRevenueLabel"),"inline-help":e.translate("Goals_DefaultRevenueHelp")},null,8,["modelValue","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createVNode"])(Oe,{uicontrol:"checkbox",name:"use_event_value",modelValue:e.goal.event_value_as_revenue,"onUpdate:modelValue":t[12]||(t[12]=t=>e.goal.event_value_as_revenue=t),title:e.translate("Goals_UseEventValueAsRevenue"),"inline-help":e.useEventValueAsRevenueHelp},null,8,["modelValue","title","inline-help"]),[[s["vShow"],"event"===e.goal.match_attribute]])]),Object(s["createElementVNode"])("div",de,[e.endEditTable?(Object(s["openBlock"])(),Object(s["createBlock"])(he,{key:0,html:e.endEditTable},null,8,["html"])):Object(s["createCommentVNode"])("",!0)],512),ue,Object(s["createVNode"])(ge,{saving:e.isLoading,onConfirm:t[13]||(t[13]=t=>e.save()),value:e.submitText},null,8,["saving","value"]),e.onlyShowAddNewGoal?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",be,[Object(s["withDirectives"])(Object(s["createElementVNode"])("div",{class:"entityCancel",onClick:t[14]||(t[14]=t=>e.showListOfReports()),innerHTML:e.$sanitize(e.cancelText)},null,8,me),[[s["vShow"],e.showEditGoal]])]))])),[[ye]])]),_:1},8,["content-title"])],512),[[s["vShow"],e.showEditGoal]])],512),[[s["vShow"],e.userCanEditGoals]]),pe])}var je=a("a5a2");function he(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class ge{constructor(){he(this,"privateState",Object(s["reactive"])({})),he(this,"idGoal",Object(s["computed"])(()=>this.privateState.idGoal))}setIdGoalShown(e){this.privateState.idGoal=e}}var ve=new ge;function ye(e){return e&&"0"!==e?1:0}var _e=Object(s["defineComponent"])({inheritAttrs:!1,props:{onlyShowAddNewGoal:Boolean,userCanEditGoals:Boolean,ecommerceEnabled:Boolean,goals:{type:Object,required:!0},addNewGoalIntro:String,goalTriggerTypeOptions:Object,goalMatchAttributeOptions:Array,eventTypeOptions:Array,patternTypeOptions:Array,numericComparisonTypeOptions:Array,allowMultipleOptions:Array,showAddGoal:Boolean,showGoal:Number,beforeGoalListActionsBody:Object,endEditTable:String,beforeGoalListActionsHead:String},data(){return{showEditGoal:!1,showGoalList:!0,goal:{},isLoading:!1,eventType:"event_category",triggerType:"visitors",apiMethod:"",submitText:"",goalToDelete:null,addEditTableComponent:!1}},components:{SaveButton:je["SaveButton"],ContentBlock:n["ContentBlock"],ActivityIndicator:n["ActivityIndicator"],Field:je["Field"],Alert:n["Alert"],VueEntryContainer:n["VueEntryContainer"]},directives:{ContentTable:n["ContentTable"],Form:je["Form"]},created(){ve.setIdGoalShown(this.showGoal)},unmounted(){ve.setIdGoalShown(void 0)},mounted(){this.showAddGoal?this.createGoal():this.showGoal?this.editGoal(this.showGoal):this.showListOfReports()},methods:{scrollToTop(){setTimeout(()=>{n["Matomo"].helper.lazyScrollTo(".pageWrap",200)})},initGoalForm(e,t,a,l,o,r,i,c,s,d,u,b){n["Matomo"].postEvent("Goals.beforeInitGoalForm",e,b,a),this.apiMethod=e,this.goal={},this.goal.name=a,this.goal.description=l;let m=o;"manually"===m?(this.triggerType="manually",m="url"):this.triggerType="visitors",0===m.indexOf("event")?(this.eventType=m,m="event"):this.eventType="event_category",this.goal.match_attribute=m,this.goal.allow_multiple=d,this.goal.pattern_type=i,this.goal.pattern=r,this.goal.case_sensitive=c,this.goal.revenue=s,this.goal.event_value_as_revenue=u,this.submitText=t,this.goal.idgoal=b},showListOfReports(){n["Matomo"].postEvent("Goals.cancelForm"),this.showGoalList=!0,this.showEditGoal=!1,this.scrollToTop()},showAddEditForm(){this.showGoalList=!1,this.showEditGoal=!0},createGoal(){const e={isAllowed:!0};n["Matomo"].postEvent("Goals.initAddGoal",e),e&&!e.isAllowed||(this.showAddEditForm(),this.initGoalForm("Goals.addGoal",Object(n["translate"])("Goals_AddGoal"),"","","url","","contains",!1,0,!1,!1,0),this.scrollToTop())},editGoal(e){this.showAddEditForm();const t=this.goals[""+e];this.initGoalForm("Goals.updateGoal",Object(n["translate"])("Goals_UpdateGoal"),t.name,t.description,t.match_attribute,t.pattern,t.pattern_type,!!t.case_sensitive&&"0"!==t.case_sensitive,parseInt(""+t.revenue,10),!!t.allow_multiple&&"0"!==t.allow_multiple,!!t.event_value_as_revenue&&"0"!==t.event_value_as_revenue,e),this.scrollToTop()},deleteGoal(e){this.goalToDelete=this.goals[""+e],n["Matomo"].helper.modalConfirm(this.$refs.confirm,{yes:()=>{this.isLoading=!0,n["AjaxHelper"].fetch({idGoal:e,method:"Goals.deleteGoal"}).then(()=>{window.location.reload()}).finally(()=>{this.isLoading=!1})}})},save(){const e={};e.name=this.goal.name,e.description=this.goal.description,this.isManuallyTriggered?(e.matchAttribute="manually",e.patternType="regex",e.pattern=".*",e.caseSensitive=0):(e.matchAttribute=this.goal.match_attribute,"event"===e.matchAttribute&&(e.matchAttribute=this.eventType,e.useEventValueAsRevenue=ye(this.goal.event_value_as_revenue)),e.patternType=this.goal.pattern_type,e.pattern=this.goal.pattern,e.caseSensitive=ye(this.goal.case_sensitive)),e.revenue=this.goal.revenue||0,e.allowMultipleConversionsPerVisit=ye(this.goal.allow_multiple),e.idGoal=this.goal.idgoal,e.method=this.apiMethod;const t="Goals.addGoal"===e.method,a="Goals.updateGoal"===e.method,l={};a?n["Matomo"].postEvent("Goals.beforeUpdateGoal",{parameters:e,options:l}):t&&n["Matomo"].postEvent("Goals.beforeAddGoal",{parameters:e,options:l}),null!==e&&void 0!==e&&e.cancelRequest||(this.isLoading=!0,n["AjaxHelper"].fetch(e,l).then(()=>{const e=n["MatomoUrl"].parsed.value.subcategory;"Goals_AddNewGoal"===e&&n["Matomo"].helper.isReportingPage()?n["ReportingMenuStore"].reloadMenuItems().then(()=>{n["MatomoUrl"].updateHash(Object.assign(Object.assign({},n["MatomoUrl"].hashParsed.value),{},{subcategory:"Goals_ManageGoals"})),this.isLoading=!1}):window.location.reload()}).catch(()=>{this.scrollToTop(),this.isLoading=!1}))},changedTriggerType(){this.isManuallyTriggered||this.goal.pattern_type||(this.goal.pattern_type="contains")},initPatternType(){this.isMatchAttributeNumeric?this.goal.pattern_type="greater_than":this.goal.pattern_type="contains"},lcfirst(e){return`${e.slice(0,1).toLowerCase()}${e.slice(1)}`},ucfirst(e){return`${e.slice(0,1).toUpperCase()}${e.slice(1)}`},goalNameChanged(){n["Matomo"].postEvent("Goals.goalNameChanged",this.goal.name)}},computed:{learnMoreAboutGoalTracking(){return Object(n["translate"])("Goals_LearnMoreAboutGoalTrackingDocumentation",Object(n["externalLink"])("https://matomo.org/docs/tracking-goals-web-analytics/"),"</a>")},youCanEnableEcommerceReports(){const e=n["MatomoUrl"].stringify(Object.assign(Object.assign({},n["MatomoUrl"].urlParsed.value),{},{module:"SitesManager",action:"index"})),t=Object(n["externalLink"])("https://matomo.org/docs/ecommerce-analytics/")+Object(n["translate"])("Goals_EcommerceReports")+"</a>",a=`<a href='${e}'>${Object(n["translate"])("SitesManager_WebsitesManagement")}</a>`;return Object(n["translate"])("Goals_YouCanEnableEcommerceReports",t,a)},siteName(){return n["Matomo"].helper.htmlDecode(n["Matomo"].siteName)},whereVisitedPageManuallyCallsJsTrackerText(){return Object(n["translate"])("Goals_WhereVisitedPageManuallyCallsJavascriptTrackerLearnMore",Object(n["externalLink"])("https://developer.matomo.org/guides/tracking-javascript-guide#manually-trigger-goal-conversions"),"</a>")},caseSensitiveTitle(){return`${Object(n["translate"])("Goals_CaseSensitive")} ${Object(n["translate"])("Goals_Optional")}`},useEventValueAsRevenueHelp(){return`${Object(n["translate"])("Goals_EventValueAsRevenueHelp")} <br/><br/> ${Object(n["translate"])("Goals_EventValueAsRevenueHelp2")}`},cancelText(){return Object(n["translate"])("General_OrCancel","<a class='entityCancelLink'>","</a>")},isMatchAttributeNumeric(){return["visit_duration"].indexOf(this.goal.match_attribute)>-1},patternFieldLabel(){return"visit_duration"===this.goal.match_attribute?Object(n["translate"])("Goals_TimeInMinutes"):Object(n["translate"])("Goals_Pattern")},goalMatchAttributeTranslations(){return{manually:Object(n["translate"])("Goals_ManuallyTriggeredUsingJavascriptFunction"),file:Object(n["translate"])("Goals_Download"),url:Object(n["translate"])("Goals_VisitUrl"),title:Object(n["translate"])("Goals_VisitPageTitle"),external_website:Object(n["translate"])("Goals_ClickOutlink"),event_action:`${Object(n["translate"])("Goals_SendEvent")} (${Object(n["translate"])("Events_EventAction")})`,event_category:`${Object(n["translate"])("Goals_SendEvent")} (${Object(n["translate"])("Events_EventCategory")})`,event_name:`${Object(n["translate"])("Goals_SendEvent")} (${Object(n["translate"])("Events_EventName")})`,visit_duration:""+this.ucfirst(Object(n["translate"])("Goals_VisitDuration"))}},beforeGoalListActionsBodyComponent(){if(!this.beforeGoalListActionsBody)return{};const e={};return Object.values(this.goals).forEach(t=>{const a=this.beforeGoalListActionsBody[t.idgoal];a&&(e[t.idgoal]={template:a})}),Object(s["markRaw"])(e)},beforeGoalListActionsHeadComponent(){return this.beforeGoalListActionsHead?Object(s["markRaw"])({template:this.beforeGoalListActionsHead}):null},isManuallyTriggered(){return"manually"===this.triggerType},matchesExpressionExternal(){const e="'http://www.amazon.com\\/(.*)\\/yourAffiliateId'";return Object(n["translate"])("Goals_MatchesExpression",e)}}});_e.render=Oe;var Ge=_e;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
*/}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["Ecommerce"]=t(require("CoreHome"),require("vue")):e["Ecommerce"]=t(e["CoreHome"],e["Vue"])})("undefined"!==typeof self?self:this,(function(e,t){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Ecommerce/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ConversionOverview",(function(){return _})),"undefined"!==typeof window){var o=window.document.currentScript,r=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var c=n("8bbf");const i={class:"ulGoalTopElements"},l=["innerHTML"],a={key:0},s=["innerHTML"],u={key:1},p=["innerHTML"],d={key:2},b=["innerHTML"],f={key:3},m=["innerHTML"],j=Object(c["createElementVNode"])("span",{class:"icon-visitor-profile rowActionIcon"},"  ",-1),O=Object(c["createElementVNode"])("br",{style:{clear:"left"}},null,-1);function v(e,t,n,o,r,v){const g=Object(c["resolveComponent"])("ContentBlock");return Object(c["openBlock"])(),Object(c["createBlock"])(g,{"content-title":e.translate("Goals_ConversionsOverview")},{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("ul",i,[Object(c["createElementVNode"])("li",null,[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.translate("General_ColumnRevenue"))+": ",1),Object(c["createElementVNode"])("span",{innerHTML:e.$sanitize(e.revenue)},null,8,l),e.revenue_subtotal?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",a,[Object(c["createTextVNode"])(", "+Object(c["toDisplayString"])(e.translate("General_Subtotal"))+": ",1),Object(c["createElementVNode"])("span",{innerHTML:e.$sanitize(e.revenue_subtotal)},null,8,s)])):Object(c["createCommentVNode"])("",!0),e.revenue_tax?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",u,[Object(c["createTextVNode"])(", "+Object(c["toDisplayString"])(e.translate("General_Tax"))+": ",1),Object(c["createElementVNode"])("span",{innerHTML:e.$sanitize(e.revenue_tax)},null,8,p)])):Object(c["createCommentVNode"])("",!0),e.revenue_shipping?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",d,[Object(c["createTextVNode"])(", "+Object(c["toDisplayString"])(e.translate("General_Shipping"))+": ",1),Object(c["createElementVNode"])("span",{innerHTML:e.$sanitize(e.revenue_shipping)},null,8,b)])):Object(c["createCommentVNode"])("",!0),e.revenue_shipping?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",f,[Object(c["createTextVNode"])(", "+Object(c["toDisplayString"])(e.translate("General_Discount"))+": ",1),Object(c["createElementVNode"])("span",{innerHTML:e.$sanitize(e.revenue_discount)},null,8,m)])):Object(c["createCommentVNode"])("",!0)])]),e.visitorLogEnabled?(Object(c["openBlock"])(),Object(c["createElementBlock"])("a",{key:0,href:"",class:"segmentedlog",onClick:t[0]||(t[0]=Object(c["withModifiers"])(t=>e.showSegmentedVisitorLog(),["prevent"]))},[j,Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.translate("Live_RowActionTooltipWithDimension",e.translate("General_Goal"))),1)])):Object(c["createCommentVNode"])("",!0),O]),_:1},8,["content-title"])}var g=n("19dc"),y=Object(c["defineComponent"])({props:{idGoal:{type:[String,Number],required:!0},visitorLogEnabled:Boolean,revenue:String,revenue_subtotal:String,revenue_tax:String,revenue_shipping:String,revenue_discount:String},components:{ContentBlock:g["ContentBlock"]},methods:{showSegmentedVisitorLog(){window.SegmentedVisitorLog.show("Goals.getMetrics","visitConvertedGoalId=="+this.idGoal,{})}}});y.render=v;var _=y;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
*/}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["UserCountry"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["UserCountry"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,r){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="plugins/UserCountry/vue/dist/",r(r.s="fae3")}({"19dc":function(t,r){t.exports=e},"8bbf":function(e,r){e.exports=t},a5a2:function(e,t){e.exports=r},fae3:function(e,t,r){"use strict";if(r.r(t),r.d(t,"LocationProviderSelection",(function(){return w})),r.d(t,"AdminPage",(function(){return G})),r.d(t,"GetDistinctCountries",(function(){return R})),"undefined"!==typeof window){var o=window.document.currentScript,n=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(r.p=n[1])}var i=r("8bbf");const c={class:"locationProviderSelection"},l=["innerHTML"],a={class:"row"},s={class:"col s12 push-m9 m3"},d={class:"col s12 m4 l2"},u=["id","disabled","checked","onChange"],p={class:"loc-provider-status"},b={key:0,class:"is-not-installed"},j={key:1,class:"is-installed"},O={key:2,class:"is-broken"},m={class:"col s12 m4 l6"},v=["innerHTML"],f=["innerHTML"],y={class:"col s12 m4 l4"},k={key:0,class:"form-help"},g={key:0},h=Object(i["createElementVNode"])("br",null,null,-1),C={style:{position:"absolute"}},P=["innerHTML"],N={class:"text-right"},B=["onClick"],E={key:1},V={key:1,class:"form-help"},L={key:0},S=["innerHTML"],I=["innerHTML"],_={key:1},x=["innerHTML"];function T(e,t,r,o,n,T){const D=Object(i["resolveComponent"])("ActivityIndicator"),H=Object(i["resolveComponent"])("Notification"),M=Object(i["resolveComponent"])("SaveButton");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",c,[e.isThereWorkingProvider?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,innerHTML:e.$sanitize(e.setUpGuides||"")},null,8,l)),Object(i["createElementVNode"])("div",a,[Object(i["createElementVNode"])("div",s,Object(i["toDisplayString"])(e.translate("General_InfoFor",e.thisIp)),1)]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.visibleLocationProviders,(t,r)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:r,class:Object(i["normalizeClass"])("row form-group provider"+r)},[Object(i["createElementVNode"])("div",d,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("label",null,[Object(i["createElementVNode"])("input",{class:"location-provider",name:"location-provider",type:"radio",id:"provider_input_"+r,disabled:1!==t.status,checked:e.selectedProvider===r,onChange:t=>e.selectedProvider=r},null,40,u),Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translateOrDefault(t.title)),1)])]),Object(i["createElementVNode"])("p",p,[0===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",b,Object(i["toDisplayString"])(e.translate("General_NotInstalled")),1)):1===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",j,Object(i["toDisplayString"])(e.translate("General_Installed")),1)):2===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",O,Object(i["toDisplayString"])(e.translate("General_Broken")),1)):Object(i["createCommentVNode"])("",!0)])]),Object(i["createElementVNode"])("div",m,[Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.translateOrDefault(t.description))},null,8,v),1!==t.status&&t.install_docs?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(t.install_docs)},null,8,f)):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("div",y,[1===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",k,["127.0.0.1"!==e.thisIp&&"::1"!==e.thisIp?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",g,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("UserCountry_CurrentLocationIntro"))+": ",1),Object(i["createElementVNode"])("div",null,[h,Object(i["createElementVNode"])("div",C,[Object(i["createVNode"])(D,{loading:e.updateLoading[r]},null,8,["loading"])]),Object(i["createElementVNode"])("span",{class:"location",style:Object(i["normalizeStyle"])({visibility:e.providerLocations[r]?"visible":"hidden"})},[Object(i["createElementVNode"])("strong",{innerHTML:e.$sanitize(e.providerLocations[r]||" ")},null,8,P)],4)]),Object(i["createElementVNode"])("div",N,[Object(i["createElementVNode"])("a",{onClick:Object(i["withModifiers"])(t=>e.refreshProviderInfo(r),["prevent"])},Object(i["toDisplayString"])(e.translate("General_Refresh")),9,B)])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",E,Object(i["toDisplayString"])(e.translate("UserCountry_CannotLocalizeLocalIP",e.thisIp)),1))])):Object(i["createCommentVNode"])("",!0),t.statusMessage?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",V,[2===t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("strong",L,Object(i["toDisplayString"])(e.translate("General_Error"))+":",1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(t.statusMessage)},null,8,S)])):Object(i["createCommentVNode"])("",!0),t.extra_message?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:2,class:"form-help",innerHTML:e.$sanitize(t.extra_message)},null,8,I)):Object(i["createCommentVNode"])("",!0)])],2))),128)),Object.keys(e.locationProvidersNotDefaultOrDisabled).length?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",_,[Object(i["createVNode"])(H,{noclear:!0,context:"warning"},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.noProvidersText)},null,8,x)]),_:1})])),Object(i["createVNode"])(M,{onConfirm:t[0]||(t[0]=t=>e.save()),saving:e.isLoading},null,8,["saving"])])}var D=r("19dc"),H=r("a5a2"),M=Object(i["defineComponent"])({props:{currentProviderId:{type:String,required:!0},isThereWorkingProvider:Boolean,setUpGuides:String,thisIp:{type:String,required:!0},locationProviders:{type:Object,required:!0},defaultProviderId:{type:String,required:!0},disabledProviderId:{type:String,required:!0}},components:{ActivityIndicator:D["ActivityIndicator"],Notification:D["Notification"],SaveButton:H["SaveButton"]},data(){return{isLoading:!1,updateLoading:{},selectedProvider:this.currentProviderId,providerLocations:Object.fromEntries(Object.entries(this.locationProviders).map(([e,t])=>[e,t.location]))}},methods:{refreshProviderInfo(e){this.updateLoading[e]=!0,delete this.providerLocations[e],D["AjaxHelper"].fetch({module:"UserCountry",action:"getLocationUsingProvider",id:e,format:"html"},{format:"html"}).then(t=>{this.providerLocations[e]=t}).finally(()=>{this.updateLoading[e]=!1})},save(){this.selectedProvider&&(this.isLoading=!0,D["AjaxHelper"].fetch({method:"UserCountry.setLocationProvider",providerId:this.selectedProvider},{withTokenInUrl:!0}).then(()=>{const e=D["NotificationsStore"].show({message:Object(D["translate"])("General_Done"),context:"success",noclear:!0,type:"toast",id:"userCountryLocationProvider"});D["NotificationsStore"].scrollToNotification(e)}).finally(()=>{this.isLoading=!1}))}},computed:{visibleLocationProviders(){return Object.fromEntries(Object.entries(this.locationProviders).filter(([,e])=>e.isVisible))},locationProvidersNotDefaultOrDisabled(){return Object.fromEntries(Object.entries(this.locationProviders).filter(([,e])=>e.id!==this.defaultProviderId&&e.id!==this.disabledProviderId))},noProvidersText(){return Object(D["translate"])("UserCountry_NoProviders",'<a rel="noreferrer noopener" href="https://db-ip.com/?refid=mtm" target="_blank">',"</a>")}}});M.render=T;var w=M;function q(e,t,r,o,n,c){const l=Object(i["resolveComponent"])("EnrichedHeadline"),a=Object(i["resolveComponent"])("LocationProviderSelection"),s=Object(i["resolveComponent"])("ContentBlock"),d=Object(i["resolveDirective"])("content-intro");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("h2",null,[Object(i["createVNode"])(l,{"help-url":e.externalRawLink("https://matomo.org/docs/geo-locate/"),id:"location-providers"},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("UserCountry_Geolocation")),1)]),_:1},8,["help-url"])]),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("UserCountry_GeolocationPageDesc")),1)])),[[d]]),Object(i["createVNode"])(s,{"content-title":e.translate("UserCountry_LocationProvider")},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(a,{"current-provider-id":e.currentProviderId,"is-there-working-provider":e.isThereWorkingProvider,"set-up-guides":e.setUpGuides,"this-ip":e.thisIp,"location-providers":e.locationProviders,"default-provider-id":e.defaultProviderId,"disabled-provider-id":e.disabledProviderId},null,8,["current-provider-id","is-there-working-provider","set-up-guides","this-ip","location-providers","default-provider-id","disabled-provider-id"])]),_:1},8,["content-title"])],64)}var U=Object(i["defineComponent"])({props:{currentProviderId:{type:String,required:!0},isThereWorkingProvider:Boolean,setUpGuides:String,thisIp:{type:String,required:!0},locationProviders:{type:Object,required:!0},defaultProviderId:{type:String,required:!0},disabledProviderId:{type:String,required:!0}},components:{ContentBlock:D["ContentBlock"],LocationProviderSelection:w,EnrichedHeadline:D["EnrichedHeadline"]},directives:{ContentIntro:D["ContentIntro"],ContentBlock:D["ContentBlock"]}});U.render=q;var G=U;const z={class:"sparkline"},A=["innerHTML"],$=Object(i["createElementVNode"])("br",{style:{clear:"left"}},null,-1);function W(e,t,r,o,n,c){const l=Object(i["resolveComponent"])("Sparkline"),a=Object(i["resolveComponent"])("ContentBlock");return Object(i["openBlock"])(),Object(i["createBlock"])(a,null,{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",z,[Object(i["createVNode"])(l,{params:e.urlSparklineCountries,width:100,height:25},null,8,["params"]),Object(i["createElementVNode"])("div",{innerHTML:e.$sanitize(e.distinctCountriesText)},null,8,A)]),$]),_:1})}var F=Object(i["defineComponent"])({props:{numberDistinctCountries:{type:Number,required:!0},urlSparklineCountries:{type:[Object,String],required:!0}},components:{ContentBlock:D["ContentBlock"],Sparkline:D["Sparkline"]},computed:{distinctCountriesText(){return Object(D["translate"])("UserCountry_DistinctCountries",`<strong>${this.numberDistinctCountries}</strong>`)}}});F.render=W;var R=F;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["GeoIp2"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["GeoIp2"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,o){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/GeoIp2/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},"8bbf":function(e,o){e.exports=t},a5a2:function(e,t){e.exports=o},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"GeoIp2Updater",(function(){return z})),"undefined"!==typeof window){var n=window.document.currentScript,r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(o.p=r[1])}var a=o("8bbf");const i={key:0},l={key:0},d={id:"manage-geoip-dbs"},s={class:"row",id:"geoipdb-screen1"},c={class:"geoipdb-column-1 col s6"},p=Object(a["createElementVNode"])("sup",null,[Object(a["createElementVNode"])("small",null,"*")],-1),u={class:"geoipdb-column-2 col s6"},b=["innerHTML"],m={class:"geoipdb-column-1 col s6"},g=["value"],h={class:"geoipdb-column-2 col s6"},j=["value"],O={class:"row"},f=["innerHTML"],w={id:"geoipdb-screen2-download"},I={key:1,id:"geoipdb-update-info"},v=["innerHTML"],N=Object(a["createElementVNode"])("br",null,null,-1),U=Object(a["createElementVNode"])("br",null,null,-1),D=["innerHTML"],G=["innerHTML"],x=Object(a["createElementVNode"])("br",null,null,-1),k=Object(a["createElementVNode"])("br",null,null,-1),y={id:"locationProviderUpdatePeriodInlineHelp",class:"inline-help-node",ref:"inlineHelpNode"},V=["innerHTML"],E={key:1},P=Object(a["createElementVNode"])("br",null,null,-1),_=Object(a["createElementVNode"])("br",null,null,-1),T=["innerHTML"],L=["value"],C=Object(a["createElementVNode"])("div",{id:"done-updating-updater"},null,-1),S=Object(a["createElementVNode"])("div",{id:"geoipdb-update-info-error"},null,-1),M=["innerHTML"],B={key:1},H={class:"form-description"};function F(e,t,o,n,r,F){const R=Object(a["resolveComponent"])("Progressbar"),$=Object(a["resolveComponent"])("Field"),A=Object(a["resolveComponent"])("ContentBlock");return Object(a["openBlock"])(),Object(a["createBlock"])(A,{"content-title":e.contentTitle,id:"geoip-db-mangement"},{default:Object(a["withCtx"])(()=>[e.showGeoipUpdateSection?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",i,[e.geoipDatabaseInstalled?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",l,[Object(a["withDirectives"])(Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("h3",null,Object(a["toDisplayString"])(e.translate("GeoIp2_NotManagingGeoIPDBs")),1),Object(a["createElementVNode"])("div",d,[Object(a["createElementVNode"])("div",s,[Object(a["createElementVNode"])("div",c,[Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("GeoIp2_IWantToDownloadFreeGeoIP")),1),p])]),Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.purchasedGeoIpText)},null,8,b)]),Object(a["createElementVNode"])("div",m,[Object(a["createElementVNode"])("input",{type:"button",class:"btn",onClick:t[0]||(t[0]=t=>e.startDownloadFreeGeoIp()),value:e.translate("General_GetStarted")+"..."},null,8,g)]),Object(a["createElementVNode"])("div",h,[Object(a["createElementVNode"])("input",{type:"button",class:"btn",id:"start-automatic-update-geoip",onClick:t[1]||(t[1]=t=>e.startAutomaticUpdateGeoIp()),value:e.translate("General_GetStarted")+"..."},null,8,j)])]),Object(a["createElementVNode"])("div",O,[Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("sup",null,[Object(a["createTextVNode"])("* "),Object(a["createElementVNode"])("small",{innerHTML:e.$sanitize(e.accuracyNote)},null,8,f)])])])])],512),[[a["vShow"],e.showPiwikNotManagingInfo]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",w,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(R,{label:e.freeProgressbarLabel,progress:e.progressFreeDownload},null,8,["label","progress"])])],512),[[a["vShow"],e.showFreeDownload]])])),e.geoipDatabaseInstalled&&!e.downloadErrorMessage?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",I,[Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.geoIPUpdaterInstructions)},null,8,v),N,U,e.dbipLiteUrl?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,innerHTML:e.$sanitize(e.geoliteCityLink)},null,8,D)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.maxMindLinkExplanation)},null,8,G),Object(a["withDirectives"])(Object(a["createElementVNode"])("span",null,[x,k,Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("GeoIp2_GeoIPUpdaterIntro"))+": ",1)],512),[[a["vShow"],e.geoipDatabaseInstalled]])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])($,{uicontrol:"text",name:"geoip-location-db",introduction:e.translate("GeoIp2_LocationDatabase"),title:e.translate("Actions_ColumnDownloadURL"),"inline-help":e.translate("GeoIp2_LocationDatabaseHint"),modelValue:e.locationDbUrl,"onUpdate:modelValue":t[2]||(t[2]=t=>e.locationDbUrl=t)},null,8,["introduction","title","inline-help","modelValue"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])($,{uicontrol:"text",name:"geoip-isp-db",introduction:e.translate("GeoIp2_ISPDatabase"),title:e.translate("Actions_ColumnDownloadURL"),"inline-help":e.providerPluginHelp,modelValue:e.ispDbUrl,"onUpdate:modelValue":t[3]||(t[3]=t=>e.ispDbUrl=t),disabled:!e.isProviderPluginActive},null,8,["introduction","title","inline-help","modelValue","disabled"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])($,{uicontrol:"radio",name:"geoip-update-period",introduction:e.translate("GeoIp2_DownloadNewDatabasesEvery"),modelValue:e.updatePeriod,"onUpdate:modelValue":t[4]||(t[4]=t=>e.updatePeriod=t),options:e.updatePeriodOptions},{"inline-help":Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",y,[e.lastTimeUpdaterRun?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,innerHTML:e.$sanitize(e.translate("GeoIp2_UpdaterWasLastRun",e.lastTimeUpdaterRun))},null,8,V)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",E,Object(a["toDisplayString"])(e.translate("GeoIp2_UpdaterHasNotBeenRun")),1)),P,_,Object(a["createElementVNode"])("div",{id:"geoip-updater-next-run-time",innerHTML:e.$sanitize(e.nextRunTimeText)},null,8,T)],512)]),_:1},8,["introduction","modelValue","options"])]),Object(a["createElementVNode"])("input",{type:"button",class:"btn",onClick:t[5]||(t[5]=t=>e.saveGeoIpLinks()),value:e.buttonUpdateSaveText},null,8,L),Object(a["createElementVNode"])("div",null,[C,S,Object(a["createElementVNode"])("div",null,[Object(a["withDirectives"])(Object(a["createVNode"])(R,{progress:e.progressUpdateDownload,label:e.progressUpdateLabel},null,8,["progress","label"]),[[a["vShow"],e.isUpdatingGeoIpDatabase]])])])])):Object(a["createCommentVNode"])("",!0),e.downloadErrorMessage?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:2,innerHTML:e.$sanitize(e.downloadErrorMessage)},null,8,M)):Object(a["createCommentVNode"])("",!0)])):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",B,[Object(a["createElementVNode"])("p",H,Object(a["toDisplayString"])(e.translate("GeoIp2_CannotSetupGeoIPAutoUpdating")),1)]))]),_:1},8,["content-title"])}var R=o("19dc"),$=o("a5a2");const{$:A}=window;var q=Object(a["defineComponent"])({props:{geoipDatabaseStartedInstalled:Boolean,showGeoipUpdateSection:{type:Boolean,required:!0},dbipLiteUrl:{type:String,required:!0},dbipLiteFilename:{type:String,required:!0},geoipLocUrl:String,isProviderPluginActive:Boolean,geoipIspUrl:String,lastTimeUpdaterRun:String,geoipUpdatePeriod:String,updatePeriodOptions:{type:Object,required:!0},nextRunTime:Number,nextRunTimePretty:String},components:{Progressbar:R["Progressbar"],Field:$["Field"],ContentBlock:R["ContentBlock"]},data(){return{geoipDatabaseInstalled:!!this.geoipDatabaseStartedInstalled,showFreeDownload:!1,showPiwikNotManagingInfo:!0,progressFreeDownload:0,progressUpdateDownload:0,buttonUpdateSaveText:Object(R["translate"])("General_Save"),progressUpdateLabel:"",locationDbUrl:this.geoipLocUrl||"",ispDbUrl:this.geoipIspUrl||"",orgDbUrl:"",updatePeriod:this.geoipUpdatePeriod||"month",isUpdatingGeoIpDatabase:!1,downloadErrorMessage:null,nextRunTimePrettyUpdated:void 0}},methods:{startDownloadFreeGeoIp(){this.showFreeDownload=!0,this.showPiwikNotManagingInfo=!1,this.progressFreeDownload=0,this.downloadNextChunk("downloadFreeDBIPLiteDB",e=>{this.progressFreeDownload=e},!1,{}).then(()=>{window.location.reload()}).catch(e=>{this.geoipDatabaseInstalled=!0,this.downloadErrorMessage=e.message})},startAutomaticUpdateGeoIp(){this.buttonUpdateSaveText=Object(R["translate"])("General_Continue"),this.showGeoIpUpdateInfo()},showGeoIpUpdateInfo(){this.geoipDatabaseInstalled=!0},saveGeoIpLinks(){return R["AjaxHelper"].post({period:this.updatePeriod,module:"GeoIp2",action:"updateGeoIPLinks"},{loc_db:this.locationDbUrl,isp_db:this.ispDbUrl,org_db:this.orgDbUrl},{withTokenInUrl:!0}).then(e=>this.downloadNextFileIfNeeded(e,null)).then(e=>{this.progressUpdateLabel="",this.isUpdatingGeoIpDatabase=!1,R["NotificationsStore"].show({message:Object(R["translate"])("General_Done"),placeat:"#done-updating-updater",context:"success",noclear:!0,type:"toast",style:{display:"inline-block"},id:"userCountryGeoIpUpdate"}),this.nextRunTimePrettyUpdated=e.nextRunTime,A(this.$refs.inlineHelpNode).effect("highlight",{color:"#FFFFCB"},2e3)}).catch(e=>{this.isUpdatingGeoIpDatabase=!1,R["NotificationsStore"].show({message:e.message,placeat:"#geoipdb-update-info-error",context:"error",style:{display:"inline-block"},id:"userCountryGeoIpUpdate",type:"transient"})})},downloadNextFileIfNeeded(e,t){if(null!==e&&void 0!==e&&e.to_download){const o=t===e.to_download;return this.progressUpdateDownload=0,this.progressUpdateLabel=e.to_download_label,this.isUpdatingGeoIpDatabase=!0,this.downloadNextChunk("downloadMissingGeoIpDb",e=>{this.progressUpdateDownload=e},o,{key:e.to_download}).then(t=>this.downloadNextFileIfNeeded(t,e.to_download))}return Promise.resolve(e)},downloadNextChunk(e,t,o,n){const r=Object.assign({},n);return R["AjaxHelper"].post({module:"GeoIp2",action:e,continue:o?1:0},r,{withTokenInUrl:!0}).catch(()=>{throw new Error(Object(R["translate"])("GeoIp2_FatalErrorDuringDownload"))}).then(o=>{if(o.error)throw new Error(o.error);const r=Math.floor(o.current_size/o.expected_file_size*100);return t(Math.min(r,100)),r<100?this.downloadNextChunk(e,t,!0,n):o})}},computed:{nextRunTimeText(){return this.nextRunTimePrettyUpdated?this.nextRunTimePrettyUpdated:this.nextRunTime?1e3*this.nextRunTime<Date.now()?Object(R["translate"])("GeoIp2_UpdaterScheduledForNextRun"):Object(R["translate"])("GeoIp2_UpdaterWillRunNext",`<strong>${this.nextRunTimePretty}</strong>`):Object(R["translate"])("GeoIp2_UpdaterIsNotScheduledToRun")},providerPluginHelp(){if(this.isProviderPluginActive)return;const e=Object(R["translate"])("GeoIp2_ISPRequiresProviderPlugin");return`<div style="margin:0" class='alert alert-warning'>${e}</div>`},contentTitle(){return Object(R["translate"])(this.geoipDatabaseInstalled?"GeoIp2_SetupAutomaticUpdatesOfGeoIP":"GeoIp2_GeoIPDatabases")},accuracyNote(){return Object(R["translate"])("UserCountry_GeoIpDbIpAccuracyNote",'<a href="https://dev.maxmind.com/geoip/geoip2/geolite2/?rId=piwik" rel="noreferrer noopener" target="_blank">',"</a>")},purchasedGeoIpText(){const e="http://www.maxmind.com/en/geolocation_landing?rId=piwik";return Object(R["translate"])("GeoIp2_IPurchasedGeoIPDBs",`<a rel="noreferrer noopener" href="${e}" target="_blank">`,"</a>",'<a rel="noreferrer noopener" href="https://db-ip.com/db/?refid=mtm" target="_blank">',"</a>")},geoIPUpdaterInstructions(){return Object(R["translate"])("GeoIp2_GeoIPUpdaterInstructions",'<a href="http://www.maxmind.com/?rId=piwik" rel="noreferrer noopener" target="_blank">',"</a>",'<a rel="noreferrer noopener" href="https://db-ip.com/?refid=mtm" target="_blank">',"</a>")},geoliteCityLink(){const e=Object(R["translate"])("GeoIp2_GeoLiteCityLink",`<a rel="noreferrer noopener" href="${this.dbipLiteUrl}" target="_blank">`,this.dbipLiteUrl,"</a>");return e+"<br /><br />"},maxMindLinkExplanation(){return Object(R["translate"])("UserCountry_MaxMindLinkExplanation",Object(R["externalLink"])("https://matomo.org/faq/how-to/how-do-i-get-the-geolocation-download-url-for-the-free-maxmind-db/"),"</a>")},freeProgressbarLabel(){return Object(R["translate"])("GeoIp2_DownloadingDb",`<a href="${this.dbipLiteUrl}">${this.dbipLiteFilename}</a>...`)}}});q.render=F;var z=q;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["Feedback"]=t(require("CoreHome"),require("vue")):e["Feedback"]=t(e["CoreHome"],e["Vue"])})("undefined"!==typeof self?self:this,(function(e,t){return function(e){var t={};function a(l){if(t[l])return t[l].exports;var o=t[l]={i:l,l:!1,exports:{}};return e[l].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=e,a.c=t,a.d=function(e,t,l){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(l,o,function(t){return e[t]}.bind(null,o));return l},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="plugins/Feedback/vue/dist/",a(a.s="fae3")}({"19dc":function(t,a){t.exports=e},"8bbf":function(e,a){e.exports=t},fae3:function(e,t,a){"use strict";if(a.r(t),a.d(t,"ReviewLinks",(function(){return d})),a.d(t,"RateFeature",(function(){return de})),a.d(t,"FeedbackQuestion",(function(){return Be})),"undefined"!==typeof window){var l=window.document.currentScript,o=l&&l.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(a.p=o[1])}var n=a("8bbf");const i={class:"requestReview"},c=Object(n["createStaticVNode"])('<br><br><div class="review-links"><div class="review-link"><a href="https://www.softwarereviews.com/6g24l" target="_blank"><div class="image"><img loading="lazy" src="plugins/Feedback/images/softwarereviews.svg"></div><div class="link">Software Reviews</div></a></div><div class="review-link"><a href="https://www.capterra.com/p/182627/Matomo-Analytics/" target="_blank"><div class="image"><img loading="lazy" src="plugins/Feedback/images/capterra.svg"></div><div class="link">Capterra</div></a></div><div class="review-link"><a href="https://www.g2crowd.com/products/matomo-formerly-piwik/details" target="_blank"><div class="image"><img loading="lazy" src="plugins/Feedback/images/g2crowd.svg"></div><div class="link">G2 Crowd</div></a></div><div class="review-link"><a href="https://www.producthunt.com/posts/matomo-2" target="_blank"><div class="image"><img loading="lazy" src="plugins/Feedback/images/producthunt.svg"></div><div class="link">Product Hunt</div></a></div><div class="review-link"><a href="https://www.saasworthy.com/product/matomo" target="_blank"><div class="image"><img loading="lazy" src="plugins/Feedback/images/saasworthy.png"></div><div class="link">SaaSworthy</div></a></div><div class="review-link"><a href="https://www.trustradius.com/products/matomo/reviews" target="_blank"><div class="image"><img loading="lazy" src="plugins/Feedback/images/trustradius.svg"></div><div class="link">TrustRadius</div></a></div></div>',3);function s(e,t,a,l,o,s){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",i,[Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.translate("Feedback_PleaseLeaveExternalReviewForMatomo")),1),c])}var r=Object(n["defineComponent"])({});r.render=s;var d=r;const b=["title"],u={class:"ui-confirm ratefeatureDialog"},k={key:0},m={key:0},p={key:1},j=Object(n["createElementVNode"])("br",null,null,-1),O={class:"row"},g={style:{"text-align":"left","margin-top":"16px"}},v={for:"useful",class:"ratelabel"},h=Object(n["createElementVNode"])("br",null,null,-1),f={for:"easy",class:"ratelabel"},F=Object(n["createElementVNode"])("br",null,null,-1),V={for:"configurable",class:"ratelabel"},y=Object(n["createElementVNode"])("br",null,null,-1),E={for:"likeother",class:"ratelabel"},N={key:1},R={key:0},w={key:1},M=Object(n["createElementVNode"])("br",null,null,-1),x={class:"row"},D={style:{"text-align":"left"}},B={for:"missingfeatures",class:"ratelabel"},_=Object(n["createElementVNode"])("br",null,null,-1),C={for:"makeeasier",class:"ratelabel"},S=Object(n["createElementVNode"])("br",null,null,-1),T={for:"speedup",class:"ratelabel"},L=Object(n["createElementVNode"])("br",null,null,-1),H={for:"fixbugs",class:"ratelabel"},U=Object(n["createElementVNode"])("br",null,null,-1),q={for:"dislikeother",class:"ratelabel"},z=Object(n["createElementVNode"])("br",null,null,-1),Q={key:2,class:"messageContainer",style:{"text-align":"left"}},I={key:0},P={key:1},$={key:2},A={key:3},G={key:4},Y={key:5},J={key:6},K={key:7},W={key:8},X={key:9,class:"error-text"},Z=["innerHTML"],ee=["title","value"],te=["value"],ae={class:"ui-confirm ratefeatureDialog"},le=["innerHTML"],oe={key:0},ne={key:1},ie=["value"];function ce(e,t,a,l,o,i){const c=Object(n["resolveComponent"])("MatomoDialog"),s=Object(n["resolveComponent"])("ReviewLinks");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{title:e.translate("Feedback_RateFeatureTitle",e.htmlEntities(e.title)),class:"ratefeature"},[Object(n["createElementVNode"])("div",{class:"iconContainer",onMouseenter:t[2]||(t[2]=t=>e.expanded=!0),onMouseleave:t[3]||(t[3]=t=>e.expanded=!1)},[Object(n["createElementVNode"])("img",{onClick:t[0]||(t[0]=t=>{e.likeFeature()}),class:"like-icon",src:"plugins/Feedback/vue/src/RateFeature/thumbs-up.png"}),Object(n["createElementVNode"])("img",{onClick:t[1]||(t[1]=t=>{e.dislikeFeature()}),class:"dislike-icon",src:"plugins/Feedback/vue/src/RateFeature/thumbs-down.png"})],32),Object(n["createVNode"])(c,{modelValue:e.showFeedbackForm,"onUpdate:modelValue":t[14]||(t[14]=t=>e.showFeedbackForm=t),onYes:t[15]||(t[15]=t=>e.sendFeedback()),onValidation:t[16]||(t[16]=t=>e.sendFeedback())},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",u,[e.like?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",k,[e.title?(Object(n["openBlock"])(),Object(n["createElementBlock"])("h2",m,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageLikeNamedFeature",e.title)),1)):Object(n["createCommentVNode"])("",!0),e.title?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("h2",p,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageLike")),1)),j,Object(n["createElementVNode"])("div",O,[Object(n["createElementVNode"])("div",g,[Object(n["createElementVNode"])("label",v,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"useful",value:"useful","onUpdate:modelValue":t[4]||(t[4]=t=>e.likeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.likeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureUsefulInfo")),1)]),h,Object(n["createElementVNode"])("label",f,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"easy",value:"easy","onUpdate:modelValue":t[5]||(t[5]=t=>e.likeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.likeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureEasyToUse")),1)]),F,Object(n["createElementVNode"])("label",V,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"configurable",value:"configurable","onUpdate:modelValue":t[6]||(t[6]=t=>e.likeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.likeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureConfigurable")),1)]),y,Object(n["createElementVNode"])("label",E,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"likeother",value:"likeother","onUpdate:modelValue":t[7]||(t[7]=t=>e.likeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.likeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureOtherReason")),1)])])])])):Object(n["createCommentVNode"])("",!0),e.like?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",N,[e.title?(Object(n["openBlock"])(),Object(n["createElementBlock"])("h2",R,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageDislikeNamedFeature",e.title)),1)):Object(n["createCommentVNode"])("",!0),e.title?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("h2",w,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageDislike")),1)),M,Object(n["createElementVNode"])("div",x,[Object(n["createElementVNode"])("div",D,[Object(n["createElementVNode"])("label",B,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"missingfeatures",value:"missingfeatures","onUpdate:modelValue":t[8]||(t[8]=t=>e.dislikeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.dislikeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureDislikeAddMissingFeatures")),1)]),_,Object(n["createElementVNode"])("label",C,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"makeeasier",value:"makeeasier","onUpdate:modelValue":t[9]||(t[9]=t=>e.dislikeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.dislikeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureDislikeMakeEasier")),1)]),S,Object(n["createElementVNode"])("label",T,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"speedup",value:"speedup","onUpdate:modelValue":t[10]||(t[10]=t=>e.dislikeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.dislikeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureDislikeSpeedUp")),1)]),L,Object(n["createElementVNode"])("label",H,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"fixbugs",value:"fixbugs","onUpdate:modelValue":t[11]||(t[11]=t=>e.dislikeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.dislikeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureDislikeFixBugs")),1)]),U,Object(n["createElementVNode"])("label",q,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",id:"dislikeother",value:"dislikeother","onUpdate:modelValue":t[12]||(t[12]=t=>e.dislikeReason=t),class:"rateradio"},null,512),[[n["vModelRadio"],e.dislikeReason]]),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureOtherReason")),1)]),z])])])),e.likeReason||e.dislikeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Q,[e.likeReason&&"useful"===e.likeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",I,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageLikeExtraUseful")),1)):Object(n["createCommentVNode"])("",!0),e.likeReason&&"easy"===e.likeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",P,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageLikeExtraEasy")),1)):Object(n["createCommentVNode"])("",!0),e.likeReason&&"configurable"===e.likeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",$,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageLikeExtraConfigurable")),1)):Object(n["createCommentVNode"])("",!0),e.likeReason&&"likeother"===e.likeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",A,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageLikeExtra")),1)):Object(n["createCommentVNode"])("",!0),e.dislikeReason&&"missingfeatures"===e.dislikeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",G,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageDislikeExtraMissing")),1)):Object(n["createCommentVNode"])("",!0),e.dislikeReason&&"makeeasier"===e.dislikeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",Y,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageDislikeExtraEasier")),1)):Object(n["createCommentVNode"])("",!0),e.dislikeReason&&"fixbugs"===e.dislikeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",J,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageDislikeExtraBugs")),1)):Object(n["createCommentVNode"])("",!0),e.dislikeReason&&"speedup"===e.dislikeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",K,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageDislikeExtraSpeed")),1)):Object(n["createCommentVNode"])("",!0),e.dislikeReason&&"dislikeother"===e.dislikeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",W,Object(n["toDisplayString"])(e.translate("Feedback_RateFeatureLeaveMessageDislikeExtra")),1)):Object(n["createCommentVNode"])("",!0),e.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",X,Object(n["toDisplayString"])(e.errorMessage),1)):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createElementVNode"])("textarea",{ref:"feedbackText",class:Object(n["normalizeClass"])(["materialize-textarea",{"has-error":e.errorMessage}]),id:"feedbacktext","onUpdate:modelValue":t[13]||(t[13]=t=>e.feedbackMessage=t)},null,2),[[n["vModelText"],e.feedbackMessage]]),e.likeReason||e.dislikeReason?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",{key:10,innerHTML:e.$sanitize(e.translate("Feedback_Policy",e.externalLink("https://matomo.org/privacy-policy/"),"</a>"))},null,8,Z)):Object(n["createCommentVNode"])("",!0)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("input",{class:"btn",type:"button",role:"validation",title:e.translate("Feedback_RateFeatureSendFeedbackInformation"),value:e.translate("Feedback_SendFeedback")},null,8,ee),Object(n["createElementVNode"])("input",{type:"button",role:"cancel",value:e.translate("General_Cancel")},null,8,te)])]),_:1},8,["modelValue"]),Object(n["createVNode"])(c,{modelValue:e.ratingDone,"onUpdate:modelValue":t[17]||(t[17]=t=>e.ratingDone=t)},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",ae,[Object(n["createElementVNode"])("h2",{innerHTML:e.$sanitize(e.translate("Feedback_ThankYouHeart","<i class='icon-heart red-text'></i>"))},null,8,le),e.like?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",oe,[Object(n["createVNode"])(s)])):Object(n["createCommentVNode"])("",!0),e.like?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",ne,Object(n["toDisplayString"])(e.translate("Feedback_AppreciateFeedback")),1)),Object(n["createElementVNode"])("input",{type:"button",value:e.translate("General_Close"),role:"yes"},null,8,ie)])]),_:1},8,["modelValue"])],8,b)}var se=a("19dc"),re=Object(n["defineComponent"])({props:{title:String},components:{MatomoDialog:se["MatomoDialog"],ReviewLinks:d},data(){return{like:!1,likeReason:null,dislikeReason:null,ratingDone:!1,expanded:!1,showFeedbackForm:!1,feedbackMessage:"",errorMessage:null}},watch:{likeReason:"doFocusInput",dislikeReason:"doFocusInput"},methods:{dislikeFeature(){this.ratingDone=!1,this.like=!1,this.showFeedbackForm=!0,this.errorMessage=null,this.likeReason=null,this.dislikeReason=null,this.feedbackMessage=""},likeFeature(){this.ratingDone=!1,this.like=!0,this.showFeedbackForm=!0,this.errorMessage=null,this.likeReason=null,this.dislikeReason=null,this.feedbackMessage=""},doFocusInput(){this.$nextTick(()=>{this.focusInput()})},focusInput(){null!=this.$refs.feedbackText&&this.$refs.feedbackText.focus()},sendFeedback(){this.errorMessage=null,se["AjaxHelper"].fetch({method:"Feedback.sendFeedbackForFeature",featureName:this.title,like:this.like?1:0,choice:this.like?this.likeReason:this.dislikeReason,message:this.feedbackMessage}).then(e=>{"success"===e.value?(this.showFeedbackForm=!1,this.ratingDone=!0,this.feedbackMessage=""):this.errorMessage=e.value})},htmlEntities(e){return se["Matomo"].helper.htmlEntities(e)}}});re.render=ce;var de=re;const be={key:0,class:"bannerHeader"},ue=Object(n["createElementVNode"])("i",{class:"icon-heart red-text"},null,-1),ke=Object(n["createElementVNode"])("i",{class:"icon-close white-text"},null,-1),me=[ke],pe={class:"ratefeature"},je={class:"ui-confirm ratefeatureDialog"},Oe=["innerHTML"],ge=Object(n["createElementVNode"])("br",null,null,-1),ve={class:"messageContainer"},he={key:0,class:"error-text"},fe=Object(n["createElementVNode"])("br",null,null,-1),Fe=["innerHTML"],Ve=["value"],ye=["value"],Ee={class:"ui-confirm ratefeatureDialog"},Ne=["innerHTML"],Re=["value"];function we(e,t,a,l,o,i){const c=Object(n["resolveComponent"])("MatomoDialog");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[e.isHidden?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",be,[Object(n["createElementVNode"])("span",null,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("Feedback_FeedbackTitle"))+" ",1),ue]),Object(n["createElementVNode"])("a",{onClick:t[0]||(t[0]=(...t)=>e.showQuestion&&e.showQuestion(...t)),class:"btn"},Object(n["toDisplayString"])(e.translate("Feedback_Question"+e.question)),1),Object(n["createElementVNode"])("a",{class:"close-btn",onClick:t[1]||(t[1]=(...t)=>e.disableReminder&&e.disableReminder(...t))},me)])),Object(n["createElementVNode"])("div",pe,[Object(n["createVNode"])(c,{modelValue:e.showFeedbackForm,"onUpdate:modelValue":t[3]||(t[3]=t=>e.showFeedbackForm=t),onValidation:t[4]||(t[4]=t=>e.sendFeedback())},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",je,[Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.translate("Feedback_Question"+e.question)),1),Object(n["createElementVNode"])("p",{innerHTML:e.$sanitize(e.translate("Feedback_FeedbackSubtitle","<i class='icon-heart red-text'></i>"))},null,8,Oe),ge,Object(n["createElementVNode"])("div",ve,[e.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",he,Object(n["toDisplayString"])(e.errorMessage),1)):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createElementVNode"])("textarea",{id:"message",class:Object(n["normalizeClass"])({"has-error":e.errorMessage}),"onUpdate:modelValue":t[2]||(t[2]=t=>e.feedbackMessage=t)},null,2),[[n["vModelText"],e.feedbackMessage]])]),fe,Object(n["createElementVNode"])("p",{innerHTML:e.$sanitize(e.feedbackPolicy)},null,8,Fe),Object(n["createElementVNode"])("input",{type:"button",role:"validation",value:e.translate("Feedback_SendFeedback")},null,8,Ve),Object(n["createElementVNode"])("input",{type:"button",role:"cancel",value:e.translate("General_Cancel")},null,8,ye)])]),_:1},8,["modelValue"]),Object(n["createVNode"])(c,{modelValue:e.feedbackDone,"onUpdate:modelValue":t[5]||(t[5]=t=>e.feedbackDone=t)},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",Ee,[Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.translate("Feedback_ThankYou")),1),Object(n["createElementVNode"])("p",{innerHTML:e.$sanitize(e.translate("Feedback_ThankYourForFeedback","<i class='icon-heart red-text'></i>"))},null,8,Ne),Object(n["createElementVNode"])("input",{type:"button",role:"cancel",value:e.translate("General_Close")},null,8,Re)])]),_:1},8,["modelValue"])])])}const{$:Me}=window,xe="feedback-question";var De=Object(n["defineComponent"])({props:{showQuestionBanner:Boolean},components:{MatomoDialog:se["MatomoDialog"]},computed:{isHidden(){return!this.showQuestionBanner||!!this.hide},feedbackPolicy(){return Object(se["translate"])("Feedback_Policy",Object(se["externalLink"])("https://matomo.org/privacy-policy/"),"</a>")}},data(){return{questionText:"",question:0,hide:null,feedbackDone:!1,expanded:!1,showFeedbackForm:!1,feedbackMessage:null,errorMessage:null}},watch:{showFeedbackForm(e){this.questionText=Object(se["translate"])("Feedback_Question"+this.question),e&&setInterval(()=>{Me("#message").focus()},500)}},created(){this.showQuestionBanner&&this.initQuestion()},methods:{initQuestion(){Object(se["getCookie"])(xe)?this.question=parseInt(Object(se["getCookie"])(xe)):this.question=this.getRandomIntBetween(0,4);const e=(this.question+1)%4,t=6048e5;Object(se["setCookie"])(xe,""+e,t)},getRandomIntBetween(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)},showQuestion(){this.showFeedbackForm=!0,this.errorMessage=null},disableReminder(){se["AjaxHelper"].fetch({method:"Feedback.updateFeedbackReminderDate"}),this.hide=!0},sendFeedback(){this.errorMessage=null,se["AjaxHelper"].fetch({method:"Feedback.sendFeedbackForSurvey",question:this.questionText,message:this.feedbackMessage}).then(e=>{"success"===e.value?(this.showFeedbackForm=!1,this.feedbackDone=!0,this.hide=!0):this.errorMessage=e.value})}}});De.render=we;var Be=De;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["Login"]=t(require("CoreHome"),require("vue")):e["Login"]=t(e["CoreHome"],e["Vue"])})("undefined"!==typeof self?self:this,(function(e,t){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Login/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"FormErrors",(function(){return b})),n.d(t,"BruteForceLog",(function(){return N})),"undefined"!==typeof window){var o=window.document.currentScript,r=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var l=n("8bbf");const c=["innerHTML"],i=Object(l["createElementVNode"])("br",null,null,-1);function a(e,t,n,o,r,a){const u=Object(l["resolveComponent"])("Notification");return Object.keys(e.formErrors||{}).length?(Object(l["openBlock"])(),Object(l["createBlock"])(u,{key:0,noclear:!0,context:"error"},{default:Object(l["withCtx"])(()=>[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.formErrors,(t,n)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",{key:n},[Object(l["createElementVNode"])("strong",null,Object(l["toDisplayString"])(e.translate("General_Error")),1),Object(l["createTextVNode"])(": "),Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize(t)},null,8,c),i]))),128))]),_:1})):Object(l["createCommentVNode"])("",!0)}var u=n("19dc"),s=Object(l["defineComponent"])({props:{formErrors:[Array,Object]},components:{Notification:u["Notification"]}});s.render=a;var b=s;const d={key:0},p={key:1,style:{"margin-left":"20px"}},j={key:2},f=Object(l["createElementVNode"])("br",null,null,-1),O=["value"],m={id:"confirmUnblockAllIps",class:"ui-confirm"},y=["value"],k=["value"],g={key:3},B={style:{"margin-left":"20px"}};function v(e,t,n,o,r,c){const i=Object(l["resolveComponent"])("ContentBlock");return Object(l["openBlock"])(),Object(l["createBlock"])(i,{"content-title":e.translate("Login_CurrentlyBlockedIPs")},{default:Object(l["withCtx"])(()=>[e.blockedIps.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("ul",p,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.blockedIps,(e,t)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("li",{style:{"list-style":"disc"},key:t},Object(l["toDisplayString"])(e),1))),128))])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("p",d,Object(l["toDisplayString"])(e.translate("UserCountryMap_None")),1)),e.blockedIps.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",j,[Object(l["createElementVNode"])("p",null,[f,Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("Login_CurrentlyBlockedIPsUnblockInfo")),1)]),Object(l["createElementVNode"])("div",null,[Object(l["createElementVNode"])("input",{type:"button",class:"btn",value:e.translate("Login_UnblockAllIPs"),onClick:t[0]||(t[0]=t=>e.unblockAllIps())},null,8,O)]),Object(l["createElementVNode"])("div",m,[Object(l["createElementVNode"])("h2",null,Object(l["toDisplayString"])(e.translate("Login_CurrentlyBlockedIPsUnblockConfirm")),1),Object(l["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,y),Object(l["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,k)])])):Object(l["createCommentVNode"])("",!0),e.disallowedIps.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",g,[Object(l["createElementVNode"])("h3",null,Object(l["toDisplayString"])(e.translate("Login_IPsAlwaysBlocked")),1),Object(l["createElementVNode"])("ul",B,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.disallowedIps,(e,t)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("li",{style:{"list-style":"disc"},key:t},Object(l["toDisplayString"])(e),1))),128))])])):Object(l["createCommentVNode"])("",!0)]),_:1},8,["content-title"])}var E=Object(l["defineComponent"])({props:{blockedIps:{type:Array,required:!0},disallowedIps:{type:Array,required:!0}},components:{ContentBlock:u["ContentBlock"]},methods:{unblockAllIps(){window.bruteForceLog.unblockAllIps()}}});E.render=v;var N=E;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("Login"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome","Login",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["TwoFactorAuth"]=t(require("CoreHome"),require("Login"),require("vue"),require("CorePluginsAdmin")):e["TwoFactorAuth"]=t(e["CoreHome"],e["Login"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,o,n){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/TwoFactorAuth/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},"5b81":function(e,o){e.exports=t},"8bbf":function(e,t){e.exports=o},a5a2:function(e,t){e.exports=n},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"ShowRecoveryCodes",(function(){return f})),o.d(t,"ShowRecoveryCodesPage",(function(){return S})),o.d(t,"SetupTwoFactorAuth",(function(){return de})),o.d(t,"LoginTwoFactorAuth",(function(){return Me})),o.d(t,"SetupFinished",(function(){return Ge})),o.d(t,"UserSettings",(function(){return dt})),"undefined"!==typeof window){var n=window.document.currentScript,r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(o.p=r[1])}var a=o("8bbf");const c=Object(a["createElementVNode"])("br",null,null,-1),l=Object(a["createElementVNode"])("br",null,null,-1),i={class:"alert alert-warning"},s={key:0,class:"twoFactorRecoveryCodes browser-default"},u={key:1,class:"alert alert-danger"},d=Object(a["createElementVNode"])("br",null,null,-1),b=["value"],p=["value"],m=["value"];function O(e,t,o,n,r,O){var j;const h=Object(a["resolveDirective"])("select-on-focus");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("TwoFactorAuth_RecoveryCodesExplanation")),1),c,l]),Object(a["createElementVNode"])("div",i,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_RecoveryCodesSecurity")),1),null!==(j=e.codes)&&void 0!==j&&j.length?Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("ul",s,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.codes,(e,t)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:t},Object(a["toDisplayString"])(e.toUpperCase().match(/.{1,4}/g).join("-")),1))),128))])),[[h,{}]]):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",u,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_RecoveryCodesAllUsed")),1)),Object(a["createElementVNode"])("p",null,[d,Object(a["createElementVNode"])("input",{type:"button",class:"btn backupRecoveryCode",onClick:t[0]||(t[0]=t=>{e.downloadRecoveryCodes(),e.$emit("downloaded")}),value:e.translate("General_Download"),style:{"margin-right":"3.5px"}},null,8,b),Object(a["createElementVNode"])("input",{type:"button",class:"btn backupRecoveryCode",onClick:t[1]||(t[1]=t=>{e.print(),e.$emit("downloaded")}),value:e.translate("General_Print"),style:{"margin-right":"3.5px"}},null,8,p),Object(a["createElementVNode"])("input",{type:"button",class:"btn backupRecoveryCode",onClick:t[2]||(t[2]=t=>{e.copyRecoveryCodesToClipboard(),e.$emit("downloaded")}),value:e.translate("General_Copy")},null,8,m)])])}var j=o("19dc"),h=Object(a["defineComponent"])({props:{codes:{type:Array,default(){return[]}}},directives:{SelectOnFocus:j["SelectOnFocus"]},emits:["downloaded"],methods:{copyRecoveryCodesToClipboard(){const e=document.createElement("textarea");e.value=this.codes.join("\n"),e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)},downloadRecoveryCodes(){j["Matomo"].helper.sendContentAsDownload("analytics_recovery_codes.txt",this.codes.join("\n"))},print(){window.print()}}});h.render=O;var f=h;const w=Object(a["createElementVNode"])("br",null,null,-1),y=Object(a["createElementVNode"])("br",null,null,-1),g={key:0,class:"alert alert-success"},v={key:1,class:"alert alert-danger"},C=["action"],N=["value"],E=["value"];function V(e,t,o,n,r,c){const l=Object(a["resolveComponent"])("ShowRecoveryCodes"),i=Object(a["resolveComponent"])("ContentBlock");return Object(a["openBlock"])(),Object(a["createBlock"])(i,{"content-title":e.contentTitle},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(l,{codes:e.codes},null,8,["codes"]),Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_GenerateNewRecoveryCodes")),1),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("TwoFactorAuth_GenerateNewRecoveryCodesInfo")),1),w,y]),e.regenerateSuccess?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",g,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_RecoveryCodesRegenerated")),1)):Object(a["createCommentVNode"])("",!0),e.regenerateError?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",v,Object(a["toDisplayString"])(e.translate("General_ExceptionSecurityCheckFailed")),1)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("form",{method:"post",action:e.showRecoveryCodesLink},[Object(a["createElementVNode"])("input",{type:"hidden",name:"regenerateNonce",value:e.regenerateNonce},null,8,N),Object(a["createElementVNode"])("input",{type:"submit",class:"btn",value:e.translate("TwoFactorAuth_GenerateNewRecoveryCodes")},null,8,E)],8,C)]),_:1},8,["content-title"])}var T=Object(a["defineComponent"])({props:{codes:Array,regenerateSuccess:Boolean,regenerateError:Boolean,regenerateNonce:{type:String,required:!0}},components:{ContentBlock:j["ContentBlock"],ShowRecoveryCodes:f},computed:{contentTitle(){const e=Object(j["translate"])("TwoFactorAuth_TwoFactorAuthentication"),t=Object(j["translate"])("TwoFactorAuth_RecoveryCodes");return`${e} - ${t}`},showRecoveryCodesLink(){return"?"+j["MatomoUrl"].stringify(Object.assign(Object.assign({},j["MatomoUrl"].urlParsed.value),{},{module:"TwoFactorAuth",action:"showRecoveryCodes"}))}}});T.render=V;var S=T;const A={class:"setupTwoFactorAuthentication",ref:"root"},F={key:0,class:"alert alert-warning"},k=["disabled"],_=Object(a["createElementVNode"])("a",{name:"twoFactorStep2",id:"twoFactorStep2",style:{opacity:"0"}},null,-1),D=["innerHTML"],B=Object(a["createElementVNode"])("br",null,null,-1),x=Object(a["createElementVNode"])("a",{name:"twoFactorStep3",id:"twoFactorStep3",style:{opacity:"0"}},null,-1),M={key:0,class:"message_container"},L=["innerHTML"],R=Object(a["createElementVNode"])("br",null,null,-1),q=["action"],U=["value"],P=["disabled","value"],G={class:"ui-confirm two-fa-qr-code-dialog"},H={class:"row"},$={class:"col l8 offset-l2 m10 offset-m1 s12 center-align"},I={id:"qrcode",ref:"qrcode",title:""},z={class:"text-code"},Q=["innerHTML"],X={class:"row"},Y={class:"col l8 offset-l2 m10 offset-m1 s12"},W=["value"],J=["value"];function K(e,t,o,n,r,c){const l=Object(a["resolveComponent"])("ShowRecoveryCodes"),i=Object(a["resolveComponent"])("InstallOTPApp"),s=Object(a["resolveComponent"])("Notification"),u=Object(a["resolveComponent"])("Field"),d=Object(a["resolveComponent"])("MatomoDialog"),b=Object(a["resolveComponent"])("ContentBlock"),p=Object(a["resolveDirective"])("copy-to-clipboard");return Object(a["openBlock"])(),Object(a["createBlock"])(b,{"content-title":e.standalone?e.translate("TwoFactorAuth_RequiredToSetUpTwoFactorAuthentication"):e.translate("TwoFactorAuth_SetUpTwoFactorAuthentication")},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",A,[e.isAlreadyUsing2fa?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",F,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_WarningChangingConfiguredDevice")),1)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_SetupIntroFollowSteps")),1),Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_StepX",1))+" - "+Object(a["toDisplayString"])(e.translate("TwoFactorAuth_RecoveryCodes")),1),Object(a["createVNode"])(l,{codes:e.codes,onDownloaded:t[0]||(t[0]=e=>this.hasDownloadedRecoveryCode=!0)},null,8,["codes"]),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",{class:"alert alert-info backupRecoveryCodesAlert"},Object(a["toDisplayString"])(e.translate("TwoFactorAuth_SetupBackupRecoveryCodes")),513),[[a["vShow"],1===e.step]]),Object(a["createElementVNode"])("p",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("button",{class:"btn goToStep2",onClick:t[1]||(t[1]=t=>e.nextStep()),disabled:!e.hasDownloadedRecoveryCode},Object(a["toDisplayString"])(e.translate("General_Next")),9,k),[[a["vShow"],1===e.step]])]),_,Object(a["withDirectives"])(Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_StepX",2))+" - "+Object(a["toDisplayString"])(e.translate("TwoFactorAuth_SetupAuthenticatorOnDevice")),1),Object(a["createVNode"])(i),Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.setupAuthenticatorOnDeviceStep2ShowCodes)},null,8,D),Object(a["createElementVNode"])("p",null,[B,Object(a["withDirectives"])(Object(a["createElementVNode"])("button",{class:"btn showOtpCodes",onClick:t[2]||(t[2]=t=>e.showQrCodeModal())},Object(a["toDisplayString"])(e.translate("TwoFactorAuth_ShowCodes")),513),[[a["vShow"],e.step>=2]])])],512),[[a["vShow"],e.step>=2]]),x,Object(a["withDirectives"])(Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_StepX",3))+" - "+Object(a["toDisplayString"])(e.translate("TwoFactorAuth_ConfirmSetup")),1),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_VerifyAuthCodeIntro")),1),e.accessErrorString?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",M,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(s,{noclear:!0,context:"error"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("General_Error")),1),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.accessErrorString)},null,8,L),R]),_:1})])])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("form",{method:"post",class:"setupConfirmAuthCodeForm",autocorrect:"off",autocapitalize:"none",autocomplete:"off",action:e.linkTo({module:"TwoFactorAuth",action:e.submitAction})},[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(u,{uicontrol:"text",name:"authCode",title:e.translate("TwoFactorAuth_AuthenticationCode"),modelValue:e.authCode,"onUpdate:modelValue":t[3]||(t[3]=t=>e.authCode=t),maxlength:6,placeholder:"123456",autocomplete:"one-time-code","inline-help":e.translate("TwoFactorAuth_VerifyAuthCodeHelp")},null,8,["title","modelValue","inline-help"])]),Object(a["createElementVNode"])("input",{type:"hidden",name:"authCodeNonce",value:e.authCodeNonce},null,8,U),Object(a["createElementVNode"])("input",{type:"submit",class:"btn confirmAuthCode",disabled:6!==e.authCode.length,value:e.translate("General_Confirm")},null,8,P)],8,q)],512),[[a["vShow"],e.step>=3]]),Object(a["createVNode"])(d,{modelValue:e.qrCodeDialogVisible,"onUpdate:modelValue":t[4]||(t[4]=t=>e.qrCodeDialogVisible=t),onValidation:t[5]||(t[5]=t=>{e.closeQrCodeModal(),e.nextStep()}),options:{focusSelector:".modal-action.btn"}},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",G,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_Your2FaAuthSecret")),1),Object(a["createElementVNode"])("div",H,[Object(a["createElementVNode"])("div",$,[Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_ShowCodeModalInstructions1")),1),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("span",I,null,512)]),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_ShowCodeModalInstructions2")),1),Object(a["createElementVNode"])("div",z,[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("pre",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.newSecret),1)])),[[p,{}]])]),Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.showCodeModalInstructions3)},null,8,Q)])]),Object(a["createElementVNode"])("div",X,[Object(a["createElementVNode"])("div",Y,[Object(a["createElementVNode"])("h3",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_DontHaveOTPApp")),1),Object(a["createVNode"])(i)])]),Object(a["createElementVNode"])("input",{role:"validation",type:"button",value:e.translate("General_Continue")},null,8,W),Object(a["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_Cancel")},null,8,J)])]),_:1},8,["modelValue","options"])],512)]),_:1},8,["content-title"])}var Z=o("a5a2");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */const ee=Object(a["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:"https://github.com/andOTP/andOTP#downloads"},"andOTP",-1),te=Object(a["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:"https://authy.com/guides/github/"},"Authy",-1),oe=Object(a["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:"https://support.1password.com/one-time-passwords/"},"1Password",-1),ne=Object(a["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:"https://helpdesk.lastpass.com/multifactor-authentication-options/lastpass-authenticator/"},"LastPass Authenticator",-1),re=Object(a["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:"https://support.google.com/accounts/answer/1066447"},"Google Authenticator",-1);function ae(e,t,o,n,r,c){return Object(a["openBlock"])(),Object(a["createElementBlock"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("TwoFactorAuth_SetupAuthenticatorOnDeviceStep1"))+" ",1),ee,Object(a["createTextVNode"])(", "),te,Object(a["createTextVNode"])(", "),oe,Object(a["createTextVNode"])(", "),ne,Object(a["createTextVNode"])(", "+Object(a["toDisplayString"])(e.translate("General_Or"))+" ",1),re,Object(a["createTextVNode"])(". ")])}var ce=Object(a["defineComponent"])({});ce.render=ae;var le=ce;const{QRCode:ie,$:se}=window;var ue=Object(a["defineComponent"])({props:{isAlreadyUsing2fa:Boolean,accessErrorString:String,submitAction:{type:String,required:!0},authCodeNonce:{type:String,required:!0},newSecret:{type:String,required:!0},codes:Array,twoFaBarCodeSetupUrl:{type:String,required:!0},standalone:Boolean},components:{InstallOTPApp:le,MatomoDialog:j["MatomoDialog"],ShowRecoveryCodes:f,Notification:j["Notification"],Field:Z["Field"],ContentBlock:j["ContentBlock"]},directives:{CopyToClipboard:j["CopyToClipboard"]},data(){return{step:1,hasDownloadedRecoveryCode:!1,authCode:"",qrCodeDialogVisible:!1}},mounted(){setTimeout(()=>{const e=this.$refs.qrcode;new ie(e,{text:this.twoFaBarCodeSetupUrl,width:200,height:200}),se(e).attr("title",""),this.accessErrorString&&(this.step=3,this.scrollToEnd())})},methods:{scrollToEnd(){setTimeout(()=>{let e="";2===this.step?e="#twoFactorStep2":3===this.step&&(e="#twoFactorStep3"),e&&j["Matomo"].helper.lazyScrollTo(e,50,!0)},50)},showQrCodeModal(){this.qrCodeDialogVisible=!0},closeQrCodeModal(){this.qrCodeDialogVisible=!1},nextStep(){this.step+=1,this.step>3&&(this.step=3),this.scrollToEnd()},linkTo(e){return"?"+j["MatomoUrl"].stringify(Object.assign(Object.assign({},j["MatomoUrl"].urlParsed.value),e))}},computed:{setupAuthenticatorOnDeviceStep2ShowCodes(){return Object(j["translate"])("TwoFactorAuth_SetupAuthenticatorOnDeviceStep2ShowCodes",Object(j["translate"])("TwoFactorAuth_ShowCodes"))},showCodeModalInstructions3(){return Object(j["translate"])("TwoFactorAuth_ShowCodeModalInstructions3",Object(j["translate"])("General_Continue"))}}});ue.render=K;var de=ue;const be={class:"message_container"},pe=["innerHTML"],me=Object(a["createElementVNode"])("br",null,null,-1),Oe={class:"row"},je={class:"col s12 input-field"},he=["value"],fe=Object(a["createElementVNode"])("input",{type:"text",name:"form_authcode",placeholder:"",id:"form_authcode",class:"input",value:"",size:"20",autocorrect:"off",autocapitalize:"none",autocomplete:"one-time-code",tabindex:"10",autofocus:"autofocus"},null,-1),we={for:"form_authcode"},ye=Object(a["createElementVNode"])("i",{class:"icon-user icon"},null,-1),ge={class:"row actions"},ve={class:"col s12"},Ce=["value"],Ne=["innerHTML"],Ee=Object(a["createElementVNode"])("br",null,null,-1),Ve=Object(a["createElementVNode"])("br",null,null,-1),Te=Object(a["createElementVNode"])("br",null,null,-1),Se=["href"],Ae=Object(a["createElementVNode"])("br",null,null,-1),Fe=["href"],ke=Object(a["createElementVNode"])("br",null,null,-1),_e=["href"];function De(e,t,o,n,r,c){const l=Object(a["resolveComponent"])("FormErrors"),i=Object(a["resolveComponent"])("Notification"),s=Object(a["resolveComponent"])("ContentBlock");return Object(a["openBlock"])(),Object(a["createBlock"])(s,{"content-title":e.translate("TwoFactorAuth_TwoFactorAuthentication")},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",be,[Object(a["createVNode"])(l,{"form-errors":e.formData.errors},null,8,["form-errors"]),e.accessErrorString?(Object(a["openBlock"])(),Object(a["createBlock"])(i,{key:0,noclear:!0,context:"error"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("General_Error")),1),Object(a["createTextVNode"])(": "),Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.accessErrorString)},null,8,pe),me]),_:1})):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("form",Object(a["mergeProps"])(e.formDataAttributes,{class:"loginTwoFaForm"}),[Object(a["createElementVNode"])("div",Oe,[Object(a["createElementVNode"])("div",je,[Object(a["createElementVNode"])("input",{type:"hidden",name:"form_nonce",id:"login_form_nonce",value:e.formNonce},null,8,he),fe,Object(a["createElementVNode"])("label",we,[ye,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("TwoFactorAuth_AuthenticationCode")),1)])])]),Object(a["createElementVNode"])("div",ge,[Object(a["createElementVNode"])("div",ve,[Object(a["createElementVNode"])("input",{class:"submit btn btn-block",id:"login_form_submit",type:"submit",value:e.translate("TwoFactorAuth_Verify"),tabindex:"100"},null,8,Ce)])])],16),Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("TwoFactorAuth_VerifyIdentifyExplanation"))+" ",1),Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.learnMoreText)},null,8,Ne),Ee,Ve,Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_DontHaveYourMobileDevice")),1),Te,Object(a["createElementVNode"])("a",{href:e.externalRawLink("https://matomo.org/faq/how-to/faq_27248"),rel:"noreferrer noopener",target:"_blank"},Object(a["toDisplayString"])(e.translate("TwoFactorAuth_EnterRecoveryCodeInstead")),9,Se),Ae,Object(a["createElementVNode"])("a",{href:e.mailToLink,rel:"noreferrer noopener"},Object(a["toDisplayString"])(e.translate("TwoFactorAuth_AskSuperUserResetAuthenticationCode")),9,Fe),ke,Object(a["createElementVNode"])("a",{href:e.logoutLink,rel:"noreferrer noopener"},Object(a["toDisplayString"])(e.translate("General_Logout")),9,_e)])]),_:1},8,["content-title"])}var Be=o("5b81"),xe=Object(a["defineComponent"])({props:{formData:{type:Object,required:!0},accessErrorString:String,formNonce:{type:String,required:!0},loginModule:{type:String,required:!0},piwikUrl:String,userLogin:{type:String,required:!0},contactEmail:{type:String,required:!0}},components:{ContentBlock:j["ContentBlock"],Notification:j["Notification"],FormErrors:Be["FormErrors"]},computed:{learnMoreText(){return Object(j["translate"])("General_LearnMore",Object(j["externalLink"])("https://matomo.org/faq/general/faq_27245"),"</a>")},mailToLink(){return`mailto:${this.contactEmail}?${j["MatomoUrl"].stringify({subject:Object(j["translate"])("TwoFactorAuth_NotPossibleToLogIn"),body:Object(j["translate"])("TwoFactorAuth_LostAuthenticationDevice","\n\n","\n\n",this.piwikUrl||"","\n\n",this.userLogin,Object(j["externalRawLink"])("https://matomo.org/faq/how-to/faq_27248"))})}`},logoutLink(){return"?"+j["MatomoUrl"].stringify({module:this.loginModule,action:"logout"})},formDataAttributes(){return Object.fromEntries(this.formData.attributes.split(/\s+/g).filter(e=>e).map(e=>e.split("=")).map(([e,t])=>[e,j["Matomo"].helper.htmlDecode(t.substr(1,t.length-2))]))}}});xe.render=De;var Me=xe;const Le={class:"successMessage"},Re=Object(a["createElementVNode"])("br",null,null,-1),qe=["href"];function Ue(e,t,o,n,r,c){const l=Object(a["resolveComponent"])("ContentBlock");return Object(a["openBlock"])(),Object(a["createBlock"])(l,{class:"twoFactorSetupFinished"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("h2",Le,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_SetupFinishedTitle")),1),Object(a["createElementVNode"])("h3",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_SetupFinishedSubtitle")),1),Object(a["createElementVNode"])("p",null,[Re,Object(a["createElementVNode"])("a",{class:"btn",href:e.userSecurityLink},Object(a["toDisplayString"])(e.translate("General_Continue")),9,qe)])]),_:1})}var Pe=Object(a["defineComponent"])({components:{ContentBlock:j["ContentBlock"]},computed:{userSecurityLink(){return"?"+j["MatomoUrl"].stringify(Object.assign(Object.assign({},j["MatomoUrl"].urlParsed.value),{},{module:"UsersManager",action:"userSecurity"}))}}});Pe.render=Ue;var Ge=Pe;const He=["innerHTML"],$e={key:0},Ie={class:"twoFaStatusEnabled"},ze={key:1},Qe={key:0},Xe=Object(a["createElementVNode"])("br",null,null,-1),Ye=Object(a["createElementVNode"])("br",null,null,-1),We=["href"],Je={key:1},Ke=["href"],Ze=["href"],et=["value"],tt=["href"],ot={key:2},nt=Object(a["createElementVNode"])("br",null,null,-1),rt=Object(a["createElementVNode"])("br",null,null,-1),at=["href"],ct={id:"confirmDisable2FA",class:"ui-confirm",ref:"confirmDisable2FA"},lt=["value"],it=["value"];function st(e,t,o,n,r,c){const l=Object(a["resolveComponent"])("ContentBlock");return Object(a["openBlock"])(),Object(a["createBlock"])(l,{"content-title":e.contentTitle,class:"userSettings2FA"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.twoFactorAuthIntro)},null,8,He),e.isEnabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",$e,[Object(a["createElementVNode"])("strong",Ie,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_TwoFactorAuthenticationIsEnabled")),1)])):Object(a["createCommentVNode"])("",!0),e.isEnabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",ze,[e.isForced?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Qe,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("TwoFactorAuth_TwoFactorAuthenticationRequired"))+" ",1),Xe,Ye,Object(a["createElementVNode"])("a",{class:"btn btn-link enable2FaLink",href:e.setupTwoFactorAuthLink,style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("TwoFactorAuth_ConfigureDifferentDevice")),9,We)])):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Je,[Object(a["createElementVNode"])("a",{class:"btn btn-link enable2FaLink",href:e.setupTwoFactorAuthLink,style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("TwoFactorAuth_ConfigureDifferentDevice")),9,Ke),Object(a["createElementVNode"])("a",{href:e.disableTwoFactorAuthLink,style:{display:"none"},id:"disable2fa"},"disable2fa",8,Ze),Object(a["createElementVNode"])("input",{type:"button",class:"btn btn-link disable2FaLink",onClick:t[0]||(t[0]=t=>e.onDisable2FaLinkClick()),value:e.translate("TwoFactorAuth_DisableTwoFA"),style:{"margin-right":"3.5px"}},null,8,et)])),Object(a["createElementVNode"])("a",{class:"btn btn-link showRecoveryCodesLink",href:e.showRecoveryCodesLink},Object(a["toDisplayString"])(e.translate("TwoFactorAuth_ShowRecoveryCodes")),9,tt)])):(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",ot,[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_TwoFactorAuthenticationIsDisabled")),1),nt,rt,Object(a["createElementVNode"])("a",{class:"btn btn-link enable2FaLink",href:e.setupTwoFactorAuthLink},Object(a["toDisplayString"])(e.translate("TwoFactorAuth_EnableTwoFA")),9,at)])),Object(a["createElementVNode"])("div",ct,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("TwoFactorAuth_ConfirmDisableTwoFA")),1),Object(a["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,lt),Object(a["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,it)],512)]),_:1},8,["content-title"])}var ut=Object(a["defineComponent"])({props:{isEnabled:Boolean,isForced:Boolean,disableNonce:{type:String,required:!0}},components:{ContentBlock:j["ContentBlock"]},computed:{contentTitle(){const e=Object(j["translate"])("TwoFactorAuth_TwoFactorAuthentication"),t=Object(j["translate"])("TwoFactorAuth_TwoFAShort");return`${e} (${t})`},twoFactorAuthIntro(){return Object(j["translate"])("TwoFactorAuth_TwoFactorAuthenticationIntro",Object(j["externalLink"])("https://matomo.org/faq/general/faq_27245"),"</a>")},setupTwoFactorAuthLink(){return"?"+j["MatomoUrl"].stringify(Object.assign(Object.assign({},j["MatomoUrl"].urlParsed.value),{},{module:"TwoFactorAuth",action:"setupTwoFactorAuth"}))},disableTwoFactorAuthLink(){return"?"+j["MatomoUrl"].stringify(Object.assign(Object.assign({},j["MatomoUrl"].urlParsed.value),{},{module:"TwoFactorAuth",action:"disableTwoFactorAuth",disableNonce:this.disableNonce}))},showRecoveryCodesLink(){return"?"+j["MatomoUrl"].stringify(Object.assign(Object.assign({},j["MatomoUrl"].urlParsed.value),{},{module:"TwoFactorAuth",action:"showRecoveryCodes"}))}},methods:{onDisable2FaLinkClick(){const e=this.disableNonce;j["Matomo"].helper.modalConfirm(this.$refs.confirmDisable2FA,{yes(){j["MatomoUrl"].updateUrl({module:"TwoFactorAuth",action:"disableTwoFactorAuth",disableNonce:e})}})}}});ut.render=st;var dt=ut;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["UsersManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["UsersManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,s){return function(e){var t={};function s(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="plugins/UsersManager/vue/dist/",s(s.s="fae3")}({"19dc":function(t,s){t.exports=e},"8bbf":function(e,s){e.exports=t},a5a2:function(e,t){e.exports=s},fae3:function(e,t,s){"use strict";if(s.r(t),s.d(t,"CapabilitiesEdit",(function(){return k})),s.d(t,"UserPermissionsEdit",(function(){return De})),s.d(t,"UserEditForm",(function(){return kt})),s.d(t,"UserInvite",(function(){return Dt})),s.d(t,"ResendInviteModal",(function(){return Wt})),s.d(t,"PagedUsersList",(function(){return On})),s.d(t,"UsersManager",(function(){return Bn})),s.d(t,"AnonymousSettings",(function(){return Rn})),s.d(t,"NewsletterSettings",(function(){return Fn})),s.d(t,"PersonalSettings",(function(){return Kn})),s.d(t,"AddNewToken",(function(){return gr})),s.d(t,"AddNewTokenSuccess",(function(){return kr})),s.d(t,"UserSecurity",(function(){return Zr})),s.d(t,"UserSettings",(function(){return ia})),"undefined"!==typeof window){var n=window.document.currentScript,r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(s.p=r[1])}var a=s("8bbf");const i=["title"],o=["onClick"],l={key:0,class:"addCapability"},c={class:"ui-confirm confirmCapabilityToggle modal",ref:"confirmCapabilityToggleModal"},d={class:"modal-content"},u=["innerHTML"],m=["innerHTML"],b={class:"modal-footer"};function p(e,t,s,n,r,p){const h=Object(a["resolveComponent"])("Field");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])(["capabilitiesEdit",{busy:e.isBusy}])},[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.actualCapabilities,t=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:t.id,class:"chip"},[Object(a["createElementVNode"])("span",{class:"capability-name",title:`${t.description} ${e.isIncludedInRole(t)?"<br/><br/>"+e.translate("UsersManager_IncludedInUsersRole"):""}`},Object(a["toDisplayString"])(t.category)+": "+Object(a["toDisplayString"])(t.name),9,i),e.isIncludedInRole(t)?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,class:"icon-close",onClick:s=>{e.capabilityToRemoveId=t.id,e.onToggleCapability(!1)}},null,8,o))]))),128)),e.availableCapabilitiesGrouped.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",l,["noaccess"!==e.userRole?(Object(a["openBlock"])(),Object(a["createBlock"])(h,{key:0,"model-value":e.capabilityToAddId,"onUpdate:modelValue":t[0]||(t[0]=t=>{e.capabilityToAddId=t,e.onToggleCapability(!0)}),disabled:e.isBusy,uicontrol:"expandable-select",name:"add_capability","full-width":!0,options:e.availableCapabilitiesGrouped},null,8,["model-value","disabled","options"])):Object(a["createCommentVNode"])("",!0)])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",c,[Object(a["createElementVNode"])("div",d,[e.isAddingCapability?(Object(a["openBlock"])(),Object(a["createElementBlock"])("h2",{key:0,innerHTML:e.$sanitize(e.confirmAddCapabilityToggleContent)},null,8,u)):Object(a["createCommentVNode"])("",!0),e.isAddingCapability?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("h2",{key:1,innerHTML:e.$sanitize(e.confirmCapabilityToggleContent)},null,8,m))]),Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close btn",onClick:t[1]||(t[1]=Object(a["withModifiers"])(t=>e.toggleCapability(),["prevent"]))},Object(a["toDisplayString"])(e.translate("General_Yes")),1),Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close modal-no",onClick:t[2]||(t[2]=Object(a["withModifiers"])(t=>{e.capabilityToAddOrRemove=null,e.capabilityToAddId=null,e.capabilityToRemoveId=null},["prevent"]))},Object(a["toDisplayString"])(e.translate("General_No")),1)])],512)],2)}var h=s("19dc"),g=s("a5a2");function O(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class j{constructor(){O(this,"privateState",Object(a["reactive"])({isLoading:!1,capabilities:[]})),O(this,"state",Object(a["computed"])(()=>Object(a["readonly"])(this.privateState))),O(this,"capabilities",Object(a["computed"])(()=>this.state.value.capabilities)),O(this,"isLoading",Object(a["computed"])(()=>this.state.value.isLoading)),O(this,"fetchPromise",void 0)}init(){return this.fetchCapabilities()}fetchCapabilities(){return this.fetchPromise||(this.privateState.isLoading=!0,this.fetchPromise=h["AjaxHelper"].fetch({method:"UsersManager.getAvailableCapabilities"}).then(e=>(this.privateState.capabilities=e,this.capabilities.value)).finally(()=>{this.privateState.isLoading=!1})),this.fetchPromise}}var f=new j;const{$:v}=window;var C=Object(a["defineComponent"])({props:{idsite:[String,Number],siteName:{type:String,required:!0},userLogin:{type:String,required:!0},userRole:{type:String,required:!0},capabilities:Array},components:{Field:g["Field"]},data(){return{theCapabilities:this.capabilities||[],isBusy:!1,isAddingCapability:!1,capabilityToAddId:null,capabilityToRemoveId:null,capabilityToAddOrRemove:null}},emits:["change"],watch:{capabilities(e){e&&(this.theCapabilities=e)}},created(){f.init(),this.capabilities?this.theCapabilities=this.capabilities:(this.isBusy=!0,h["AjaxHelper"].fetch({method:"UsersManager.getUsersPlusRole",limit:"1",filter_search:this.userLogin}).then(e=>e&&e.capabilities?e.capabilities:[]).then(e=>{this.theCapabilities=e}).finally(()=>{this.isBusy=!1}))},methods:{onToggleCapability(e){this.isAddingCapability=e;const t=e?this.capabilityToAddId:this.capabilityToRemoveId;this.capabilityToAddOrRemove=null,this.availableCapabilities.forEach(e=>{e.id===t&&(this.capabilityToAddOrRemove=e)}),this.$refs.confirmCapabilityToggleModal&&v(this.$refs.confirmCapabilityToggleModal).modal({dismissible:!1,yes:()=>null}).modal("open")},toggleCapability(){this.isAddingCapability?this.addCapability(this.capabilityToAddOrRemove):this.removeCapability(this.capabilityToAddOrRemove)},isIncludedInRole(e){return-1!==(e.includedInRoles||[]).indexOf(this.userRole)},getCapabilitiesList(){const e=[];return this.availableCapabilities.forEach(t=>{this.isIncludedInRole(t)||this.capabilitiesSet[t.id]&&e.push(t.id)}),e},addCapability(e){this.isBusy=!0,h["AjaxHelper"].post({method:"UsersManager.addCapabilities"},{userLogin:this.userLogin,capabilities:e.id,idSites:this.idsite}).then(()=>{this.$emit("change",this.getCapabilitiesList())}).finally(()=>{this.isBusy=!1,this.capabilityToAddOrRemove=null,this.capabilityToAddId=null,this.capabilityToRemoveId=null})},removeCapability(e){this.isBusy=!0,h["AjaxHelper"].post({method:"UsersManager.removeCapabilities"},{userLogin:this.userLogin,capabilities:e.id,idSites:this.idsite}).then(()=>{this.$emit("change",this.getCapabilitiesList())}).finally(()=>{this.isBusy=!1,this.capabilityToAddOrRemove=null,this.capabilityToAddId=null,this.capabilityToRemoveId=null})}},computed:{availableCapabilities(){return f.capabilities.value},confirmAddCapabilityToggleContent(){return Object(h["translate"])("UsersManager_AreYouSureAddCapability",`<strong>${this.userLogin}</strong>`,`<strong>${this.capabilityToAddOrRemove?this.capabilityToAddOrRemove.name:""}</strong>`,`<strong>${this.siteNameText}</strong>`)},confirmCapabilityToggleContent(){return Object(h["translate"])("UsersManager_AreYouSureRemoveCapability",`<strong>${this.capabilityToAddOrRemove?this.capabilityToAddOrRemove.name:""}</strong>`,`<strong>${this.userLogin}</strong>`,`<strong>${this.siteNameText}</strong>`)},siteNameText(){return h["Matomo"].helper.htmlEntities(this.siteName)},availableCapabilitiesGrouped(){const e=this.availableCapabilities.filter(e=>!this.capabilitiesSet[e.id]).map(e=>({group:e.category,key:e.id,value:e.name,tooltip:e.description}));return e.sort((e,t)=>e.group===t.group?e.value===t.value?0:e.value<t.value?-1:1:e.group<t.group?-1:1),e},capabilitiesSet(){const e={},t=this.theCapabilities;return(t||[]).forEach(t=>{e[t]=!0}),(this.availableCapabilities||[]).forEach(t=>{this.isIncludedInRole(t)&&(e[t.id]=!0)}),e},actualCapabilities(){const{capabilitiesSet:e}=this;return this.availableCapabilities.filter(t=>!!e[t.id])}}});C.render=p;var k=C;const y={key:0,class:"row"},S={class:"row to-all-websites"},N={class:"col s12"},U={style:{"margin-right":"3.5px"}},V={id:"all-sites-access-select",style:{"margin-right":"3.5px"}},E={style:{"margin-top":"18px"}},w={class:"filters row"},T={class:"col s12 m12 l8"},A={class:"input-field bulk-actions",style:{"margin-right":"3.5px"}},M={id:"user-permissions-edit-bulk-actions",class:"dropdown-content"},B={class:"dropdown-trigger","data-target":"user-permissions-bulk-set-access"},_={id:"user-permissions-bulk-set-access",class:"dropdown-content"},x=["onClick"],D={class:"input-field site-filter",style:{"margin-right":"3.5px"}},L=["value","placeholder"],R={class:"input-field access-filter",style:{"margin-right":"3.5px"}},P={key:0,class:"col s12 m12 l4 sites-for-permission-pagination-container"},H={class:"sites-for-permission-pagination"},I={class:"counter"},F=["textContent"],q={class:"roles-help-notification"},z=["innerHTML"],G={class:"capabilities-help-notification"},W={id:"sitesForPermission"},Y={class:"select-cell"},X={class:"checkbox-container"},K=["checked"],J=Object(a["createElementVNode"])("span",null,null,-1),Q={class:"role_header"},Z=["innerHTML"],ee=Object(a["createElementVNode"])("span",{class:"icon-help"},null,-1),te=[ee],se={class:"capabilities_header"},ne=["innerHTML"],re=Object(a["createElementVNode"])("span",{class:"icon-help"},null,-1),ae=[re],ie={key:0,class:"select-all-row"},oe={colspan:"4"},le={key:0},ce=["innerHTML"],de=["innerHTML"],ue={key:1},me=["innerHTML"],be=["innerHTML"],pe={class:"select-cell"},he={class:"checkbox-container"},ge=["id","onUpdate:modelValue"],Oe=Object(a["createElementVNode"])("span",null,null,-1),je={class:"role-select"},fe={class:"delete-access-confirm-modal modal",ref:"deleteAccessConfirmModal"},ve={class:"modal-content"},Ce=["innerHTML"],ke=["innerHTML"],ye={class:"modal-footer"},Se={class:"change-access-confirm-modal modal",ref:"changeAccessConfirmModal"},Ne={class:"modal-content"},Ue=["innerHTML"],Ve=["innerHTML"],Ee={class:"modal-footer"},we={class:"confirm-give-access-all-sites modal",ref:"confirmGiveAccessAllSitesModal"},Te={class:"modal-content"},Ae=["innerHTML"],Me={class:"modal-footer"};function Be(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Notification"),l=Object(a["resolveComponent"])("Field"),c=Object(a["resolveComponent"])("CapabilitiesEdit"),d=Object(a["resolveDirective"])("dropdown-menu"),u=Object(a["resolveDirective"])("content-table");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])(["userPermissionsEdit",{loading:e.isLoadingAccess}])},[e.hasAccessToAtLeastOneSite?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",y,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{context:"warning",type:"transient",noclear:!0},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("General_Warning"))+":",1),Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("UsersManager_NoAccessWarning")),1)]),_:1})])])),Object(a["createElementVNode"])("div",S,[Object(a["createElementVNode"])("div",N,[Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("span",U,Object(a["toDisplayString"])(e.translate("UsersManager_GiveAccessToAll"))+":",1),Object(a["createElementVNode"])("div",V,[Object(a["createVNode"])(l,{modelValue:e.allWebsitesAccssLevelSet,"onUpdate:modelValue":t[0]||(t[0]=t=>e.allWebsitesAccssLevelSet=t),uicontrol:"select",options:e.filteredAccessLevels,"full-width":!0},null,8,["modelValue","options"])]),Object(a["createElementVNode"])("a",{href:"",class:Object(a["normalizeClass"])(["btn",{disabled:e.isGivingAccessToAllSites}]),onClick:t[1]||(t[1]=Object(a["withModifiers"])(t=>e.showChangeAccessAllSitesModal(),["prevent"]))},Object(a["toDisplayString"])(e.translate("General_Apply")),3)]),Object(a["createElementVNode"])("p",E,Object(a["toDisplayString"])(e.translate("UsersManager_OrManageIndividually"))+":",1)])]),Object(a["createElementVNode"])("div",w,[Object(a["createElementVNode"])("div",T,[Object(a["createElementVNode"])("div",A,[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("a",{class:Object(a["normalizeClass"])(["dropdown-trigger btn",{disabled:e.isBulkActionsDisabled}]),href:"","data-target":"user-permissions-edit-bulk-actions"},[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_BulkActions")),1)],2)),[[d,{activates:"#user-permissions-edit-bulk-actions"}]]),Object(a["createElementVNode"])("ul",M,[Object(a["createElementVNode"])("li",null,[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("a",B,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_SetPermission")),1)])),[[d,{activates:"#user-permissions-bulk-set-access"}]]),Object(a["createElementVNode"])("ul",_,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.filteredAccessLevels,t=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:t.key},[Object(a["createElementVNode"])("a",{href:"",onClick:Object(a["withModifiers"])(s=>{e.siteAccessToChange=null,e.roleToChangeTo=t.key,e.showChangeAccessConfirm()},["prevent"])},Object(a["toDisplayString"])(t.value),9,x)]))),128))])]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("a",{href:"",onClick:t[2]||(t[2]=Object(a["withModifiers"])(t=>{e.siteAccessToChange=null,e.roleToChangeTo="noaccess",e.showRemoveAccessConfirm()},["prevent"]))},Object(a["toDisplayString"])(e.translate("UsersManager_RemovePermissions")),1)])])]),Object(a["createElementVNode"])("div",D,[Object(a["createElementVNode"])("input",{type:"text",value:e.siteNameFilter,onKeydown:t[3]||(t[3]=t=>{e.onChangeSiteFilter(t)}),onChange:t[4]||(t[4]=t=>{e.onChangeSiteFilter(t)}),placeholder:e.translate("UsersManager_FilterByWebsite")},null,40,L)]),Object(a["createElementVNode"])("div",R,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(l,{modelValue:e.accessLevelFilter,"onUpdate:modelValue":t[5]||(t[5]=t=>e.accessLevelFilter=t),uicontrol:"select",options:e.filteredSelectAccessLevels,"full-width":!0,placeholder:e.translate("UsersManager_FilterByAccess")},null,8,["modelValue","options","placeholder"])])])]),e.totalEntries>e.limit?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",P,[Object(a["createElementVNode"])("div",H,[Object(a["createElementVNode"])("a",{class:Object(a["normalizeClass"])(["prev",{disabled:e.offset<=0}])},[Object(a["createElementVNode"])("span",{class:"pointer",onClick:t[6]||(t[6]=t=>e.gotoPreviousPage())},"« "+Object(a["toDisplayString"])(e.translate("General_Previous")),1)],2),Object(a["createElementVNode"])("span",I,[Object(a["createElementVNode"])("span",{textContent:Object(a["toDisplayString"])(e.paginationText)},null,8,F)]),Object(a["createElementVNode"])("a",{class:Object(a["normalizeClass"])(["next",{disabled:e.offset+e.limit>=e.totalEntries}])},[Object(a["createElementVNode"])("span",{class:"pointer",onClick:t[7]||(t[7]=t=>e.gotoNextPage())},Object(a["toDisplayString"])(e.translate("General_Next"))+" »",1)],2)])])):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("div",q,[e.isRoleHelpToggled?(Object(a["openBlock"])(),Object(a["createBlock"])(o,{key:0,context:"info",type:"persistent",noclear:!0},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.rolesHelpText)},null,8,z)]),_:1})):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("div",G,[e.isCapabilitiesHelpToggled?(Object(a["openBlock"])(),Object(a["createBlock"])(o,{key:0,context:"info",type:"persistent",noclear:!0},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(e.translate("UsersManager_CapabilitiesHelp")),1)]),_:1})):Object(a["createCommentVNode"])("",!0)]),Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("table",W,[Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",Y,[Object(a["createElementVNode"])("span",X,[Object(a["createElementVNode"])("label",null,[Object(a["createElementVNode"])("input",{type:"checkbox",id:"perm_edit_select_all",checked:e.isAllCheckboxSelected,onChange:t[8]||(t[8]=t=>e.onAllCheckboxChange(t))},null,40,K),J])])]),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("General_Name")),1),Object(a["createElementVNode"])("th",Q,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("UsersManager_Role")+" ")},null,8,Z),Object(a["createElementVNode"])("a",{href:"",class:Object(a["normalizeClass"])(["helpIcon",{sticky:e.isRoleHelpToggled}]),onClick:t[9]||(t[9]=Object(a["withModifiers"])(t=>e.isRoleHelpToggled=!e.isRoleHelpToggled,["prevent"]))},te,2)]),Object(a["createElementVNode"])("th",se,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("UsersManager_Capabilities")+" ")},null,8,ne),Object(a["createElementVNode"])("a",{href:"",class:Object(a["normalizeClass"])(["helpIcon",{sticky:e.isCapabilitiesHelpToggled}]),onClick:t[10]||(t[10]=Object(a["withModifiers"])(t=>e.isCapabilitiesHelpToggled=!e.isCapabilitiesHelpToggled,["prevent"]))},ae,2)])])]),Object(a["createElementVNode"])("tbody",null,[e.isAllCheckboxSelected&&e.siteAccess.length<e.totalEntries?(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",ie,[Object(a["createElementVNode"])("td",oe,[e.areAllResultsSelected?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",le,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.theDisplayedWebsitesAreSelectedText),style:{"margin-right":"3.5px"}},null,8,ce),Object(a["createElementVNode"])("a",{href:"#",onClick:t[11]||(t[11]=Object(a["withModifiers"])(t=>e.areAllResultsSelected=!e.areAllResultsSelected,["prevent"])),innerHTML:e.$sanitize(e.clickToSelectAllText)},null,8,de)])),e.areAllResultsSelected?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",ue,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.allWebsitesAreSelectedText),style:{"margin-right":"3.5px"}},null,8,me),Object(a["createElementVNode"])("a",{href:"#",onClick:t[12]||(t[12]=Object(a["withModifiers"])(t=>e.areAllResultsSelected=!e.areAllResultsSelected,["prevent"])),innerHTML:e.$sanitize(e.clickToSelectDisplayedWebsitesText)},null,8,be)])):Object(a["createCommentVNode"])("",!0)])])):Object(a["createCommentVNode"])("",!0),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.siteAccess,(s,n)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{key:s.idsite},[Object(a["createElementVNode"])("td",pe,[Object(a["createElementVNode"])("span",he,[Object(a["createElementVNode"])("label",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"checkbox",id:"perm_edit_select_row"+n,"onUpdate:modelValue":t=>e.selectedRows[n]=t,onClick:t[13]||(t[13]=t=>e.onRowSelected())},null,8,ge),[[a["vModelCheckbox"],e.selectedRows[n]]]),Oe])])]),Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(s.site_name),1)]),Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("div",je,[Object(a["createVNode"])(l,{"model-value":s.role,"onUpdate:modelValue":t=>{e.onRoleChange(s,t)},"model-modifiers":{abortable:!0},uicontrol:"select",options:e.filteredAccessLevels,"full-width":!0},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(c,{idsite:s.idsite,"site-name":s.site_name,"user-login":e.userLogin,"user-role":s.role,capabilities:s.capabilities,onChange:t[14]||(t[14]=t=>e.fetchAccess())},null,8,["idsite","site-name","user-login","user-role","capabilities"])])])]))),128))])])),[[u]]),Object(a["createElementVNode"])("div",fe,[Object(a["createElementVNode"])("div",ve,[e.siteAccessToChange?(Object(a["openBlock"])(),Object(a["createElementBlock"])("h3",{key:0,innerHTML:e.$sanitize(e.deletePermConfirmSingleText)},null,8,Ce)):Object(a["createCommentVNode"])("",!0),e.siteAccessToChange?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",{key:1,innerHTML:e.$sanitize(e.deletePermConfirmMultipleText)},null,8,ke))]),Object(a["createElementVNode"])("div",ye,[Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close btn",onClick:t[15]||(t[15]=Object(a["withModifiers"])(t=>e.changeUserRole(),["prevent"])),style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("General_Yes")),1),Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close modal-no",onClick:t[16]||(t[16]=Object(a["withModifiers"])(t=>{e.siteAccessToChange=null,e.roleToChangeTo=null},["prevent"]))},Object(a["toDisplayString"])(e.translate("General_No")),1)])],512),Object(a["createElementVNode"])("div",Se,[Object(a["createElementVNode"])("div",Ne,[e.siteAccessToChange?(Object(a["openBlock"])(),Object(a["createElementBlock"])("h3",{key:0,innerHTML:e.$sanitize(e.changePermToSiteConfirmSingleText)},null,8,Ue)):Object(a["createCommentVNode"])("",!0),e.siteAccessToChange?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",{key:1,innerHTML:e.$sanitize(e.changePermToSiteConfirmMultipleText)},null,8,Ve))]),Object(a["createElementVNode"])("div",Ee,[Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close btn",onClick:t[17]||(t[17]=Object(a["withModifiers"])(t=>e.changeUserRole(),["prevent"])),style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("General_Yes")),1),Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close modal-no",onClick:t[18]||(t[18]=Object(a["withModifiers"])(t=>{e.accessChangeEvent&&e.accessChangeEvent.abort(),e.siteAccessToChange=null,e.roleToChangeTo=null},["prevent"]))},Object(a["toDisplayString"])(e.translate("General_No")),1)])],512),Object(a["createElementVNode"])("div",we,[Object(a["createElementVNode"])("div",Te,[Object(a["createElementVNode"])("h3",{innerHTML:e.$sanitize(e.changePermToAllSitesConfirmText)},null,8,Ae),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("UsersManager_ChangePermToAllSitesConfirm2")),1)]),Object(a["createElementVNode"])("div",Me,[Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close btn",onClick:t[19]||(t[19]=Object(a["withModifiers"])(t=>e.giveAccessToAllSites(),["prevent"])),style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("General_Yes")),1),Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close modal-no",onClick:t[20]||(t[20]=e=>e.preventDefault())},Object(a["toDisplayString"])(e.translate("General_No")),1)])],512)],2)}const{$:_e}=window;var xe=Object(a["defineComponent"])({props:{userLogin:{type:String,required:!0},limit:{type:Number,default:10},accessLevels:{type:Array,required:!0},filterAccessLevels:{type:Array,required:!0}},components:{Notification:h["Notification"],Field:g["Field"],CapabilitiesEdit:k},directives:{DropdownMenu:h["DropdownMenu"],ContentTable:h["ContentTable"]},data(){return{siteAccess:[],offset:0,totalEntries:null,accessLevelFilter:"",siteNameFilter:"",isLoadingAccess:!1,allWebsitesAccssLevelSet:"view",isAllCheckboxSelected:!1,selectedRows:{},isBulkActionsDisabled:!0,areAllResultsSelected:!1,accessChangeEvent:null,hasAccessToAtLeastOneSite:!0,isRoleHelpToggled:!1,isCapabilitiesHelpToggled:!1,isGivingAccessToAllSites:!1,roleToChangeTo:null,siteAccessToChange:null}},emits:["userHasAccessDetected","accessChanged"],created(){this.onChangeSiteFilter=Object(h["debounce"])(this.onChangeSiteFilter,300),Object(a["watch"])(()=>this.allPropsWatch,()=>{this.limit&&this.fetchAccess()}),this.fetchAccess()},watch:{accessLevelFilter(){this.offset=0,this.fetchAccess()}},methods:{onAllCheckboxChange(e){this.isAllCheckboxSelected=e.target.checked,this.isAllCheckboxSelected?(this.siteAccess.forEach((e,t)=>{this.selectedRows[t]=!0}),this.isBulkActionsDisabled=!1):this.clearSelection()},clearSelection(){this.selectedRows={},this.areAllResultsSelected=!1,this.isBulkActionsDisabled=!0,this.isAllCheckboxSelected=!1,this.siteAccessToChange=null},onRowSelected(){setTimeout(()=>{const e=this.selectedRowsCount;this.isBulkActionsDisabled=0===e,this.isAllCheckboxSelected=e===this.siteAccess.length})},fetchAccess(){return this.isLoadingAccess=!0,h["AjaxHelper"].fetch({method:"UsersManager.getSitesAccessForUser",limit:this.limit,offset:this.offset,filter_search:this.siteNameFilter,filter_access:this.accessLevelFilter,userLogin:this.userLogin},{returnResponseObject:!0}).then(e=>{const t=e.getRequestHandle();this.isLoadingAccess=!1,this.siteAccess=t.responseJSON,this.totalEntries=parseInt(t.getResponseHeader("x-matomo-total-results"),10)||0,this.hasAccessToAtLeastOneSite=!!t.getResponseHeader("x-matomo-has-some"),this.$emit("userHasAccessDetected",{hasAccess:this.hasAccessToAtLeastOneSite}),this.clearSelection()}).catch(()=>{this.isLoadingAccess=!1,this.clearSelection()})},gotoPreviousPage(){this.offset=Math.max(0,this.offset-this.limit),this.fetchAccess()},gotoNextPage(){const e=this.offset+this.limit;e>=(this.totalEntries||0)||(this.offset=e,this.fetchAccess())},showRemoveAccessConfirm(){_e(this.$refs.deleteAccessConfirmModal).modal({dismissible:!1}).modal("open")},changeUserRole(){const e=()=>{const e=[];return Object.keys(this.selectedRows).forEach(t=>{this.selectedRows[t]&&this.siteAccess[t]&&e.push(this.siteAccess[t].idsite)}),e},t=()=>h["AjaxHelper"].fetch({method:"UsersManager.getSitesAccessForUser",filter_search:this.siteNameFilter,filter_access:this.accessLevelFilter,userLogin:this.userLogin,filter_limit:"-1"}).then(e=>e.map(e=>e.idsite));return this.isLoadingAccess=!0,Promise.resolve().then(()=>this.siteAccessToChange?[this.siteAccessToChange.idsite]:this.areAllResultsSelected?t():e()).then(e=>h["AjaxHelper"].post({method:"UsersManager.setUserAccess"},{userLogin:this.userLogin,access:this.roleToChangeTo,idSites:e})).catch(()=>{}).then(()=>(this.$emit("accessChanged"),this.fetchAccess()))},showChangeAccessConfirm(){_e(this.$refs.changeAccessConfirmModal).modal({dismissible:!1,onCloseEnd:()=>{this.accessChangeEvent=null}}).modal("open")},getRoleDisplay(e){let t=null;return this.filteredAccessLevels.forEach(s=>{s.key===e&&(t=s.value)}),t},giveAccessToAllSites(){this.isGivingAccessToAllSites=!0,h["AjaxHelper"].fetch({method:"SitesManager.getSitesWithAdminAccess",filter_limit:-1}).then(e=>{const t=e.map(e=>e.idsite);return h["AjaxHelper"].post({method:"UsersManager.setUserAccess"},{userLogin:this.userLogin,access:this.allWebsitesAccssLevelSet,idSites:t})}).then(()=>this.fetchAccess()).finally(()=>{this.isGivingAccessToAllSites=!1})},showChangeAccessAllSitesModal(){_e(this.$refs.confirmGiveAccessAllSitesModal).modal({dismissible:!1}).modal("open")},onChangeSiteFilter(e){setTimeout(()=>{const t=e.target.value;this.siteNameFilter!==t&&(this.siteNameFilter=t,this.offset=0,this.fetchAccess())})},onRoleChange(e,t){this.siteAccessToChange=e,this.roleToChangeTo=t.value,this.accessChangeEvent=t,this.showChangeAccessConfirm()}},computed:{rolesHelpText(){return Object(h["translate"])("UsersManager_RolesHelp",Object(h["externalLink"])("https://matomo.org/faq/general/faq_70/"),"</a>",Object(h["externalLink"])("https://matomo.org/faq/general/faq_69/"),"</a>")},theDisplayedWebsitesAreSelectedText(){const e=Object(h["translate"])("UsersManager_TheDisplayedWebsitesAreSelected",`<strong>${this.siteAccess.length}</strong>`);return e+" "},clickToSelectAllText(){return Object(h["translate"])("UsersManager_ClickToSelectAll",`<strong>${this.totalEntries}</strong>`)},allWebsitesAreSelectedText(){return Object(h["translate"])("UsersManager_AllWebsitesAreSelected",`<strong>${this.totalEntries}</strong>`)},clickToSelectDisplayedWebsitesText(){return Object(h["translate"])("UsersManager_ClickToSelectDisplayedWebsites",`<strong>${this.siteAccess.length}</strong>`)},deletePermConfirmSingleText(){return Object(h["translate"])("UsersManager_DeletePermConfirmSingle",`<strong>${this.userLogin}</strong>`,`<strong>${this.siteAccessToChangeName}</strong>`)},deletePermConfirmMultipleText(){return Object(h["translate"])("UsersManager_DeletePermConfirmMultiple",`<strong>${this.userLogin}</strong>`,`<strong>${this.affectedSitesCount}</strong>`)},changePermToSiteConfirmSingleText(){return Object(h["translate"])("UsersManager_ChangePermToSiteConfirmSingle",`<strong>${this.userLogin}</strong>`,`<strong>${this.siteAccessToChangeName}</strong>`,`<strong>${this.getRoleDisplay(this.roleToChangeTo)}</strong>`)},changePermToSiteConfirmMultipleText(){return Object(h["translate"])("UsersManager_ChangePermToSiteConfirmMultiple",`<strong>${this.userLogin}</strong>`,`<strong>${this.affectedSitesCount}</strong>`,`<strong>${this.getRoleDisplay(this.roleToChangeTo)}</strong>`)},changePermToAllSitesConfirmText(){return Object(h["translate"])("UsersManager_ChangePermToAllSitesConfirm",`<strong>${this.userLogin}</strong>`,`<strong>${this.getRoleDisplay(this.allWebsitesAccssLevelSet)}</strong>`)},paginationLowerBound(){return this.offset+1},paginationUpperBound(){return this.totalEntries?Math.min(this.offset+this.limit,this.totalEntries):"?"},filteredAccessLevels(){return this.accessLevels.filter(e=>"superuser"!==e.key&&"role"===e.type)},filteredSelectAccessLevels(){return this.filterAccessLevels.filter(e=>"superuser"!==e.key)},selectedRowsCount(){let e=0;return Object.values(this.selectedRows).forEach(t=>{t&&(e+=1)}),e},affectedSitesCount(){return this.areAllResultsSelected?this.totalEntries:this.selectedRowsCount},allPropsWatch(){return this.userLogin,this.limit,this.accessLevels,this.filterAccessLevels,Date.now()},siteAccessToChangeName(){return this.siteAccessToChange?h["Matomo"].helper.htmlEntities(this.siteAccessToChange.site_name):""},paginationText(){const e=Object(h["translate"])("General_Pagination",""+this.paginationLowerBound,""+this.paginationUpperBound,""+this.totalEntries);return` ${e} `}}});xe.render=Be;var De=xe;const Le={class:"row"},Re={class:"col m2 entityList"},Pe={class:"listCircle"},He={key:0,class:"icon-warning"},Ie=Object(a["createElementVNode"])("div",{class:"save-button-spacer hide-on-small-only"},null,-1),Fe={href:"",class:"entityCancelLink"},$e=Object(a["createElementVNode"])("span",{class:"icon-arrow-left"},"  ",-1),qe={class:"visibleTab col m10"},ze={key:0,class:"basic-info-tab"},Ge={class:"email-input"},We={class:"form-group row",style:{position:"relative"}},Ye={class:"col s12 m6 save-button"},Xe={key:0,class:"resend-notes"},Ke=["innerHTML"],Je={class:"user-permissions"},Qe={key:0},Ze={key:1,class:"alert alert-info"},et={key:1,class:"superuser-access form-group"},tt={key:0},st={key:1},nt={class:"browser-default"},rt=["innerHTML"],at=["innerHTML"],it=["innerHTML"],ot=["innerHTML"],lt=["innerHTML"],ct=["innerHTML"],dt=["innerHTML"],ut=["innerHTML"],mt=["title"],bt={key:0},pt={key:1},ht={key:2,class:"twofa-reset form-group"},gt={class:"resetTwoFa"},Ot=["innerHTML"],jt=["innerHTML"];function ft(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Field"),l=Object(a["resolveComponent"])("SaveButton"),c=Object(a["resolveComponent"])("UserPermissionsEdit"),d=Object(a["resolveComponent"])("PasswordConfirmation"),u=Object(a["resolveComponent"])("Notification"),m=Object(a["resolveComponent"])("ContentBlock"),b=Object(a["resolveDirective"])("auto-clear-password"),p=Object(a["resolveDirective"])("form");return Object(a["openBlock"])(),Object(a["createBlock"])(m,{class:Object(a["normalizeClass"])(["userEditForm",{loading:e.isSavingUserInfo}]),"content-title":e.theUser.login},{default:Object(a["withCtx"])(()=>[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Le,[Object(a["createElementVNode"])("div",Re,[Object(a["createElementVNode"])("ul",Pe,[Object(a["createElementVNode"])("li",{class:Object(a["normalizeClass"])([{active:"basic"===e.activeTab},"menuBasicInfo"])},[Object(a["createElementVNode"])("a",{href:"",onClick:t[0]||(t[0]=Object(a["withModifiers"])(t=>e.activeTab="basic",["prevent"]))},Object(a["toDisplayString"])(e.translate("UsersManager_BasicInformation")),1)],2),Object(a["createElementVNode"])("li",{class:Object(a["normalizeClass"])([{active:"permissions"===e.activeTab},"menuPermissions"])},[Object(a["createElementVNode"])("a",{href:"",onClick:t[1]||(t[1]=Object(a["withModifiers"])(t=>e.activeTab="permissions",["prevent"])),style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("UsersManager_Permissions")),1),e.userHasAccess||e.theUser.superuser_access?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",He))],2),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:0,class:Object(a["normalizeClass"])([{active:"superuser"===e.activeTab},"menuSuperuser"])},[Object(a["createElementVNode"])("a",{href:"",onClick:t[2]||(t[2]=Object(a["withModifiers"])(t=>e.activeTab="superuser",["prevent"]))},Object(a["toDisplayString"])(e.translate("UsersManager_SuperUserAccess")),1)],2)):Object(a["createCommentVNode"])("",!0),"superuser"===e.currentUserRole&&e.theUser.uses_2fa?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:1,class:Object(a["normalizeClass"])([{active:"2fa"===e.activeTab},"menuUserTwoFa"])},[Object(a["createElementVNode"])("a",{href:"",onClick:t[3]||(t[3]=Object(a["withModifiers"])(t=>e.activeTab="2fa",["prevent"]))},Object(a["toDisplayString"])(e.translate("UsersManager_TwoFactorAuthentication")),1)],2)):Object(a["createCommentVNode"])("",!0)]),Ie,Object(a["createElementVNode"])("div",{class:"entityCancel",onClick:t[4]||(t[4]=Object(a["withModifiers"])(t=>e.onDoneEditing(),["prevent"]))},[Object(a["createElementVNode"])("a",Fe,[$e,Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_BackToUser")),1)])])]),Object(a["createElementVNode"])("div",qe,["basic"===e.activeTab?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",ze,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{modelValue:e.theUser.login,"onUpdate:modelValue":t[5]||(t[5]=t=>e.theUser.login=t),disabled:!0,autocomplete:"off",uicontrol:"text",name:"user_login",maxlength:100,title:e.translate("General_Username")},null,8,["modelValue","title"])]),Object(a["createElementVNode"])("div",null,[e.isPending?Object(a["createCommentVNode"])("",!0):Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createBlock"])(o,{key:0,"model-value":e.theUser.password,disabled:e.isSavingUserInfo||"superuser"!==e.currentUserRole||e.isShowingPasswordConfirm,"onUpdate:modelValue":t[6]||(t[6]=t=>{e.theUser.password=t,e.isPasswordModified=!0}),uicontrol:"password",name:"user_password",autocomplete:"new-password",title:e.translate("General_Password"),"ui-control-attributes":{passwordStrengthValidationRules:e.passwordStrengthValidationRules}},null,8,["model-value","disabled","title","ui-control-attributes"])),[[b]])]),Object(a["createElementVNode"])("div",Ge,["superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createBlock"])(o,{key:0,modelValue:e.theUser.email,"onUpdate:modelValue":t[7]||(t[7]=t=>e.theUser.email=t),disabled:e.isSavingUserInfo||"superuser"!==e.currentUserRole||e.isShowingPasswordConfirm,uicontrol:"text",name:"user_email",autocomplete:"off",maxlength:100,title:e.translate("UsersManager_Email")},null,8,["modelValue","disabled","title"])):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("div",We,[Object(a["createElementVNode"])("div",Ye,["superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:0,value:e.translate("UsersManager_SaveBasicInfo"),saving:e.isSavingUserInfo,onConfirm:t[8]||(t[8]=e=>this.isShowingPasswordConfirm=!0)},null,8,["value","saving"])):Object(a["createCommentVNode"])("",!0)])]),e.user&&e.isPending?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",Xe,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_InvitationSent"))+" ",1),Object(a["createElementVNode"])("span",{class:"resend-link",onClick:t[9]||(t[9]=(...t)=>e.resendRequestedUser&&e.resendRequestedUser(...t)),innerHTML:e.$sanitize(e.translate("UsersManager_ResendInvite")+"/"+e.translate("UsersManager_CopyLink"))},null,8,Ke)])):Object(a["createCommentVNode"])("",!0)])])):Object(a["createCommentVNode"])("",!0),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",Je,[e.theUser.superuser_access?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Qe,[Object(a["createVNode"])(c,{"user-login":e.theUser.login,onUserHasAccessDetected:t[10]||(t[10]=t=>e.userHasAccess=t.hasAccess),onAccessChanged:t[11]||(t[11]=t=>e.isUserModified=!0),"access-levels":e.accessLevels,"filter-access-levels":e.filterAccessLevels},null,8,["user-login","access-levels","filter-access-levels"])])),e.theUser.superuser_access?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Ze,Object(a["toDisplayString"])(e.translate("UsersManager_SuperUsersPermissionsNotice")),1)):Object(a["createCommentVNode"])("",!0)],512),[[a["vShow"],"permissions"===e.activeTab]]),"superuser"===e.activeTab&&"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",et,[e.isMarketplacePluginEnabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",tt,Object(a["toDisplayString"])(e.translate("UsersManager_SuperUserIntro1")),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",st,Object(a["toDisplayString"])(e.translate("UsersManager_SuperUserIntro1WithoutMarketplace")),1)),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("UsersManager_SuperUserIntro2")),1)]),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("UsersManager_SuperUserIntro3")),1)]),Object(a["createElementVNode"])("ul",nt,[Object(a["createElementVNode"])("li",{innerHTML:e.$sanitize(e.translateSuperUserRiskString("Data"))},null,8,rt),Object(a["createElementVNode"])("li",{innerHTML:e.$sanitize(e.translateSuperUserRiskString("Security"))},null,8,at),Object(a["createElementVNode"])("li",{innerHTML:e.$sanitize(e.translateSuperUserRiskString("Misconfiguration"))},null,8,it),Object(a["createElementVNode"])("li",{innerHTML:e.$sanitize(e.translateSuperUserRiskString("UserManagement"))},null,8,ot),Object(a["createElementVNode"])("li",{innerHTML:e.$sanitize(e.translateSuperUserRiskString("ServiceDisruption"))},null,8,lt),e.isPluginsAdminEnabled&&e.isMarketplacePluginEnabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:0,innerHTML:e.$sanitize(e.translateSuperUserRiskString("Marketplace"))},null,8,ct)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("li",{innerHTML:e.$sanitize(e.accountabilityRisk)},null,8,dt),Object(a["createElementVNode"])("li",{innerHTML:e.$sanitize(e.translateSuperUserRiskString("Compliance"))},null,8,ut)]),Object(a["createElementVNode"])("div",{class:Object(a["normalizeClass"])({disabled:e.isCurrentUser}),title:e.superUserAccessTooltipText},[Object(a["createVNode"])(o,{modelValue:e.superUserAccessChecked,"onUpdate:modelValue":[t[12]||(t[12]=t=>e.superUserAccessChecked=t),t[13]||(t[13]=t=>e.confirmSuperUserChange())],disabled:e.isCurrentUser,uicontrol:"checkbox",name:"superuser_access",title:e.translate("UsersManager_HasSuperUserAccess")},null,8,["modelValue","disabled","title"])],10,mt),Object(a["createVNode"])(d,{modelValue:e.showPasswordConfirmationForSuperUser,"onUpdate:modelValue":t[14]||(t[14]=t=>e.showPasswordConfirmationForSuperUser=t),onConfirmed:e.toggleSuperuserAccess,onAborted:t[15]||(t[15]=t=>e.setSuperUserAccessChecked())},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("UsersManager_AreYouSure")),1),e.theUser.superuser_access?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",bt,Object(a["toDisplayString"])(e.translate("UsersManager_RemoveSuperuserAccessConfirm")),1)):Object(a["createCommentVNode"])("",!0),e.theUser.superuser_access?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",pt,Object(a["toDisplayString"])(e.translate("UsersManager_AddSuperuserAccessConfirm")),1))]),_:1},8,["modelValue","onConfirmed"])])):Object(a["createCommentVNode"])("",!0),"superuser"===e.currentUserRole?Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",ht,[Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("UsersManager_ResetTwoFactorAuthenticationInfo")),1),Object(a["createElementVNode"])("div",gt,[Object(a["createVNode"])(l,{saving:e.isResetting2FA,onConfirm:t[16]||(t[16]=t=>e.confirmReset2FA()),value:e.translate("UsersManager_ResetTwoFactorAuthentication")},null,8,["saving","value"])]),Object(a["createVNode"])(d,{modelValue:e.showPasswordConfirmationFor2FA,"onUpdate:modelValue":t[17]||(t[17]=t=>e.showPasswordConfirmationFor2FA=t),onConfirmed:e.reset2FA},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])(e.translate("UsersManager_AreYouSure")),1)]),_:1},8,["modelValue","onConfirmed"])],512)),[[a["vShow"],"2fa"===e.activeTab]]):Object(a["createCommentVNode"])("",!0)])])),[[p]]),Object(a["createVNode"])(d,{modelValue:e.isShowingPasswordConfirm,"onUpdate:modelValue":t[18]||(t[18]=t=>e.isShowingPasswordConfirm=t),onConfirmed:e.updateUser},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("h2",{innerHTML:e.$sanitize(e.changePasswordTitle)},null,8,Ot),e.user&&e.isPending?(Object(a["openBlock"])(),Object(a["createBlock"])(u,{key:0,context:"info",noclear:!0},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("strong",{innerHTML:e.$sanitize(e.translate("UsersManager_InviteEmailChange"))},null,8,jt)]),_:1})):Object(a["createCommentVNode"])("",!0)]),_:1},8,["modelValue","onConfirmed"])]),_:1},8,["class","content-title"])}const vt={login:"",superuser_access:!1,uses_2fa:!1,password:"",email:"",invite_status:""};var Ct=Object(a["defineComponent"])({props:{user:Object,currentUserRole:{type:String,required:!0},accessLevels:{type:Array,required:!0},filterAccessLevels:{type:Array,required:!0},activatedPlugins:{type:Array,required:!0},passwordStrengthValidationRules:{type:Array,default:()=>[]}},components:{Notification:h["Notification"],ContentBlock:h["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"],UserPermissionsEdit:De,PasswordConfirmation:g["PasswordConfirmation"]},directives:{Form:g["Form"],AutoClearPassword:h["AutoClearPassword"]},data(){return{theUser:this.user||Object.assign({},vt),activeTab:"basic",permissionsForIdSite:1,isSavingUserInfo:!1,userHasAccess:!0,isUserModified:!1,isPasswordModified:!1,superUserAccessChecked:null,showPasswordConfirmationForSuperUser:!1,showPasswordConfirmationFor2FA:!1,isResetting2FA:!1,isShowingPasswordConfirm:!1}},emits:["done","updated","resendInvite"],watch:{user(e){this.onUserChange(e)}},created(){this.onUserChange(Object.assign({},this.user))},methods:{onUserChange(e){this.theUser=e||Object.assign({},vt),this.theUser.password||this.resetPasswordVar(),this.setSuperUserAccessChecked()},confirmSuperUserChange(){this.showPasswordConfirmationForSuperUser=!0},confirmReset2FA(){this.showPasswordConfirmationFor2FA=!0},toggleSuperuserAccess(e){this.isSavingUserInfo=!0,h["AjaxHelper"].post({method:"UsersManager.setSuperUserAccess"},{userLogin:this.theUser.login,hasSuperUserAccess:this.theUser.superuser_access?"0":"1",passwordConfirmation:e}).then(()=>{this.theUser=Object.assign(Object.assign({},this.theUser),{},{superuser_access:!this.theUser.superuser_access})}).catch(()=>{}).finally(()=>{this.isSavingUserInfo=!1,this.setSuperUserAccessChecked()})},resendRequestedUser(){this.$emit("resendInvite",{user:this.user})},resetPasswordVar(){this.theUser.password="XXXXXXXX"},showUserSavedNotification(){h["NotificationsStore"].show({message:Object(h["translate"])("General_YourChangesHaveBeenSaved"),context:"success",type:"toast"})},reset2FA(e){return this.isResetting2FA=!0,h["AjaxHelper"].post({method:"TwoFactorAuth.resetTwoFactorAuth"},{userLogin:this.theUser.login,passwordConfirmation:e}).catch(e=>{throw this.isResetting2FA=!1,e}).then(()=>{this.isResetting2FA=!1,this.theUser.uses_2fa=!1,this.activeTab="basic",this.showUserSavedNotification()})},updateUser(e){return this.isSavingUserInfo=!0,h["AjaxHelper"].post({method:"UsersManager.updateUser"},{userLogin:this.theUser.login,password:this.isPasswordModified&&this.theUser.password?this.theUser.password:void 0,passwordConfirmation:e,email:this.theUser.email}).then(()=>{this.isSavingUserInfo=!1,this.isUserModified=!0,this.isPasswordModified=!1,this.resetPasswordVar(),this.showUserSavedNotification(),this.$emit("updated",{user:this.theUser})}).catch(()=>{this.isSavingUserInfo=!1})},setSuperUserAccessChecked(){this.superUserAccessChecked=!!this.theUser.superuser_access},onDoneEditing(){this.$emit("done",{isUserModified:this.isUserModified})},translateSuperUserRiskString(e){return Object(h["translate"])("UsersManager_SuperUserRisk"+e,"<strong>","</strong>")}},computed:{isPending(){return!this.user||!("pending"!==this.user.invite_status&&!Number.isInteger(this.user.invite_status))},changePasswordTitle(){return Object(h["translate"])("UsersManager_AreYouSureChangeDetails",`<strong>${this.theUser.login}</strong>`)},isPluginsAdminEnabled(){return h["Matomo"].config.enable_plugins_admin},isActivityLogPluginEnabled(){return this.activatedPlugins.includes("ActivityLog")},isMarketplacePluginEnabled(){return this.activatedPlugins.includes("Marketplace")},isProfessionalServicesPluginEnabled(){return this.activatedPlugins.includes("ProfessionalServices")},accountabilityRisk(){const e=this.translateSuperUserRiskString("Accountability");let t="";return this.isPluginsAdminEnabled&&this.isProfessionalServicesPluginEnabled&&(this.isActivityLogPluginEnabled?t=Object(h["translate"])("UsersManager_SuperUserRiskAccountabilityCheckActivityLog",'<a href="?module=ActivityLog&action=index" rel="noreferrer noopener" target="_blank">',"</a>"):this.isMarketplacePluginEnabled&&(t=Object(h["translate"])("UsersManager_SuperUserRiskAccountabilityGetActivityLogPlugin",Object(h["externalLink"])("https://plugins.matomo.org/ActivityLog"),"</a>"))),t?`${e} ${t}`:e},isCurrentUser(){return this.theUser.login===h["Matomo"].userLogin},superUserAccessTooltipText(){return this.isCurrentUser?Object(h["translate"])("UsersManager_CannotRevokeOwnSuperuserAccess"):""}}});Ct.render=ft;var kt=Ct;const yt={class:"row"},St={class:"col s12 m6 invite-notes"},Nt={class:"form-help"},Ut=["innerHTML"],Vt={class:"col m10"},Et={class:"email-input"},wt={class:"form-group row",style:{position:"relative"}},Tt={class:"col s12 m6 save-button"},At={class:"entityCancel"},Mt=Object(a["createElementVNode"])("span",{class:"icon icon-arrow-left"},"  ",-1);function Bt(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Field"),l=Object(a["resolveComponent"])("SaveButton"),c=Object(a["resolveComponent"])("PasswordConfirmation"),d=Object(a["resolveComponent"])("ContentBlock"),u=Object(a["resolveDirective"])("form");return Object(a["openBlock"])(),Object(a["createBlock"])(d,{class:"userInviteForm","content-title":e.translate("UsersManager_InviteNewUser")},{default:Object(a["withCtx"])(()=>[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",yt,[Object(a["createElementVNode"])("div",St,[Object(a["createElementVNode"])("div",Nt,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("UsersManager_InviteSuccessNotification",[e.inviteTokenExpiryDays]))},null,8,Ut)])]),Object(a["createElementVNode"])("div",Vt,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{modelValue:e.theUser.login,"onUpdate:modelValue":t[0]||(t[0]=t=>e.theUser.login=t),disabled:e.isInvitingUser,autocomplete:"off",uicontrol:"text",name:"user_login",maxlength:100,title:e.translate("General_Username")},null,8,["modelValue","disabled","title"])]),Object(a["createElementVNode"])("div",Et,[Object(a["createVNode"])(o,{modelValue:e.theUser.email,"onUpdate:modelValue":t[1]||(t[1]=t=>e.theUser.email=t),disabled:e.isInvitingUser,uicontrol:"text",name:"user_email",autocomplete:"off",maxlength:100,title:e.translate("UsersManager_Email")},null,8,["modelValue","disabled","title"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{modelValue:e.firstSiteAccess,"onUpdate:modelValue":t[2]||(t[2]=t=>e.firstSiteAccess=t),disabled:e.isInvitingUser,uicontrol:"site",name:"user_site","ui-control-attributes":{onlySitesWithAdminAccess:!0},title:e.translate("UsersManager_FirstWebsitePermission"),"inline-help":e.translate("UsersManager_FirstSiteInlineHelp")},null,8,["modelValue","disabled","title","inline-help"])]),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("div",wt,[Object(a["createElementVNode"])("div",Tt,[Object(a["createVNode"])(l,{value:e.translate("UsersManager_InviteUser"),disabled:!e.firstSiteAccess||!e.firstSiteAccess.id||!e.theUser.login||!e.theUser.email,saving:e.isInvitingUser,onConfirm:t[3]||(t[3]=t=>e.showPasswordConfirmation=!0)},null,8,["value","disabled","saving"])])]),Object(a["createVNode"])(c,{modelValue:e.showPasswordConfirmation,"onUpdate:modelValue":t[4]||(t[4]=t=>e.showPasswordConfirmation=t),onConfirmed:e.inviteUser},null,8,["modelValue","onConfirmed"])]),Object(a["createElementVNode"])("div",At,[Object(a["createElementVNode"])("a",{href:"",class:"entityCancelLink",onClick:t[5]||(t[5]=Object(a["withModifiers"])(t=>e.abort(),["prevent"]))},[Mt,Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_BackToUser")),1)])])])])),[[u]])]),_:1},8,["content-title"])}const _t={login:"",superuser_access:!1,uses_2fa:!1,password:"",email:"",invite_status:""};var xt=Object(a["defineComponent"])({props:{initialSiteId:{type:[String,Number],required:!0},initialSiteName:{type:String,required:!0},inviteTokenExpiryDays:{type:String,required:!0}},components:{ContentBlock:h["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"],PasswordConfirmation:g["PasswordConfirmation"]},directives:{Form:g["Form"],AutoClearPassword:h["AutoClearPassword"]},data(){return{theUser:Object.assign({},_t),isInvitingUser:!1,firstSiteAccess:{id:this.initialSiteId,name:this.initialSiteName},showPasswordConfirmation:!1}},emits:["aborted","invited"],methods:{inviteUser(e){return this.isInvitingUser=!0,h["AjaxHelper"].post({method:"UsersManager.inviteUser"},{userLogin:this.theUser.login,email:this.theUser.email,initialIdSite:this.firstSiteAccess?this.firstSiteAccess.id:void 0,passwordConfirmation:e}).then(()=>{this.firstSiteAccess={id:this.initialSiteId,name:this.initialSiteName},this.theUser.invite_status="pending",this.showUserInvitedNotification(),this.$emit("invited",{user:this.theUser}),this.theUser=_t}).finally(()=>{this.isInvitingUser=!1})},showUserInvitedNotification(){h["NotificationsStore"].show({message:Object(h["translate"])("UsersManager_InviteSuccess"),context:"success",type:"toast"})},abort(){this.theUser=_t,this.firstSiteAccess=null,this.$emit("aborted")}}});xt.render=Bt;var Dt=xt;const Lt={class:"resend-invite-confirm-modal modal",ref:"resendInviteConfirmModal"},Rt=Object(a["createElementVNode"])("div",{class:"btn-close modal-close"},[Object(a["createElementVNode"])("i",{class:"icon-close"})],-1),Pt={class:"modal-content"},Ht={class:"modal-title"},It=["innerHTML"],Ft={class:"modal-footer"},$t={key:0,class:"success-copied"},qt=Object(a["createElementVNode"])("i",{class:"icon-success"},null,-1);function zt(e,t,s,n,r,i){var o,l;const c=Object(a["resolveComponent"])("PasswordConfirmation");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(c,{modelValue:e.showPasswordConfirmationForInviteAction,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showPasswordConfirmationForInviteAction=t),onConfirmed:e.onInviteAction},null,8,["modelValue","onConfirmed"]),Object(a["createElementVNode"])("div",Lt,[Rt,Object(a["createElementVNode"])("div",Pt,[Object(a["createElementVNode"])("h2",Ht,Object(a["toDisplayString"])(e.translate("UsersManager_ResendInvite")),1),Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.translate("UsersManager_InviteConfirmMessage",[`<strong>${null===(o=e.user)||void 0===o?void 0:o.login}</strong>`,`<strong>${null===(l=e.user)||void 0===l?void 0:l.email}</strong>`]))},null,8,It),Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("UsersManager_InviteActionNotes",e.inviteTokenExpiryDays)),1)])]),Object(a["createElementVNode"])("div",Ft,[e.copied?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",$t,[qt,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("UsersManager_LinkCopied")),1)])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("button",{onClick:t[1]||(t[1]=t=>e.showInviteActionPasswordConfirm("copy")),class:"btn btn-copy-link modal-action",style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("UsersManager_CopyLink")),1),Object(a["createElementVNode"])("button",{class:"btn btn-resend modal-action modal-no",onClick:t[2]||(t[2]=t=>e.showInviteActionPasswordConfirm("send"))},Object(a["toDisplayString"])(e.translate("UsersManager_ResendInvite")),1)])],512)],64)}var Gt=Object(a["defineComponent"])({props:{user:{type:Object,required:!1},inviteTokenExpiryDays:{type:String,required:!0}},components:{PasswordConfirmation:g["PasswordConfirmation"]},data(){return{copied:!1,showPasswordConfirmationForInviteAction:!1,inviteAction:"",loading:!1}},emits:["close"],watch:{user(e){e&&($(this.$refs.resendInviteConfirmModal).modal({dismissible:!1,onCloseEnd:()=>this.$emit("close")}).modal("open"),this.copied=!1)}},methods:{showInviteActionPasswordConfirm(e){this.loading||(this.showPasswordConfirmationForInviteAction=!0,this.inviteAction=e)},onInviteAction(e){"send"===this.inviteAction?this.onResendInvite(e):this.generateInviteLink(e)},onResendInvite(e){""!==e&&h["AjaxHelper"].post({method:"UsersManager.resendInvite",userLogin:this.user.login},{passwordConfirmation:e}).then(()=>{$(this.$refs.resendInviteConfirmModal).modal("close");const e=h["NotificationsStore"].show({message:Object(h["translate"])("UsersManager_InviteSuccess"),id:"resendInvite",context:"success",type:"transient"});h["NotificationsStore"].scrollToNotification(e)})},async generateInviteLink(e){if(!this.loading){this.loading=!0;try{const t=await h["AjaxHelper"].post({method:"UsersManager.generateInviteLink"},{userLogin:this.user.login,passwordConfirmation:e});await this.copyToClipboard(t.value)}catch(t){}this.loading=!1}},async copyToClipboard(e){try{const t=document.createElement("input");t.style.top="-100px",t.style.left="0",t.style.position="fixed",t.value=e,document.body.appendChild(t),t.select(),"https:"!==window.location.protocol?document.execCommand("copy"):await navigator.clipboard.writeText(t.value),document.body.removeChild(t),this.copied=!0}catch(t){const s=h["NotificationsStore"].show({message:`<strong>${Object(h["translate"])("UsersManager_CopyDenied")}</strong><br>\n${Object(h["translate"])("UsersManager_CopyDeniedHints",[`<br><span class="invite-link">${e}</span>`])}`,id:"copyError",context:"error",type:"transient"});h["NotificationsStore"].scrollToNotification(s)}}}});Gt.render=zt;var Wt=Gt;const Yt={class:"userListFilters row"},Xt={class:"col s12 m12 l8"},Kt={class:"input-field col s12 m3 l3"},Jt={id:"user-list-bulk-actions",class:"dropdown-content"},Qt={class:"dropdown-trigger","data-target":"bulk-set-access"},Zt={id:"bulk-set-access",class:"dropdown-content"},es=["onClick"],ts={key:0},ss={class:"input-field col s12 m3 l3"},ns={class:"permissions-for-selector"},rs={class:"input-field col s12 m3 l3"},as={class:"input-field col s12 m3 l3"},is={key:0,class:"input-field col s12 m12 l4 users-list-pagination-container"},os={class:"usersListPagination"},ls={class:"pointer"},cs={class:"counter"},ds={class:"pointer"},us={key:0,class:"roles-help-notification"},ms=["innerHTML"],bs={class:"select-cell"},ps={class:"checkbox-container"},hs=Object(a["createElementVNode"])("span",null,null,-1),gs={class:"first"},Os={class:"role_header"},js={style:{"margin-right":"3.5px"}},fs=Object(a["createElementVNode"])("span",{class:"icon-help"},null,-1),vs=[fs],Cs={key:0},ks=["title"],ys={key:2},Ss={class:"actions-cell-header"},Ns={key:0,class:"select-all-row"},Us={colspan:"8"},Vs={key:0},Es=["innerHTML"],ws=["innerHTML"],Ts={key:1},As=["innerHTML"],Ms=["innerHTML"],Bs=["id"],_s={class:"select-cell"},xs={class:"checkbox-container"},Ds=["id","onUpdate:modelValue"],Ls=Object(a["createElementVNode"])("span",null,null,-1),Rs={id:"userLogin"},Ps={class:"access-cell"},Hs={key:0,id:"email"},Is={key:1,id:"twofa"},Fs={key:0,class:"icon-ok"},$s={key:1,class:"icon-close"},qs={key:2,id:"last_seen"},zs={id:"status"},Gs=["title"],Ws={class:"center actions-cell"},Ys=["onClick"],Xs=Object(a["createElementVNode"])("span",{class:"icon-email"},null,-1),Ks=[Xs],Js=["onClick"],Qs=Object(a["createElementVNode"])("span",{class:"icon-edit"},null,-1),Zs=[Qs],en=["onClick"],tn=Object(a["createElementVNode"])("span",{class:"icon-delete"},null,-1),sn=[tn],nn=["innerHTML"],rn=["innerHTML"],an=["innerHTML"],on=["innerHTML"],ln=["innerHTML"],cn={class:"change-user-role-confirm-modal modal",ref:"changeUserRoleConfirmModal"},dn={class:"modal-content"},un=["innerHTML"],mn=["innerHTML"],bn={class:"modal-footer"};function pn(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Field"),l=Object(a["resolveComponent"])("ActivityIndicator"),c=Object(a["resolveComponent"])("Notification"),d=Object(a["resolveComponent"])("ContentBlock"),u=Object(a["resolveComponent"])("PasswordConfirmation"),m=Object(a["resolveDirective"])("dropdown-menu"),b=Object(a["resolveDirective"])("content-table");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])(["pagedUsersList",{loading:e.isLoadingUsers}])},[Object(a["createElementVNode"])("div",Yt,[Object(a["createElementVNode"])("div",Xt,[Object(a["createElementVNode"])("div",Kt,[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("a",{class:Object(a["normalizeClass"])(["dropdown-trigger btn bulk-actions",{disabled:e.isBulkActionsDisabled}]),href:"","data-target":"user-list-bulk-actions"},[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_BulkActions")),1)],2)),[[m]]),Object(a["createElementVNode"])("ul",Jt,[Object(a["createElementVNode"])("li",null,[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("a",Qt,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_SetPermission")),1)])),[[m]]),Object(a["createElementVNode"])("ul",Zt,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.bulkActionAccessLevels,t=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:t.key},[Object(a["createElementVNode"])("a",{href:"",onClick:Object(a["withModifiers"])(s=>{e.userToChange=null,e.roleToChangeTo=t.key,e.showAccessChangeConfirm()},["prevent"])},Object(a["toDisplayString"])(t.value),9,es)]))),128))])]),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("a",{href:"",onClick:t[0]||(t[0]=Object(a["withModifiers"])(t=>{e.userToChange=null,e.roleToChangeTo="noaccess",e.showAccessChangeConfirm()},["prevent"]))},Object(a["toDisplayString"])(e.translate("UsersManager_RemovePermissions")),1)]),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",ts,[Object(a["createElementVNode"])("a",{href:"",onClick:t[1]||(t[1]=Object(a["withModifiers"])(t=>e.showDeleteConfirm(),["prevent"]))},Object(a["toDisplayString"])(e.translate("UsersManager_DeleteUsers")),1)])):Object(a["createCommentVNode"])("",!0)])]),Object(a["createElementVNode"])("div",ss,[Object(a["createElementVNode"])("div",ns,[Object(a["createVNode"])(o,{"model-value":e.userTextFilter,"onUpdate:modelValue":t[2]||(t[2]=t=>e.onUserTextFilterChange(t)),name:"user-text-filter",uicontrol:"text","full-width":!0,placeholder:e.translate("UsersManager_UserSearch")},null,8,["model-value","placeholder"])])]),Object(a["createElementVNode"])("div",rs,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{"model-value":e.accessLevelFilter,"onUpdate:modelValue":t[3]||(t[3]=t=>{e.accessLevelFilter=t,e.changeSearch({filter_access:e.accessLevelFilter,offset:0})}),name:"access-level-filter",uicontrol:"select",options:e.filterAccessLevels,"full-width":!0,placeholder:e.translate("UsersManager_FilterByAccess")},null,8,["model-value","options","placeholder"])])]),Object(a["createElementVNode"])("div",as,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{"model-value":e.statusLevelFilter,"onUpdate:modelValue":t[4]||(t[4]=t=>{e.statusLevelFilter=t,e.changeSearch({filter_status:e.statusLevelFilter,offset:0})}),name:"status-level-filter",uicontrol:"select",options:e.filterStatusLevels,"full-width":!0,placeholder:e.translate("UsersManager_FilterByStatus")},null,8,["model-value","options","placeholder"])])])]),e.totalEntries>e.searchParams.limit?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",is,[Object(a["createElementVNode"])("div",os,[Object(a["createElementVNode"])("a",{class:Object(a["normalizeClass"])(["btn prev",{disabled:e.searchParams.offset<=0}]),onClick:t[5]||(t[5]=Object(a["withModifiers"])(t=>e.gotoPreviousPage(),["prevent"]))},[Object(a["createElementVNode"])("span",ls,"« "+Object(a["toDisplayString"])(e.translate("General_Previous")),1)],2),Object(a["createElementVNode"])("div",cs,[Object(a["createElementVNode"])("span",{class:Object(a["normalizeClass"])({visibility:e.isLoadingUsers?"hidden":"visible"})},Object(a["toDisplayString"])(e.translate("General_Pagination",e.paginationLowerBound,e.paginationUpperBound,e.totalEntries)),3),Object(a["createVNode"])(l,{loading:e.isLoadingUsers},null,8,["loading"])]),Object(a["createElementVNode"])("a",{class:Object(a["normalizeClass"])(["btn next",{disabled:e.searchParams.offset+e.searchParams.limit>=e.totalEntries}]),onClick:t[6]||(t[6]=Object(a["withModifiers"])(t=>e.gotoNextPage(),["prevent"]))},[Object(a["createElementVNode"])("span",ds,Object(a["toDisplayString"])(e.translate("General_Next"))+" »",1)],2)])])):Object(a["createCommentVNode"])("",!0)]),e.isRoleHelpToggled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",us,[Object(a["createVNode"])(c,{context:"info",type:"persistent",noclear:!0},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.rolesHelpText)},null,8,ms)]),_:1})])):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(d,null,{default:Object(a["withCtx"])(()=>[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("table",{id:"manageUsersTable",class:Object(a["normalizeClass"])({loading:e.isLoadingUsers})},[Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",bs,[Object(a["createElementVNode"])("span",ps,[Object(a["createElementVNode"])("label",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"checkbox",id:"paged_users_select_all",checked:"checked","onUpdate:modelValue":t[7]||(t[7]=t=>e.isAllCheckboxSelected=t),onChange:t[8]||(t[8]=t=>e.onAllCheckboxChange())},null,544),[[a["vModelCheckbox"],e.isAllCheckboxSelected]]),hs])])]),Object(a["createElementVNode"])("th",gs,Object(a["toDisplayString"])(e.translate("UsersManager_Username")),1),Object(a["createElementVNode"])("th",Os,[Object(a["createElementVNode"])("span",js,Object(a["toDisplayString"])(e.translate("UsersManager_RoleFor")),1),Object(a["createElementVNode"])("a",{href:"",class:Object(a["normalizeClass"])(["helpIcon",{sticky:e.isRoleHelpToggled}]),onClick:t[9]||(t[9]=Object(a["withModifiers"])(t=>e.isRoleHelpToggled=!e.isRoleHelpToggled,["prevent"]))},vs,2),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{class:"permissions-for-selector","model-value":e.permissionsForSite,"onUpdate:modelValue":t[10]||(t[10]=t=>{e.onPermissionsForUpdate(t)}),uicontrol:"site","ui-control-attributes":{onlySitesWithAdminAccess:"superuser"!==e.currentUserRole}},null,8,["model-value","ui-control-attributes"])])]),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("th",Cs,Object(a["toDisplayString"])(e.translate("UsersManager_Email")),1)):Object(a["createCommentVNode"])("",!0),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("th",{key:1,title:e.translate("UsersManager_UsesTwoFactorAuthentication")},Object(a["toDisplayString"])(e.translate("UsersManager_2FA")),9,ks)):Object(a["createCommentVNode"])("",!0),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("th",ys,Object(a["toDisplayString"])(e.translate("UsersManager_LastSeen")),1)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("UsersManager_Status")),1),Object(a["createElementVNode"])("th",Ss,[Object(a["createElementVNode"])("div",null,Object(a["toDisplayString"])(e.translate("General_Actions")),1)])])]),Object(a["createElementVNode"])("tbody",null,[e.isAllCheckboxSelected&&e.users.length&&e.users.length<e.totalEntries?(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",Ns,[Object(a["createElementVNode"])("td",Us,[e.areAllResultsSelected?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Vs,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("UsersManager_TheDisplayedUsersAreSelected",`<strong>${e.users.length}</strong>`)),style:{"margin-right":"3.5px"}},null,8,Es),Object(a["createElementVNode"])("a",{class:"toggle-select-all-in-search",href:"#",onClick:t[11]||(t[11]=Object(a["withModifiers"])(t=>e.areAllResultsSelected=!e.areAllResultsSelected,["prevent"])),innerHTML:e.$sanitize(e.translate("UsersManager_ClickToSelectAll",`<strong>${e.totalEntries}</strong>`))},null,8,ws)])),e.areAllResultsSelected?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Ts,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("UsersManager_AllUsersAreSelected",`<strong>${e.totalEntries}</strong>`)),style:{"margin-right":"3.5px"}},null,8,As),Object(a["createElementVNode"])("a",{class:"toggle-select-all-in-search",href:"#",onClick:t[12]||(t[12]=Object(a["withModifiers"])(t=>e.areAllResultsSelected=!e.areAllResultsSelected,["prevent"])),innerHTML:e.$sanitize(e.translate("UsersManager_ClickToSelectDisplayedUsers",`<strong>${e.users.length}</strong>`))},null,8,Ms)])):Object(a["createCommentVNode"])("",!0)])])):Object(a["createCommentVNode"])("",!0),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.users,(s,n)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{id:"row"+n,key:s.login},[Object(a["createElementVNode"])("td",_s,[Object(a["createElementVNode"])("span",xs,[Object(a["createElementVNode"])("label",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"checkbox",id:"paged_users_select_row"+n,"onUpdate:modelValue":t=>e.selectedRows[n]=t,onClick:t[13]||(t[13]=t=>e.onRowSelected())},null,8,Ds),[[a["vModelCheckbox"],e.selectedRows[n]]]),Ls])])]),Object(a["createElementVNode"])("td",Rs,Object(a["toDisplayString"])(s.login),1),Object(a["createElementVNode"])("td",Ps,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{"model-value":s.role,"onUpdate:modelValue":t=>{e.userToChange=s,e.roleToChangeTo=t.value,e.showAccessChangeConfirm(),t.abort()},"model-modifiers":{abortable:!0},disabled:"superuser"===s.role,uicontrol:"select",options:"anonymous"===s.login?e.anonymousAccessLevels:"noaccess"===s.role?e.onlyRoleAccessLevels:e.accessLevels},null,8,["model-value","onUpdate:modelValue","disabled","options"])])]),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("td",Hs,Object(a["toDisplayString"])(s.email),1)):Object(a["createCommentVNode"])("",!0),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("td",Is,[s.uses_2fa?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Fs)):Object(a["createCommentVNode"])("",!0),s.uses_2fa?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",$s))])):Object(a["createCommentVNode"])("",!0),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("td",qs,Object(a["toDisplayString"])(s.last_seen_ago?e.translate("UsersManager_XAgo",s.last_seen_ago):"-"),1)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("td",zs,[Object(a["createElementVNode"])("span",{class:Object(a["normalizeClass"])(Number.isInteger(s.invite_status)?"pending":s.invite_status),title:"expired"===s.invite_status?e.translate("UsersManager_ExpiredInviteAutomaticallyRemoved","3"):""},Object(a["toDisplayString"])(e.getInviteStatus(s.invite_status)),11,Gs)]),Object(a["createElementVNode"])("td",Ws,[("superuser"===e.currentUserRole||"admin"===e.currentUserRole&&s.invited_by===e.currentUserLogin)&&"active"!==s.invite_status?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:0,class:"resend table-action",title:"Resend/Copy Invite Link",onClick:t=>{e.userToChange=s,e.resendRequestedUser()}},Ks,8,Ys)):Object(a["createCommentVNode"])("",!0),"anonymous"!==s.login?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:1,class:"edituser table-action",title:"Edit",onClick:t=>e.$emit("editUser",{user:s})},Zs,8,Js)):Object(a["createCommentVNode"])("",!0),("superuser"===e.currentUserRole||"admin"===e.currentUserRole&&s.invited_by===e.currentUserLogin&&"active"!==s.invite_status)&&"anonymous"!==s.login?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:2,class:"deleteuser table-action",title:"Delete",onClick:t=>{e.userToChange=s,e.showDeleteConfirm()}},sn,8,en)):Object(a["createCommentVNode"])("",!0)])],8,Bs))),128))])],2)),[[b]])]),_:1}),Object(a["createVNode"])(u,{modelValue:e.showPasswordConfirmationForUserRemoval,"onUpdate:modelValue":t[14]||(t[14]=t=>e.showPasswordConfirmationForUserRemoval=t),onConfirmed:e.deleteRequestedUsers,onAborted:e.resetUserAndRoleToChange},{default:Object(a["withCtx"])(()=>[e.userToChange?(Object(a["openBlock"])(),Object(a["createElementBlock"])("h2",{key:0,innerHTML:e.$sanitize(e.translate("UsersManager_DeleteUserConfirmSingle",`<strong>${e.userToChange.login}</strong>`))},null,8,nn)):Object(a["createCommentVNode"])("",!0),e.userToChange?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("h2",{key:1,innerHTML:e.$sanitize(e.translate("UsersManager_DeleteUserConfirmMultiple",`<strong>${e.affectedUsersCount}</strong>`))},null,8,rn))]),_:1},8,["modelValue","onConfirmed","onAborted"]),Object(a["createVNode"])(u,{modelValue:e.showPasswordConfirmationForAnonymousAccess,"onUpdate:modelValue":t[15]||(t[15]=t=>e.showPasswordConfirmationForAnonymousAccess=t),onConfirmed:e.changeUserRole,onAborted:e.resetUserAndRoleToChange},{default:Object(a["withCtx"])(()=>[e.userToChange?(Object(a["openBlock"])(),Object(a["createElementBlock"])("h3",{key:0,innerHTML:e.$sanitize(e.deleteUserPermConfirmSingleText)},null,8,an)):Object(a["createCommentVNode"])("",!0),e.userToChange?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("h3",{key:1,innerHTML:e.$sanitize(e.deleteUserPermConfirmMultipleText)},null,8,on)),Object(a["createElementVNode"])("h3",null,[Object(a["createElementVNode"])("em",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("General_Note"))+": ",1),Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("UsersManager_AnonymousUserRoleChangeWarning","anonymous",e.getRoleDisplay(e.roleToChangeTo)))},null,8,ln)])])]),_:1},8,["modelValue","onConfirmed","onAborted"]),Object(a["createElementVNode"])("div",cn,[Object(a["createElementVNode"])("div",dn,[e.userToChange?(Object(a["openBlock"])(),Object(a["createElementBlock"])("h3",{key:0,innerHTML:e.$sanitize(e.deleteUserPermConfirmSingleText)},null,8,un)):Object(a["createCommentVNode"])("",!0),e.userToChange?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",{key:1,innerHTML:e.$sanitize(e.deleteUserPermConfirmMultipleText)},null,8,mn))]),Object(a["createElementVNode"])("div",bn,[Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close btn",onClick:t[16]||(t[16]=Object(a["withModifiers"])(t=>e.changeUserRole(),["prevent"])),style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("General_Yes")),1),Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close modal-no",onClick:t[17]||(t[17]=Object(a["withModifiers"])(t=>e.resetUserAndRoleToChange(),["prevent"]))},Object(a["toDisplayString"])(e.translate("General_No")),1)])],512)],2)}const{$:hn}=window;var gn=Object(a["defineComponent"])({props:{initialSiteId:{type:[String,Number],required:!0},initialSiteName:{type:String,required:!0},currentUserRole:String,isLoadingUsers:Boolean,accessLevels:{type:Array,required:!0},filterAccessLevels:{type:Array,required:!0},filterStatusLevels:{type:Array,required:!0},totalEntries:Number,users:{type:Array,required:!0},searchParams:{type:Object,required:!0}},components:{Field:g["Field"],ActivityIndicator:h["ActivityIndicator"],Notification:h["Notification"],ContentBlock:h["ContentBlock"],PasswordConfirmation:g["PasswordConfirmation"]},directives:{DropdownMenu:h["DropdownMenu"],ContentTable:h["ContentTable"]},data(){return{areAllResultsSelected:!1,selectedRows:{},isAllCheckboxSelected:!1,isBulkActionsDisabled:!0,userToChange:null,roleToChangeTo:null,accessLevelFilter:null,statusLevelFilter:null,isRoleHelpToggled:!1,userTextFilter:"",permissionsForSite:{id:this.initialSiteId,name:this.initialSiteName},showPasswordConfirmationForUserRemoval:!1,showPasswordConfirmationForAnonymousAccess:!1}},emits:["editUser","changeUserRole","deleteUser","searchChange","resendInvite"],created(){this.onUserTextFilterChange=Object(h["debounce"])(this.onUserTextFilterChange,300)},watch:{users(){this.clearSelection()}},methods:{getInviteStatus(e){return Number.isInteger(e)?Object(h["translate"])("UsersManager_InviteDayLeft",e):"expired"===e?Object(h["translate"])("UsersManager_Expired"):Object(h["translate"])("UsersManager_Active")},onPermissionsForUpdate(e){this.permissionsForSite=e,this.changeSearch({idSite:this.permissionsForSite.id})},clearSelection(){this.selectedRows={},this.areAllResultsSelected=!1,this.isBulkActionsDisabled=!0,this.isAllCheckboxSelected=!1,this.userToChange=null},resetUserAndRoleToChange(){this.userToChange=null,this.roleToChangeTo=null},onAllCheckboxChange(){if(this.isAllCheckboxSelected){for(let e=0;e!==this.users.length;e+=1)this.selectedRows[e]=!0;this.isBulkActionsDisabled=!1}else this.clearSelection()},changeUserRole(e){this.$emit("changeUserRole",{users:this.userOperationSubject,role:this.roleToChangeTo,password:e})},onRowSelected(){const e=this.selectedCount;this.isBulkActionsDisabled=0===e,this.isAllCheckboxSelected=e===this.users.length},deleteRequestedUsers(e){this.$emit("deleteUser",{users:this.userOperationSubject,password:e})},resendRequestedUser(){this.$emit("resendInvite",{user:this.userToChange})},showDeleteConfirm(){this.showPasswordConfirmationForUserRemoval=!0},showAccessChangeConfirm(){const e="all"===this.userOperationSubject||Array.isArray(this.userOperationSubject)&&this.userOperationSubject.filter(e=>"anonymous"===e.login).length;e&&"view"===this.roleToChangeTo?this.showPasswordConfirmationForAnonymousAccess=!0:hn(this.$refs.changeUserRoleConfirmModal).modal({dismissible:!1}).modal("open")},getRoleDisplay(e){let t=null;return this.accessLevels.forEach(s=>{s.key===e&&(t=s.value)}),t},changeSearch(e){const t=Object.assign(Object.assign({},this.searchParams),e);this.$emit("searchChange",{params:t})},gotoPreviousPage(){this.changeSearch({offset:Math.max(0,this.searchParams.offset-this.searchParams.limit)})},gotoNextPage(){const e=this.searchParams.offset+this.searchParams.limit;e>=this.totalEntries||this.changeSearch({offset:e})},onUserTextFilterChange(e){this.userTextFilter=e,this.changeSearch({filter_search:e,offset:0})}},computed:{currentUserLogin(){return h["Matomo"].userLogin},paginationLowerBound(){return this.searchParams.offset+1},paginationUpperBound(){if(null===this.totalEntries)return"?";const e=this.searchParams;return Math.min(e.offset+e.limit,this.totalEntries)},userOperationSubject(){return this.userToChange?[this.userToChange]:this.areAllResultsSelected?"all":this.selectedUsers},selectedUsers(){const e=this.users,t=[];return Object.keys(this.selectedRows).forEach(s=>{const n=parseInt(s,10);this.selectedRows[s]&&e[n]&&t.push(e[n])}),t},rolesHelpText(){return Object(h["translate"])("UsersManager_RolesHelp",Object(h["externalLink"])("https://matomo.org/faq/general/faq_70/"),"</a>",Object(h["externalLink"])("https://matomo.org/faq/general/faq_69/"),"</a>")},affectedUsersCount(){return this.areAllResultsSelected?this.totalEntries||0:this.selectedCount},selectedCount(){let e=0;return Object.keys(this.selectedRows).forEach(t=>{this.selectedRows[t]&&(e+=1)}),e},deleteUserPermConfirmSingleText(){var e,t;return Object(h["translate"])("UsersManager_DeleteUserPermConfirmSingle",`<strong>${(null===(e=this.userToChange)||void 0===e?void 0:e.login)||""}</strong>`,`<strong>${this.getRoleDisplay(this.roleToChangeTo)}</strong>`,`<strong>${h["Matomo"].helper.htmlEntities((null===(t=this.permissionsForSite)||void 0===t?void 0:t.name)||"")}</strong>`)},deleteUserPermConfirmMultipleText(){var e;return Object(h["translate"])("UsersManager_DeleteUserPermConfirmMultiple",`<strong>${this.affectedUsersCount}</strong>`,`<strong>${this.getRoleDisplay(this.roleToChangeTo)}</strong>`,`<strong>${h["Matomo"].helper.htmlEntities((null===(e=this.permissionsForSite)||void 0===e?void 0:e.name)||"")}</strong>`)},bulkActionAccessLevels(){return this.accessLevels.filter(e=>"noaccess"!==e.key&&"superuser"!==e.key)},anonymousAccessLevels(){return this.accessLevels.filter(e=>"noaccess"===e.key||"view"===e.key)},onlyRoleAccessLevels(){return this.accessLevels.filter(e=>"role"===e.type)}}});gn.render=pn;var On=gn;const jn={class:"usersManager"},fn={key:0},vn={key:1},Cn={class:"row add-user-container"},kn={class:"col s12"},yn={class:"input-field",style:{"margin-right":"3.5px"}},Sn={key:0,class:"input-field"},Nn={key:0},Un={class:"add-existing-user-modal modal",ref:"addExistingUserModal"},Vn={class:"modal-content"},En={class:"modal-footer"};function wn(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("EnrichedHeadline"),l=Object(a["resolveComponent"])("PagedUsersList"),c=Object(a["resolveComponent"])("UserEditForm"),d=Object(a["resolveComponent"])("Field"),u=Object(a["resolveDirective"])("content-intro"),m=Object(a["resolveDirective"])("tooltips");return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",jn,[Object(a["withDirectives"])(Object(a["createElementVNode"])("div",null,[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["createElementVNode"])("h2",null,[Object(a["createVNode"])(o,{"help-url":e.externalRawLink("https://matomo.org/docs/manage-users/"),"feature-name":"Users Management"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_ManageUsers")),1)]),_:1},8,["help-url"])]),"superuser"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",fn,Object(a["toDisplayString"])(e.translate("UsersManager_ManageUsersDesc")),1)):Object(a["createCommentVNode"])("",!0),"admin"===e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",vn,Object(a["toDisplayString"])(e.translate("UsersManager_ManageUsersAdminDesc")),1)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",Cn,[Object(a["createElementVNode"])("div",kn,[Object(a["createElementVNode"])("div",yn,[Object(a["createElementVNode"])("a",{class:"btn add-new-user",onClick:t[0]||(t[0]=t=>e.onAddNewUser())},Object(a["toDisplayString"])(e.translate("UsersManager_InviteNewUser")),1)]),"superuser"!==e.currentUserRole?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Sn,[Object(a["createElementVNode"])("a",{class:"btn add-existing-user",onClick:t[1]||(t[1]=t=>e.showAddExistingUserModal())},Object(a["toDisplayString"])(e.translate("UsersManager_AddExistingUser")),1)])):Object(a["createCommentVNode"])("",!0)])]),Object(a["createVNode"])(l,{onEditUser:t[2]||(t[2]=t=>e.onEditUser(t.user)),onChangeUserRole:t[3]||(t[3]=t=>e.onChangeUserRole(t.users,t.role,t.password)),onDeleteUser:t[4]||(t[4]=t=>e.onDeleteUser(t.users,t.password)),onSearchChange:t[5]||(t[5]=t=>{e.searchParams=t.params,e.fetchUsers()}),onResendInvite:t[6]||(t[6]=t=>e.triggerResendInviteForUser=t.user),"initial-site-id":e.initialSiteId,"initial-site-name":e.initialSiteName,"is-loading-users":e.isLoadingUsers,"current-user-role":e.currentUserRole,"access-levels":e.accessLevels,"filter-access-levels":e.filterAccessLevels,"filter-status-levels":e.filterStatusLevels,"search-params":e.searchParams,users:e.users,"total-entries":e.totalEntries},null,8,["initial-site-id","initial-site-name","is-loading-users","current-user-role","access-levels","filter-access-levels","filter-status-levels","search-params","users","total-entries"])])),[[u]])],512),[[a["vShow"],!e.isEditing&&!e.isInviting]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",null,[(Object(a["openBlock"])(),Object(a["createBlock"])(Object(a["resolveDynamicComponent"])(e.usedInviteComponent),{"invite-token-expiry-days":e.inviteTokenExpiryDays,"initial-site-id":e.initialSiteId,"initial-site-name":e.initialSiteName,onAborted:t[7]||(t[7]=t=>e.isInviting=!1),onInvited:t[8]||(t[8]=t=>e.onInvite(t.user))},null,40,["invite-token-expiry-days","initial-site-id","initial-site-name"]))],512),[[a["vShow"],e.isInviting]]),(Object(a["openBlock"])(),Object(a["createBlock"])(Object(a["resolveDynamicComponent"])(e.usedResendInviteComponent),{user:e.triggerResendInviteForUser,"invite-token-expiry-days":e.inviteTokenExpiryDays,onClose:t[9]||(t[9]=t=>e.triggerResendInviteForUser=null)},null,40,["user","invite-token-expiry-days"])),e.isEditing?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Nn,[Object(a["createVNode"])(c,{onDone:t[10]||(t[10]=t=>e.onDoneEditing(t.isUserModified)),user:e.userBeingEdited,"current-user-role":e.currentUserRole,"access-levels":e.accessLevels,"filter-access-levels":e.filterAccessLevels,"activated-plugins":e.activatedPlugins,"password-strength-validation-rules":e.passwordStrengthValidationRules,onResendInvite:t[11]||(t[11]=t=>e.triggerResendInviteForUser=t.user),onUpdated:t[12]||(t[12]=t=>e.userBeingEdited=t.user)},null,8,["user","current-user-role","access-levels","filter-access-levels","activated-plugins","password-strength-validation-rules"])])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",Un,[Object(a["createElementVNode"])("div",Vn,[Object(a["createElementVNode"])("h3",null,Object(a["toDisplayString"])(e.translate("UsersManager_AddExistingUser")),1),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("UsersManager_EnterUsernameOrEmail"))+":",1),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(d,{modelValue:e.addNewUserLoginEmail,"onUpdate:modelValue":t[13]||(t[13]=t=>e.addNewUserLoginEmail=t),name:"add-existing-user-email",uicontrol:"text"},null,8,["modelValue"])])]),Object(a["createElementVNode"])("div",En,[Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close btn",onClick:t[14]||(t[14]=Object(a["withModifiers"])(t=>e.addExistingUser(),["prevent"])),style:{"margin-right":"3.5px"}},Object(a["toDisplayString"])(e.translate("General_Add")),1),Object(a["createElementVNode"])("a",{href:"",class:"modal-action modal-close modal-no",onClick:t[15]||(t[15]=Object(a["withModifiers"])(t=>e.addNewUserLoginEmail=null,["prevent"]))},Object(a["toDisplayString"])(e.translate("General_Cancel")),1)])],512)])),[[m]])}const Tn=20,{$:An}=window;var Mn=Object(a["defineComponent"])({props:{currentUserRole:{type:String,required:!0},initialSiteName:{type:String,required:!0},initialSiteId:{type:String,required:!0},accessLevels:{type:Array,required:!0},filterAccessLevels:{type:Array,required:!0},filterStatusLevels:{type:Array,required:!0},activatedPlugins:{type:Array,required:!0},inviteTokenExpiryDays:{type:String,required:!0},passwordStrengthValidationRules:{type:Array,default:()=>[]},inviteComponent:{type:Object,required:!1,default:null},resendInviteComponent:{type:Object,required:!1,default:null}},components:{EnrichedHeadline:h["EnrichedHeadline"],PagedUsersList:On,UserEditForm:kt,Field:g["Field"]},directives:{ContentIntro:h["ContentIntro"],Tooltips:h["Tooltips"]},data(){return{isEditing:!!h["MatomoUrl"].urlParsed.value.showadduser,isInviting:!1,isCurrentUserSuperUser:!0,users:[],totalEntries:null,searchParams:{offset:0,limit:Tn,filter_search:"",filter_access:"",filter_status:"",idSite:this.initialSiteId},isLoadingUsers:!1,userBeingEdited:null,addNewUserLoginEmail:"",loading:!1,triggerResendInviteForUser:null}},created(){this.fetchUsers()},watch:{limit(){this.fetchUsers()}},methods:{onInvite(e){this.isInviting=!1,this.userBeingEdited=e,this.isEditing=!0,this.fetchUsers()},onEditUser(e){h["Matomo"].helper.lazyScrollToContent(),this.isEditing=!0,this.userBeingEdited=e},onDoneEditing(e){this.isEditing=!1,e&&this.fetchUsers()},showAddExistingUserModal(){An(this.$refs.addExistingUserModal).modal({dismissible:!1}).modal("open")},onChangeUserRole(e,t,s){this.isLoadingUsers=!0,Promise.resolve().then(()=>"all"===e?this.getAllUsersInSearch():e).then(e=>e.filter(e=>"superuser"!==e.role).map(e=>e.login)).then(e=>{const n=this.accessLevels.filter(e=>e.key===t).map(e=>e.type);let r;return r=n.length&&"capability"===n[0]?e.map(e=>({method:"UsersManager.addCapabilities",userLogin:e,capabilities:t,idSites:this.searchParams.idSite,passwordConfirmation:s})):e.map(e=>({method:"UsersManager.setUserAccess",userLogin:e,access:t,idSites:this.searchParams.idSite,passwordConfirmation:s})),h["AjaxHelper"].fetch(r,{createErrorNotification:!0})}).catch(()=>{}).finally(()=>this.fetchUsers())},getAllUsersInSearch(){return h["AjaxHelper"].fetch({method:"UsersManager.getUsersPlusRole",filter_search:this.searchParams.filter_search,filter_access:this.searchParams.filter_access,filter_status:this.searchParams.filter_status,idSite:this.searchParams.idSite,filter_limit:"-1"})},onDeleteUser(e,t){this.isLoadingUsers=!0,Promise.resolve().then(()=>"all"===e?this.getAllUsersInSearch():e).then(e=>e.map(e=>e.login)).then(e=>{const s=e.map(e=>({method:"UsersManager.deleteUser",userLogin:e,passwordConfirmation:t}));return h["AjaxHelper"].fetch(s,{createErrorNotification:!0})}).then(()=>{h["NotificationsStore"].scrollToNotification(h["NotificationsStore"].show({id:"removeUserSuccess",message:Object(h["translate"])("UsersManager_DeleteSuccess"),context:"success",type:"toast"})),this.fetchUsers()},()=>{"all"!==e&&e.length>1&&h["NotificationsStore"].show({id:"removeUserSuccess",message:Object(h["translate"])("UsersManager_DeleteNotSuccessful"),context:"warning",type:"toast"}),this.fetchUsers()})},fetchUsers(){return this.isLoadingUsers=!0,h["AjaxHelper"].fetch(Object.assign(Object.assign({},this.searchParams),{},{method:"UsersManager.getUsersPlusRole"}),{returnResponseObject:!0}).then(e=>{const t=e.getRequestHandle();this.totalEntries=parseInt(t.getResponseHeader("x-matomo-total-results")||"0",10),this.users=t.responseJSON,this.isLoadingUsers=!1}).catch(()=>{this.isLoadingUsers=!1})},addExistingUser(){return this.isLoadingUsers=!0,h["AjaxHelper"].fetch({method:"UsersManager.userExists",userLogin:this.addNewUserLoginEmail}).then(e=>e&&e.value?this.addNewUserLoginEmail:h["AjaxHelper"].fetch({method:"UsersManager.getUserLoginFromUserEmail",userEmail:this.addNewUserLoginEmail}).then(e=>e.value)).then(e=>h["AjaxHelper"].post({method:"UsersManager.setUserAccess"},{userLogin:e,access:"view",idSites:this.searchParams.idSite})).then(()=>this.fetchUsers()).catch(()=>{this.isLoadingUsers=!1})},onAddNewUser(){const e={isAllowed:!0};h["Matomo"].postEvent("UsersManager.initAddUser",e),e&&!e.isAllowed||(this.isInviting=!0,this.userBeingEdited=null)}},computed:{usedInviteComponent(){if(this.inviteComponent){const[e,t]=this.inviteComponent.split(".");return Object(h["useExternalPluginComponent"])(e,t)}return Object(h["useExternalPluginComponent"])("UsersManager","UserInvite")},usedResendInviteComponent(){if(this.resendInviteComponent){const[e,t]=this.resendInviteComponent.split(".");return Object(h["useExternalPluginComponent"])(e,t)}return Object(h["useExternalPluginComponent"])("UsersManager","ResendInviteModal")}}});Mn.render=wn;var Bn=Mn;const _n={key:0,class:"alert alert-info"},xn={key:1};function Dn(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Field"),l=Object(a["resolveComponent"])("SaveButton"),c=Object(a["resolveComponent"])("ContentBlock"),d=Object(a["resolveDirective"])("form");return Object(a["openBlock"])(),Object(a["createBlock"])(c,{"content-title":e.title},{default:Object(a["withCtx"])(()=>[0===e.anonymousSites.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",_n,Object(a["toDisplayString"])(e.translate("UsersManager_NoteNoAnonymousUserAccessSettingsWontBeUsed2")),1)):Object(a["createCommentVNode"])("",!0),e.anonymousSites.length>0?Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",xn,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"radio",name:"anonymousDefaultReport",modelValue:e.defaultReport,"onUpdate:modelValue":t[0]||(t[0]=t=>e.defaultReport=t),introduction:e.translate("UsersManager_WhenUsersAreNotLoggedInAndVisitPiwikTheyShouldAccess"),options:e.defaultReportOptions},null,8,["modelValue","introduction","options"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"select",name:"anonymousDefaultReportWebsite",modelValue:e.defaultReportWebsite,"onUpdate:modelValue":t[1]||(t[1]=t=>e.defaultReportWebsite=t),options:e.anonymousSites},null,8,["modelValue","options"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"radio",name:"anonymousDefaultDate",modelValue:e.defaultDate,"onUpdate:modelValue":t[2]||(t[2]=t=>e.defaultDate=t),introduction:e.translate("UsersManager_ForAnonymousUsersReportDateToLoadByDefault"),options:e.availableDefaultDates},null,8,["modelValue","introduction","options"])]),Object(a["createVNode"])(l,{saving:e.loading,onConfirm:t[3]||(t[3]=t=>e.save())},null,8,["saving"])])),[[d]]):Object(a["createCommentVNode"])("",!0)]),_:1},8,["content-title"])}var Ln=Object(a["defineComponent"])({props:{title:{type:String,required:!0},anonymousSites:{type:Array,required:!0},anonymousDefaultReport:{type:[String,Number],required:!0},anonymousDefaultSite:{type:String,required:!0},anonymousDefaultDate:{type:String,required:!0},availableDefaultDates:{type:Object,required:!0},defaultReportOptions:{type:Object,required:!0}},components:{ContentBlock:h["ContentBlock"],SaveButton:g["SaveButton"],Field:g["Field"]},directives:{Form:g["Form"]},data(){return{loading:!1,defaultReport:""+this.anonymousDefaultReport,defaultReportWebsite:this.anonymousDefaultSite,defaultDate:this.anonymousDefaultDate}},methods:{save(){const e={anonymousDefaultReport:"1"===this.defaultReport?this.defaultReportWebsite:this.defaultReport,anonymousDefaultDate:this.defaultDate};this.loading=!0,h["AjaxHelper"].post({module:"UsersManager",action:"recordAnonymousUserSettings",format:"json"},e,{withTokenInUrl:!0}).then(()=>{const e=h["NotificationsStore"].show({message:Object(h["translate"])("CoreAdminHome_SettingsSaveSuccess"),id:"anonymousUserSettings",context:"success",type:"transient"});h["NotificationsStore"].scrollToNotification(e)}).finally(()=>{this.loading=!1})}}});Ln.render=Dn;var Rn=Ln;const Pn={id:"newsletterSignup"};function Hn(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Field"),l=Object(a["resolveComponent"])("SaveButton"),c=Object(a["resolveComponent"])("ContentBlock");return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Pn,[Object(a["createVNode"])(c,{"content-title":e.translate("UsersManager_NewsletterSignupTitle")},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"checkbox",name:"newsletterSignupCheckbox",id:"newsletterSignupCheckbox",modelValue:e.newsletterSignupCheckbox,"onUpdate:modelValue":t[0]||(t[0]=t=>e.newsletterSignupCheckbox=t),"full-width":!0,title:e.signupTitleText},null,8,["modelValue","title"])]),Object(a["createVNode"])(l,{id:"newsletterSignupBtn",onConfirm:t[1]||(t[1]=t=>e.signupForNewsletter()),disabled:!e.newsletterSignupCheckbox,value:e.newsletterSignupButtonTitle,saving:e.isProcessingNewsletterSignup},null,8,["disabled","value","saving"])]),_:1},8,["content-title"])],512)),[[a["vShow"],e.showNewsletterSignup]])}var In=Object(a["defineComponent"])({data(){return{showNewsletterSignup:!0,newsletterSignupCheckbox:!1,isProcessingNewsletterSignup:!1,newsletterSignupButtonTitle:Object(h["translate"])("General_Save")}},components:{ContentBlock:h["ContentBlock"],SaveButton:g["SaveButton"],Field:g["Field"]},computed:{signupTitleText(){return Object(h["translate"])("UsersManager_NewsletterSignupMessage",Object(h["externalLink"])("https://matomo.org/privacy-policy/"),"</a>")}},methods:{signupForNewsletter(){this.newsletterSignupButtonTitle=Object(h["translate"])("General_Loading"),this.isProcessingNewsletterSignup=!0,h["AjaxHelper"].fetch({module:"API",method:"UsersManager.newsletterSignup"},{withTokenInUrl:!0}).then(()=>{this.isProcessingNewsletterSignup=!1,this.showNewsletterSignup=!1;const e=h["NotificationsStore"].show({message:Object(h["translate"])("UsersManager_NewsletterSignupSuccessMessage"),id:"newslettersignup",context:"success",type:"transient"});h["NotificationsStore"].scrollToNotification(e)}).catch(()=>{this.isProcessingNewsletterSignup=!1;const e=h["NotificationsStore"].show({message:Object(h["translate"])("UsersManager_NewsletterSignupFailureMessage"),id:"newslettersignup",context:"error",type:"transient"});h["NotificationsStore"].scrollToNotification(e),this.newsletterSignupButtonTitle=Object(h["translate"])("General_PleaseTryAgain")})}}});In.render=Hn;var Fn=In;const $n={id:"userSettingsTable"},qn={key:0},zn={id:"languageHelp",class:"inline-help-node"},Gn=["href"],Wn={class:"sites_autocomplete"};function Yn(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Field"),l=Object(a["resolveComponent"])("SiteSelector"),c=Object(a["resolveComponent"])("SaveButton"),d=Object(a["resolveComponent"])("PasswordConfirmation"),u=Object(a["resolveComponent"])("ContentBlock"),m=Object(a["resolveDirective"])("form");return Object(a["openBlock"])(),Object(a["createBlock"])(u,{"content-title":e.title,feature:"true"},{default:Object(a["withCtx"])(()=>[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("form",$n,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"text",name:"username",title:e.translate("General_Username"),disabled:!0,modelValue:e.username,"onUpdate:modelValue":t[0]||(t[0]=t=>e.username=t),"inline-help":e.translate("UsersManager_YourUsernameCannotBeChanged")},null,8,["title","modelValue","inline-help"])]),e.isUsersAdminEnabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",qn,[Object(a["createVNode"])(o,{uicontrol:"text",name:"email","model-value":e.email,"onUpdate:modelValue":t[1]||(t[1]=t=>{e.email=t,e.doesRequirePasswordConfirmation=!0}),maxlength:100,title:e.translate("UsersManager_Email")},null,8,["model-value","title"])])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",zn,[Object(a["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink("https://matomo.org/translations/")},Object(a["toDisplayString"])(e.translate("LanguagesManager_AboutPiwikTranslations")),9,Gn)]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"select",name:"language",modelValue:e.language,"onUpdate:modelValue":t[2]||(t[2]=t=>e.language=t),title:e.translate("General_Language"),options:e.languageOptions,"inline-help":"#languageHelp"},null,8,["modelValue","title","options"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"select",name:"timeformat",modelValue:e.timeformat,"onUpdate:modelValue":t[3]||(t[3]=t=>e.timeformat=t),title:e.translate("General_TimeFormat"),options:e.timeFormats},null,8,["modelValue","title","options"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"radio",name:"defaultReport",modelValue:e.theDefaultReport,"onUpdate:modelValue":t[4]||(t[4]=t=>e.theDefaultReport=t),introduction:e.translate("UsersManager_ReportToLoadByDefault"),title:e.translate("General_AllWebsitesDashboard"),options:e.defaultReportOptions},null,8,["modelValue","introduction","title","options"])]),Object(a["createElementVNode"])("div",Wn,[Object(a["createVNode"])(l,{modelValue:e.site,"onUpdate:modelValue":t[5]||(t[5]=t=>e.site=t),"show-selected-site":!0,"switch-site-on-select":!1,"show-all-sites-item":!1,showselectedsite:!0,id:"defaultReportSiteSelector"},null,8,["modelValue"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(o,{uicontrol:"radio",name:"defaultDate",modelValue:e.theDefaultDate,"onUpdate:modelValue":t[6]||(t[6]=t=>e.theDefaultDate=t),introduction:e.translate("UsersManager_ReportDateToLoadByDefault"),options:e.availableDefaultDates},null,8,["modelValue","introduction","options"])]),Object(a["createVNode"])(c,{onConfirm:t[7]||(t[7]=t=>e.save()),saving:e.loading},null,8,["saving"]),Object(a["createVNode"])(d,{modelValue:e.showPasswordConfirmation,"onUpdate:modelValue":t[8]||(t[8]=t=>e.showPasswordConfirmation=t),onConfirmed:e.doSave},null,8,["modelValue","onConfirmed"])])),[[m]])]),_:1},8,["content-title"])}var Xn=Object(a["defineComponent"])({props:{isUsersAdminEnabled:{type:Boolean,required:!0},title:{type:String,required:!0},userLogin:{type:String,required:!0},userEmail:{type:String,required:!0},currentLanguageCode:{type:String,required:!0},languageOptions:{type:Object,required:!0},currentTimeformat:{type:Number,required:!0},timeFormats:{type:Object,required:!0},defaultReport:{type:[String,Number],required:!0},defaultReportOptions:{type:Object,required:!0},defaultReportIdSite:{type:[String,Number],required:!0},defaultReportSiteName:{type:String,required:!0},defaultDate:{type:String,required:!0},availableDefaultDates:{type:Object,required:!0}},components:{ContentBlock:h["ContentBlock"],SaveButton:g["SaveButton"],Field:g["Field"],SiteSelector:h["SiteSelector"],PasswordConfirmation:g["PasswordConfirmation"]},directives:{Form:g["Form"]},data(){return{doesRequirePasswordConfirmation:!1,username:this.userLogin,email:this.userEmail,language:this.currentLanguageCode,timeformat:this.currentTimeformat,theDefaultReport:this.defaultReport,site:{id:this.defaultReportIdSite,name:h["Matomo"].helper.htmlDecode(this.defaultReportSiteName)},theDefaultDate:this.defaultDate,loading:!1,showPasswordConfirmation:!1}},methods:{save(){this.doesRequirePasswordConfirmation?this.showPasswordConfirmation=!0:this.doSave()},doSave(e){const t={email:this.email,defaultReport:"MultiSites"===this.theDefaultReport?this.theDefaultReport:this.site.id,defaultDate:this.theDefaultDate,language:this.language,timeformat:this.timeformat};e&&(t.passwordConfirmation=e),this.loading=!0,h["AjaxHelper"].post({module:"UsersManager",action:"recordUserSettings",format:"json"},t,{withTokenInUrl:!0}).then(()=>{const e=h["NotificationsStore"].show({message:Object(h["translate"])("CoreAdminHome_SettingsSaveSuccess"),id:"PersonalSettingsSuccess",context:"success",type:"transient"});h["NotificationsStore"].scrollToNotification(e),this.doesRequirePasswordConfirmation=!1,this.loading=!1}).catch(()=>{this.loading=!1})}}});Xn.render=Yn;var Kn=Xn;const Jn={key:0},Qn={key:1,class:"alert alert-danger"},Zn={key:2,class:"alert alert-danger"},er=["action"],tr={style:{"margin-bottom":"2rem"}},sr={class:"form-group row tokenExpireDateTime"},nr={class:"col s12 m6"},rr={for:"token_expire_date",class:"active"},ar=["value","required"],ir={class:"col s12 m6"},or={class:"form-help"},lr={class:"inline-help"},cr=["innerHTML"],dr=["value"],ur=["value"],mr=["innerHTML"];function br(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Field"),l=Object(a["resolveComponent"])("ContentBlock");return Object(a["openBlock"])(),Object(a["createBlock"])(l,{"content-title":e.translate("UsersManager_AuthTokens")},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("UsersManager_TokenAuthIntro")),1),e.noDescription||e.invalidExpireDate?(Object(a["openBlock"])(),Object(a["createElementBlock"])("br",Jn)):Object(a["createCommentVNode"])("",!0),e.noDescription?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Qn,Object(a["toDisplayString"])(e.translate("General_Description"))+": "+Object(a["toDisplayString"])(e.translate("General_ValidatorErrorEmptyValue")),1)):Object(a["createCommentVNode"])("",!0),e.invalidExpireDate?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Zn,Object(a["toDisplayString"])(e.translate("UsersManager_TokenExpireDate"))+": "+Object(a["toDisplayString"])(e.translate("UsersManager_InvalidTokenExpireDateFormat")),1)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("form",{action:e.addNewTokenFormUrl,method:"post",class:"addTokenForm"},[Object(a["createVNode"])(o,{uicontrol:"text",name:"description",title:e.translate("General_Description"),maxlength:100,required:!0,"inline-help":e.translate("UsersManager_AuthTokenPurpose"),modelValue:e.tokenDescription,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tokenDescription=t),autofocus:""},null,8,["title","inline-help","modelValue"]),Object(a["createVNode"])(o,{uicontrol:"checkbox",name:"secure_only",title:e.translate("UsersManager_OnlyAllowSecureRequests"),required:!1,"inline-help":e.secureOnlyHelp,modelValue:e.tokenSecureOnly,"onUpdate:modelValue":t[1]||(t[1]=t=>e.tokenSecureOnly=t),disabled:e.forceSecureOnlyCalc},null,8,["title","inline-help","modelValue","disabled"]),Object(a["createElementVNode"])("section",tr,[Object(a["createElementVNode"])("h3",null,Object(a["toDisplayString"])(e.translate("UsersManager_ExpireDate")),1),Object(a["createVNode"])(o,{uicontrol:"checkbox",name:"has_expiration",title:e.translate("UsersManager_TokenExpireDateCheckboxLabel"),required:!1,"inline-help":e.tokenExpireDateCheckboxHelpText,modelValue:e.tokenHasExpiration,"onUpdate:modelValue":t[2]||(t[2]=t=>e.tokenHasExpiration=t)},null,8,["title","inline-help","modelValue"]),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",sr,[Object(a["createElementVNode"])("div",nr,[Object(a["createElementVNode"])("label",rr,Object(a["toDisplayString"])(e.translate("UsersManager_TokenExpireDate")),1),Object(a["createElementVNode"])("input",{type:"text",id:"token_expire_date",name:"token_expire_date",value:e.tokenExpireDate,required:e.tokenHasExpiration,onChange:t[3]||(t[3]=t=>e.onKeydownTokenExpireDate(t)),onKeydown:t[4]||(t[4]=t=>e.onKeydownTokenExpireDate(t))},null,40,ar)]),Object(a["createElementVNode"])("div",ir,[Object(a["createElementVNode"])("div",or,[Object(a["createElementVNode"])("span",lr,[Object(a["createElementVNode"])("span",null,[Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.tokenExpireDateHelpText)},null,8,cr)])])])])],512),[[a["vShow"],e.tokenHasExpiration]])]),Object(a["createElementVNode"])("input",{type:"hidden",value:e.formNonce,name:"nonce"},null,8,dr),Object(a["createElementVNode"])("input",{type:"submit",value:e.translate("UsersManager_CreateNewToken"),class:"btn",style:{"margin-right":"4px"}},null,8,ur),Object(a["createElementVNode"])("span",{innerHTML:e.$sanitize(e.cancelLink)},null,8,mr)],8,er)]),_:1},8,["content-title"])}const{$:pr}=window;var hr=Object(a["defineComponent"])({props:{formNonce:String,noDescription:Boolean,invalidExpireDate:Boolean,forceSecureOnly:Boolean,defaultExpirationDays:Number,expirationReminderDays:Number,initialExpireDate:String},components:{ContentBlock:h["ContentBlock"],Field:g["Field"]},data(){return{tokenDescription:"",tokenSecureOnly:!0,tokenHasExpiration:!0,tokenExpireDate:null,isSaving:!1}},mounted(){this.setInitialTokenExpirationDate()},computed:{addNewTokenFormUrl(){return"?"+h["MatomoUrl"].stringify(Object.assign(Object.assign({},h["MatomoUrl"].urlParsed.value),{},{module:"UsersManager",action:"addNewToken"}))},cancelLink(){const e="?"+h["MatomoUrl"].stringify(Object.assign(Object.assign({},h["MatomoUrl"].urlParsed.value),{},{module:"UsersManager",action:"userSecurity"}));return Object(h["translate"])("General_OrCancel",`<a class='entityCancelLink' href='${e}'>`,"</a>")},forceSecureOnlyCalc(){return this.forceSecureOnly},secureOnlyHelp(){return this.forceSecureOnly?Object(h["translate"])("UsersManager_AuthTokenSecureOnlyHelpForced"):Object(h["translate"])("UsersManager_AuthTokenSecureOnlyHelp")},tokenExpireDateHelpText(){return Object(h["translate"])("UsersManager_TokenExpireDateHelpText",this.defaultExpirationDays,this.expirationReminderDays)},tokenExpireDateCheckboxHelpText(){return Object(h["translate"])("UsersManager_TokenExpireDateCheckboxHelp",this.expirationReminderDays)}},methods:{setInitialTokenExpirationDate(){const e=new Date(this.initialExpireDate),t=h["Matomo"].getBaseDatePickerOptions(e),s=pr('[name="token_expire_date"]',this.$refs.root);setTimeout(()=>{this.tokenExpireDate=this.initialExpireDate,s.datepicker(t),s.datepicker("setDate",e)})},onKeydownTokenExpireDate(e){setTimeout(()=>{this.tokenExpireDate=e.target.value})}}});hr.render=br;var gr=hr;const Or=Object(a["createElementVNode"])("br",null,null,-1),jr={style:{"font-size":"40px"},class:"generatedTokenAuth"},fr=["href"];function vr(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("ContentBlock"),l=Object(a["resolveDirective"])("copy-to-clipboard");return Object(a["openBlock"])(),Object(a["createBlock"])(o,{"content-title":e.translate("UsersManager_TokenSuccessfullyGenerated")},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_PleaseStoreToken"))+" ",1),Or,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("UsersManager_DoNotStoreToken")),1)]),Object(a["createElementVNode"])("div",null,[Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("pre",jr,[Object(a["createElementVNode"])("code",null,Object(a["toDisplayString"])(e.generatedToken),1)])),[[l,{}]])]),Object(a["createElementVNode"])("a",{href:e.userSecurityLink,class:"btn",style:{height:"auto"}},Object(a["toDisplayString"])(e.translate("UsersManager_ConfirmTokenCopied"))+" "+Object(a["toDisplayString"])(e.translate("UsersManager_GoBackSecurityPage")),9,fr)]),_:1},8,["content-title"])}var Cr=Object(a["defineComponent"])({props:{generatedToken:{type:String,required:!0}},components:{ContentBlock:h["ContentBlock"]},directives:{CopyToClipboard:h["CopyToClipboard"]},computed:{userSecurityLink(){return"?"+h["MatomoUrl"].stringify(Object.assign(Object.assign({},h["MatomoUrl"].urlParsed.value),{},{module:"UsersManager",action:"userSecurity"}))}}});Cr.render=vr;var kr=Cr;const yr=["action"],Sr=["value"],Nr={key:0},Ur=["innerHTML"],Vr=["value","disabled"],Er={key:1},wr={class:"alert alert-danger"},Tr=["innerHTML"],Ar={ref:"afterPassword"},Mr=Object(a["createElementVNode"])("a",{name:"authtokens",id:"authtokens"},null,-1),Br={class:"listAuthTokens"},_r={key:0},xr=["innerHTML"],Dr={class:"creationDate"},Lr=["action"],Rr=["value"],Pr=["value"],Hr=["title"],Ir=Object(a["createElementVNode"])("span",{class:"icon-delete"},null,-1),Fr=[Ir],$r={class:"tableActionBar"},qr=["href"],zr=Object(a["createElementVNode"])("span",{class:"icon-add"},null,-1),Gr=["action"],Wr=["value"],Yr=Object(a["createElementVNode"])("input",{name:"idtokenauth",type:"hidden",value:"all"},null,-1),Xr={type:"submit",class:"table-action delete-all-tokens"},Kr=Object(a["createElementVNode"])("span",{class:"icon-delete"},null,-1);function Jr(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("Field"),l=Object(a["resolveComponent"])("ContentBlock"),c=Object(a["resolveDirective"])("auto-clear-password"),d=Object(a["resolveDirective"])("content-table");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[e.isUsersAdminEnabled?(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:0,"content-title":e.translate("General_ChangePassword"),feature:"true"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("form",{id:"userSettingsTable",method:"post",action:e.recordPasswordChangeAction},[Object(a["createElementVNode"])("input",{type:"hidden",value:e.changePasswordNonce,name:"nonce"},null,8,Sr),e.isValidHost?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Nr,[Object(a["withDirectives"])(Object(a["createVNode"])(o,{uicontrol:"password",name:"password",autocomplete:"off",modelValue:e.password,"onUpdate:modelValue":t[0]||(t[0]=t=>e.password=t),title:e.translate("Login_NewPassword"),"inline-help":e.translate("UsersManager_IfYouWouldLikeToChangeThePasswordTypeANewOne"),"ui-control-attributes":{passwordStrengthValidationRules:e.passwordStrengthValidationRules},"onCheck:isValid":t[1]||(t[1]=t=>e.setPasswordStrengthValidation(t,"passwordStrengthMet"))},null,8,["modelValue","title","inline-help","ui-control-attributes"]),[[c]]),Object(a["withDirectives"])(Object(a["createVNode"])(o,{uicontrol:"password",name:"passwordBis",autocomplete:"off",modelValue:e.passwordBis,"onUpdate:modelValue":t[2]||(t[2]=t=>e.passwordBis=t),title:e.translate("Login_NewPasswordRepeat"),"inline-help":e.translate("UsersManager_TypeYourPasswordAgain"),"ui-control-attributes":{passwordStrengthValidationRules:e.passwordStrengthValidationRules},"onCheck:isValid":t[3]||(t[3]=t=>e.setPasswordStrengthValidation(t,"passwordBisStrengthMet"))},null,8,["modelValue","title","inline-help","ui-control-attributes"]),[[c]]),Object(a["withDirectives"])(Object(a["createVNode"])(o,{uicontrol:"password",name:"passwordConfirmation",autocomplete:"off",modelValue:e.passwordConfirmation,"onUpdate:modelValue":t[4]||(t[4]=t=>e.passwordConfirmation=t),title:e.translate("UsersManager_YourCurrentPassword"),"inline-help":e.translate("UsersManager_TypeYourCurrentPassword")},null,8,["modelValue","title","inline-help"]),[[c]]),Object(a["createElementVNode"])("div",{class:"alert alert-info",innerHTML:e.$sanitize(e.changePasswordInfoNotification)},null,8,Ur),Object(a["createElementVNode"])("input",{type:"submit",value:e.translate("General_Save"),class:"btn",disabled:!e.isPasswordChangeFormSubmitEnabled},null,8,Vr)])):Object(a["createCommentVNode"])("",!0),e.isValidHost?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",Er,[Object(a["createElementVNode"])("div",wr,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("UsersManager_InjectedHostCannotChangePwd",e.invalidHost))+" ",1),e.isSuperUser?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,innerHTML:e.$sanitize(e.emailYourAdminText)},null,8,Tr))])]))],8,yr)]),_:1},8,["content-title"])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",Ar,[e.isUsersAdminEnabled&&e.afterPasswordComponent?(Object(a["openBlock"])(),Object(a["createBlock"])(Object(a["resolveDynamicComponent"])(e.afterPasswordComponent),{key:0})):Object(a["createCommentVNode"])("",!0)],512),Mr,Object(a["createVNode"])(l,{"content-title":e.translate("UsersManager_AuthTokens")},{default:Object(a["withCtx"])(()=>{var t,s;return[Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("UsersManager_TokenAuthIntro"))+" "+Object(a["toDisplayString"])(e.translate("UsersManager_ExpiredTokensDeleteAutomatically")),1),Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("table",Br,[Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("General_CreationDate")),1),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("General_Description")),1),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("UsersManager_LastUsed")),1),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("UsersManager_SecureUseOnly")),1),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("UsersManager_ExpireDate")),1),Object(a["createElementVNode"])("th",null,Object(a["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(a["createElementVNode"])("tbody",null,[null!==(t=e.tokens)&&void 0!==t&&t.length?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",_r,[Object(a["createElementVNode"])("td",{colspan:5,innerHTML:e.$sanitize(e.noTokenCreatedYetText)},null,8,xr)])),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.tokens||[],t=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{key:t.idusertokenauth},[Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("span",Dr,Object(a["toDisplayString"])(t.date_created),1)]),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.description),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.last_used?t.last_used:e.translate("General_Never")),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(1===parseInt(t.secure_only,10)?e.translate("General_Yes"):e.translate("General_No")),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.date_expired?t.date_expired:e.translate("General_Never")),1),Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("form",{method:"post",action:e.deleteTokenAction,style:{display:"inline"}},[Object(a["createElementVNode"])("input",{name:"nonce",type:"hidden",value:e.deleteTokenNonce},null,8,Rr),Object(a["createElementVNode"])("input",{name:"idtokenauth",type:"hidden",value:t.idusertokenauth},null,8,Pr),Object(a["createElementVNode"])("button",{type:"submit",class:"table-action",title:e.translate("General_Delete")},Fr,8,Hr)],8,Lr)])]))),128))])])),[[d]]),Object(a["createElementVNode"])("div",$r,[Object(a["createElementVNode"])("a",{href:e.addNewTokenLink,class:"addNewToken"},[zr,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("UsersManager_CreateNewToken")),1)],8,qr),null!==(s=e.tokens)&&void 0!==s&&s.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("form",{key:0,method:"post",action:e.deleteTokenAction,style:{display:"inline"}},[Object(a["createElementVNode"])("input",{name:"nonce",type:"hidden",value:e.deleteTokenNonce},null,8,Wr),Yr,Object(a["createElementVNode"])("button",Xr,[Kr,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("UsersManager_DeleteAllTokens")),1)])],8,Gr)):Object(a["createCommentVNode"])("",!0)])]}),_:1},8,["content-title"])])}var Qr=Object(a["defineComponent"])({props:{deleteTokenNonce:String,tokens:Array,isUsersAdminEnabled:Boolean,changePasswordNonce:String,isValidHost:Boolean,isSuperUser:Boolean,invalidHost:String,afterPasswordEventContent:String,invalidHostMailLinkStart:String,passwordStrengthValidationRules:Array},components:{ContentBlock:h["ContentBlock"],Field:g["Field"]},directives:{ContentTable:h["ContentTable"],AutoClearPassword:h["AutoClearPassword"]},data(){return{password:"",passwordBis:"",passwordConfirmation:"",passwordStrengthMet:!1,passwordBisStrengthMet:!1}},mounted(){const e=this.$refs.afterPassword;h["Matomo"].helper.compileVueEntryComponents(e)},methods:{setPasswordStrengthValidation(e,t){"passwordStrengthMet"===t&&(this.passwordStrengthMet=e),"passwordBisStrengthMet"===t&&(this.passwordBisStrengthMet=e)}},computed:{recordPasswordChangeAction(){return"?"+h["MatomoUrl"].stringify(Object.assign(Object.assign({},h["MatomoUrl"].urlParsed.value),{},{module:"UsersManager",action:"recordPasswordChange"}))},emailYourAdminText(){return Object(h["translate"])("UsersManager_EmailYourAdministrator",this.invalidHostMailLinkStart||"","</a>")},noTokenCreatedYetText(){const e="?"+h["MatomoUrl"].stringify(Object.assign(Object.assign({},h["MatomoUrl"].urlParsed.value),{},{module:"UsersManager",action:"addNewToken"}));return Object(h["translate"])("UsersManager_NoTokenCreatedYetCreateNow",`<a href="${e}">`,"</a>")},changePasswordInfoNotification(){var e;const t=Object(h["translate"])("UsersManager_PasswordChangeTerminatesOtherSessions");let s="";return null!==(e=this.tokens)&&void 0!==e&&e.length&&(s=Object(h["translate"])("UsersManager_PasswordChangeDoesNotRevokeAuthTokens",`<a href="#authtokens">${Object(h["translate"])("UsersManager_AuthTokens")}</a>`)),[t,s].filter(e=>e).join("<br><br>")},deleteTokenAction(){return"?"+h["MatomoUrl"].stringify(Object.assign(Object.assign({},h["MatomoUrl"].urlParsed.value),{},{module:"UsersManager",action:"deleteToken"}))},addNewTokenLink(){return"?"+h["MatomoUrl"].stringify(Object.assign(Object.assign({},h["MatomoUrl"].urlParsed.value),{},{module:"UsersManager",action:"addNewToken"}))},afterPasswordComponent(){if(!this.afterPasswordEventContent)return null;const e=this.$refs.afterPassword;return Object(a["markRaw"])({template:this.afterPasswordEventContent,beforeUnmount(){h["Matomo"].helper.destroyVueComponent(e)}})},isPasswordChangeFormSubmitEnabled(){var e,t;return this.passwordConfirmation&&(!(null!==(e=this.passwordStrengthValidationRules)&&void 0!==e&&e.length)||(null===(t=this.passwordStrengthValidationRules)||void 0===t?void 0:t.length)&&this.passwordStrengthMet&&this.passwordBisStrengthMet)}}});Qr.render=Jr;var Zr=Qr;const ea=["innerHTML"],ta={style:{"margin-left":"20px"}},sa=["href"],na=Object(a["createElementVNode"])("br",null,null,-1);function ra(e,t,s,n,r,i){const o=Object(a["resolveComponent"])("PersonalSettings"),l=Object(a["resolveComponent"])("NewsletterSettings"),c=Object(a["resolveComponent"])("PluginSettings"),d=Object(a["resolveComponent"])("ContentBlock");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["createVNode"])(o,{"is-users-admin-enabled":e.isUsersAdminEnabled,title:e.translate("UsersManager_PersonalSettings"),"user-login":e.userLogin,"user-email":e.userEmail,"current-language-code":e.currentLanguageCode,"language-options":e.languageOptions,"current-timeformat":e.currentTimeformat,"time-formats":e.timeFormats,"default-report":e.defaultReport,"default-report-options":e.defaultReportOptions,"default-report-id-site":e.defaultReportIdSite,"default-report-site-name":e.defaultReportSiteName,"default-date":e.defaultDate,"available-default-dates":e.availableDefaultDates},null,8,["is-users-admin-enabled","title","user-login","user-email","current-language-code","language-options","current-timeformat","time-formats","default-report","default-report-options","default-report-id-site","default-report-site-name","default-date","available-default-dates"]),e.showNewsletterSignup?(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:0})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(c,{mode:"user"}),Object(a["createVNode"])(d,{"content-title":e.translate("UsersManager_ExcludeVisitsViaCookie"),class:"ignoreCookieSettings"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.yourVisitsAreText)},null,8,ea),Object(a["createElementVNode"])("span",ta,[Object(a["createElementVNode"])("a",{href:e.setIgnoreCookieLink},[Object(a["createTextVNode"])(" › "+Object(a["toDisplayString"])(e.ignoreCookieSet?e.translate("UsersManager_ClickHereToDeleteTheCookie"):e.translate("UsersManager_ClickHereToSetTheCookieOnDomain",e.piwikHost))+" ",1),na],8,sa)])]),_:1},8,["content-title"])])}var aa=Object(a["defineComponent"])({props:{isUsersAdminEnabled:{type:Boolean,required:!0},userLogin:{type:String,required:!0},userEmail:{type:String,required:!0},currentLanguageCode:{type:String,required:!0},languageOptions:{type:Object,required:!0},currentTimeformat:{type:Number,required:!0},timeFormats:{type:Object,required:!0},defaultReport:{type:[String,Number],required:!0},defaultReportOptions:{type:Object,required:!0},defaultReportIdSite:{type:[String,Number],required:!0},defaultReportSiteName:{type:String,required:!0},defaultDate:{type:String,required:!0},availableDefaultDates:{type:Object,required:!0},showNewsletterSignup:Boolean,ignoreCookieSet:Boolean,setIgnoreCookieNonce:String,piwikHost:{type:String,required:!0}},components:{ContentBlock:h["ContentBlock"],PersonalSettings:Kn,NewsletterSettings:Fn,PluginSettings:g["PluginSettings"]},computed:{yourVisitsAreText(){return this.ignoreCookieSet?Object(h["translate"])("UsersManager_YourVisitsAreIgnoredOnDomain","<strong>",this.piwikHost,"</strong>"):Object(h["translate"])("UsersManager_YourVisitsAreNotIgnored","<strong>","</strong>")},setIgnoreCookieLink(){return`?${h["MatomoUrl"].stringify({module:"UsersManager",action:"setIgnoreCookie",nonce:this.setIgnoreCookieNonce})}#excludeCookie`}}});aa.render=ra;var ia=aa;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["SitesManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["SitesManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,a){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(i,r,function(t){return e[t]}.bind(null,r));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="plugins/SitesManager/vue/dist/",a(a.s="fae3")}({"19dc":function(t,a){t.exports=e},"8bbf":function(e,a){e.exports=t},a5a2:function(e,t){e.exports=a},fae3:function(e,t,a){"use strict";if(a.r(t),a.d(t,"SiteTypesStore",(function(){return d})),a.d(t,"CurrencyStore",(function(){return b})),a.d(t,"TimezoneStore",(function(){return g})),a.d(t,"SitesManagement",(function(){return Re})),a.d(t,"ManageGlobalSettings",(function(){return Ct})),a.d(t,"ExcludeQueryParameterSettings",(function(){return Tt})),a.d(t,"SiteWithoutData",(function(){return Wt})),"undefined"!==typeof window){var i=window.document.currentScript,r=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(a.p=r[1])}var n=a("8bbf"),l=a("19dc");function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */const{$:o}=window;class c{constructor(){s(this,"state",Object(n["reactive"])({isLoading:!1,typesById:{}})),s(this,"typesById",Object(n["computed"])(()=>Object(n["readonly"])(this.state).typesById)),s(this,"isLoading",Object(n["computed"])(()=>Object(n["readonly"])(this.state).isLoading)),s(this,"types",Object(n["computed"])(()=>Object.values(this.typesById.value))),s(this,"response",void 0)}init(){return this.fetchAvailableTypes()}fetchAvailableTypes(){return this.response?Promise.resolve(this.response):(this.state.isLoading=!0,this.response=l["AjaxHelper"].fetch({method:"API.getAvailableMeasurableTypes",filter_limit:"-1"}).then(e=>(e.forEach(e=>{this.state.typesById[e.id]=e}),this.types.value)).finally(()=>{this.state.isLoading=!1}),this.response)}getEditSiteIdParameter(){const e=l["MatomoUrl"].hashQuery.value.match(/editsiteid=([0-9]+)/);if(!e)return;const t="1"===l["MatomoUrl"].urlParsed.value.showaddsite||"true"===l["MatomoUrl"].urlParsed.value.showaddsite,a=e[1];return a&&o.isNumeric(a)&&!t?a:void 0}removeEditSiteIdParameterFromHash(){const e=Object.assign({},l["MatomoUrl"].hashParsed.value);delete e.editsiteid,l["MatomoUrl"].updateHash(e)}}var d=new c;function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class m{constructor(){u(this,"privateState",Object(n["reactive"])({isLoading:!1,currencies:{}})),u(this,"currencies",Object(n["computed"])(()=>Object(n["readonly"])(this.privateState).currencies)),u(this,"isLoading",Object(n["computed"])(()=>Object(n["readonly"])(this.privateState).isLoading)),u(this,"initializePromise",null)}init(){return this.initializePromise||(this.initializePromise=this.fetchCurrencies()),this.initializePromise}fetchCurrencies(){return this.privateState.isLoading=!0,l["AjaxHelper"].fetch({method:"SitesManager.getCurrencyList"}).then(e=>{this.privateState.currencies=e}).finally(()=>{this.privateState.isLoading=!1})}}var b=new m;function h(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class p{constructor(){h(this,"privateState",Object(n["reactive"])({isLoading:!1,timezones:[],timezoneSupportEnabled:!1})),h(this,"state",Object(n["computed"])(()=>Object(n["readonly"])(this.privateState))),h(this,"timezones",Object(n["computed"])(()=>this.state.value.timezones)),h(this,"timezoneSupportEnabled",Object(n["computed"])(()=>this.state.value.timezoneSupportEnabled)),h(this,"isLoading",Object(n["computed"])(()=>this.state.value.isLoading)),h(this,"initializePromise",null)}init(){return this.initializePromise||(this.privateState.isLoading=!0,this.initializePromise=Promise.all([this.checkTimezoneSupportEnabled(),this.fetchTimezones()]).finally(()=>{this.privateState.isLoading=!1})),this.initializePromise}fetchTimezones(){return l["AjaxHelper"].fetch({method:"SitesManager.getTimezonesList"}).then(e=>{const t=[];Object.entries(e).forEach(([e,a])=>{Object.entries(a).forEach(([a,i])=>{t.push({group:e,label:a,code:i})})}),this.privateState.timezones=t})}checkTimezoneSupportEnabled(){return l["AjaxHelper"].fetch({method:"SitesManager.isTimezoneSupportEnabled"}).then(e=>{this.privateState.timezoneSupportEnabled=e.value})}}var g=new p;const S={class:"SitesManager",ref:"root"},O={class:"sites-manager-header"},j=["innerHTML"],y=Object(n["createElementVNode"])("br",null,null,-1),v=["innerHTML"],f={class:"loadingPiwik"},E={class:"ui-confirm add-site-dialog"},x={class:"center"},N=Object(n["createElementVNode"])("br",null,null,-1),V={class:"card-row"},M={class:"center"},T=["title","onClick"],P={class:"ui-button-text"},C={class:"sitesManagerList"},w={key:0},D={class:"bottomButtonBar"};function k(e,t,a,i,r,l){const s=Object(n["resolveComponent"])("EnrichedHeadline"),o=Object(n["resolveComponent"])("MatomoLoader"),c=Object(n["resolveComponent"])("ButtonBar"),d=Object(n["resolveComponent"])("ContentBlock"),u=Object(n["resolveComponent"])("MatomoDialog"),m=Object(n["resolveComponent"])("SiteFields"),b=Object(n["resolveDirective"])("content-intro");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",S,[Object(n["createElementVNode"])("div",O,[Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[Object(n["withDirectives"])(Object(n["createElementVNode"])("h2",null,[Object(n["createVNode"])(s,{"help-url":e.externalRawLink("https://matomo.org/docs/manage-websites/"),"feature-name":e.translate("SitesManager_WebsitesManagement")},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.headlineText),1)]),_:1},8,["help-url","feature-name"])],512),[[n["vShow"],e.availableTypes.length]]),Object(n["createElementVNode"])("p",null,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_MainDescription"))+" ",1),Object(n["createElementVNode"])("span",{innerHTML:e.$sanitize(e.mainDescription)},null,8,j),Object(n["withDirectives"])(Object(n["createElementVNode"])("span",null,[y,Object(n["createElementVNode"])("span",{innerHTML:e.$sanitize(e.superUserAccessMessage)},null,8,v)],512),[[n["vShow"],e.hasSuperUserAccess]])])])),[[b]])]),Object(n["createElementVNode"])("div",null,[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])({hide_only:!e.isLoading})},[Object(n["createElementVNode"])("div",f,[Object(n["createVNode"])(o),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("General_LoadingData")),1)])],2)]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(c,{"site-is-being-edited":e.isSiteBeingEdited,"has-prev":e.hasPrev,hasNext:e.hasNext,"offset-start":e.offsetStart,"offset-end":e.offsetEnd,"total-number-of-sites":e.totalNumberOfSites,"is-loading":e.isLoading,"search-term":e.searchTerm,"is-searching":!!e.activeSearchTerm,"onUpdate:searchTerm":t[0]||(t[0]=t=>e.searchTerm=t),onAdd:t[1]||(t[1]=t=>e.addNewEntity()),onSearch:t[2]||(t[2]=t=>e.searchSites(t)),onPrev:t[3]||(t[3]=t=>e.previousPage()),onNext:t[4]||(t[4]=t=>e.nextPage())},null,8,["site-is-being-edited","has-prev","hasNext","offset-start","offset-end","total-number-of-sites","is-loading","search-term","is-searching"])]),Object(n["createVNode"])(u,{modelValue:e.showAddSiteDialog,"onUpdate:modelValue":t[5]||(t[5]=t=>e.showAddSiteDialog=t)},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",E,[Object(n["createElementVNode"])("div",null,[Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.translate("SitesManager_ChooseMeasurableTypeHeadline")),1),Object(n["createElementVNode"])("div",x,[Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.subheaderText),1),N]),Object(n["createElementVNode"])("div",V,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.availableTypes,t=>(Object(n["openBlock"])(),Object(n["createBlock"])(d,{key:t.id,"content-title":t.name},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("p",M,Object(n["toDisplayString"])(t.longDescription),1),Object(n["createElementVNode"])("button",{type:"button",title:t.description,class:"modal-close btn btn-block",onClick:a=>e.addSite(t.id),"aria-disabled":"false"},[Object(n["createElementVNode"])("span",P,Object(n["toDisplayString"])(t.name),1)],8,T)]),_:2},1032,["content-title"]))),128))])])])]),_:1},8,["modelValue"]),Object(n["createElementVNode"])("div",C,[e.activeSearchTerm&&0===e.sites.length&&!e.isLoading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",w,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_NotFound"))+" ",1),Object(n["createElementVNode"])("strong",null,Object(n["toDisplayString"])(e.activeSearchTerm),1)])):Object(n["createCommentVNode"])("",!0),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.sites,(a,i)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:a.idsite},[Object(n["createVNode"])(m,{site:a,"timezone-support-enabled":e.timezoneSupportEnabled,"utc-time":e.utcTime,"global-settings":e.globalSettings,"privacy-manager-enabled":e.privacyManagerEnabled,onEditSite:t[6]||(t[6]=e=>this.isSiteBeingEdited=!0),onCancelEditSite:t[7]||(t[7]=t=>e.afterCancelEdit(t)),onCancelEditPrivacy:t[8]||(t[8]=t=>e.afterCancelEdit(t)),onDelete:t[9]||(t[9]=t=>e.afterDelete(t)),onSave:t=>e.afterSave(t.site,t.settingValues,i,t.isNew)},null,8,["site","timezone-support-enabled","utc-time","global-settings","privacy-manager-enabled","onSave"])]))),128))]),Object(n["createElementVNode"])("div",D,[Object(n["createVNode"])(c,{"site-is-being-edited":e.isSiteBeingEdited,"has-prev":e.hasPrev,hasNext:e.hasNext,"offset-start":e.offsetStart,"offset-end":e.offsetEnd,"total-number-of-sites":e.totalNumberOfSites,"is-loading":e.isLoading,"search-term":e.searchTerm,"is-searching":!!e.activeSearchTerm,"onUpdate:searchTerm":t[10]||(t[10]=t=>e.searchTerm=t),onAdd:t[11]||(t[11]=t=>e.addNewEntity()),onSearch:t[12]||(t[12]=t=>e.searchSites(t)),onPrev:t[13]||(t[13]=t=>e.previousPage()),onNext:t[14]||(t[14]=t=>e.nextPage())},null,8,["site-is-being-edited","has-prev","hasNext","offset-start","offset-end","total-number-of-sites","is-loading","search-term","is-searching"])])],512)}const _={class:"sitesButtonBar clearfix"},G={class:"search"},L=["value","placeholder","disabled"],A=["title"],U={class:"paging"},B=["disabled"],I={style:{cursor:"pointer"}},z={class:"counter"},H=["disabled"],F={style:{cursor:"pointer"},class:"pointer"};function Q(e,t,a,i,r,l){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_,[Object(n["withDirectives"])(Object(n["createElementVNode"])("a",{class:Object(n["normalizeClass"])(["btn addSite",{disabled:e.siteIsBeingEdited}]),onClick:t[0]||(t[0]=t=>e.addNewEntity()),tabindex:"1"},Object(n["toDisplayString"])(e.availableTypes.length>1?e.translate("SitesManager_AddMeasurable"):e.translate("SitesManager_AddSite")),3),[[n["vShow"],e.hasSuperUserAccess&&e.availableTypes]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",G,[Object(n["createElementVNode"])("input",{value:e.searchTerm,onKeydown:t[1]||(t[1]=t=>e.onKeydown(t)),placeholder:e.translate("Actions_SubmenuSitesearch"),type:"text",disabled:e.siteIsBeingEdited},null,40,L),Object(n["createElementVNode"])("div",{onClick:t[2]||(t[2]=t=>e.searchSite()),title:e.translate("General_ClickToSearch"),class:"search_ico icon-search"},null,8,A)],512),[[n["vShow"],e.hasPrev||e.hasNext||e.isSearching]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",U,[Object(n["createElementVNode"])("a",{class:"btn prev",disabled:!(e.hasPrev&&!e.isLoading&&!e.siteIsBeingEdited)||void 0,onClick:t[3]||(t[3]=t=>e.previousPage())},[Object(n["createElementVNode"])("span",I,"« "+Object(n["toDisplayString"])(e.translate("General_Previous")),1)],8,B),Object(n["withDirectives"])(Object(n["createElementVNode"])("span",z,[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(e.paginationText),1)],512),[[n["vShow"],e.hasPrev||e.hasNext]]),Object(n["createElementVNode"])("a",{class:"btn next",disabled:!(e.hasNext&&!e.isLoading&&!e.siteIsBeingEdited)||void 0,onClick:t[4]||(t[4]=t=>e.nextPage())},[Object(n["createElementVNode"])("span",F,Object(n["toDisplayString"])(e.translate("General_Next"))+" »",1)],8,H)],512),[[n["vShow"],e.hasPrev||e.hasNext]])])}var R=Object(n["defineComponent"])({props:{siteIsBeingEdited:{type:Boolean,required:!0},hasPrev:{type:Boolean,required:!0},hasNext:{type:Boolean,required:!0},offsetStart:{type:Number,required:!0},offsetEnd:{type:Number,required:!0},totalNumberOfSites:{type:Number},isLoading:{type:Boolean,required:!0},searchTerm:{type:String,required:!0},isSearching:{type:Boolean,required:!0}},emits:["add","search","prev","next","update:searchTerm"],created(){d.init(),this.onKeydown=Object(l["debounce"])(this.onKeydown,50)},computed:{hasSuperUserAccess(){return l["Matomo"].hasSuperUserAccess},availableTypes(){return d.types.value},paginationText(){let e;return e=this.isSearching?Object(l["translate"])("General_PaginationWithoutTotal",""+this.offsetStart,""+this.offsetEnd):Object(l["translate"])("General_Pagination",""+this.offsetStart,""+this.offsetEnd,null===this.totalNumberOfSites?"?":""+this.totalNumberOfSites),` ${e} `}},methods:{addNewEntity(){this.$emit("add")},searchSite(){this.siteIsBeingEdited||this.$emit("search")},previousPage(){this.$emit("prev")},nextPage(){this.$emit("next")},onKeydown(e){setTimeout(()=>{"Enter"!==e.key?this.$emit("update:searchTerm",e.target.value):this.searchSiteOnEnter(e)})},searchSiteOnEnter(e){e.preventDefault(),this.searchSite()}}});R.render=Q;var $=R;const W=["idsite","type"],K={class:"card-content"},q={key:0,class:"row"},Y={class:"col m3"},X={class:"title"},J={class:"title"},Z=["target","title","href"],ee={class:"col m4"},te={class:"title"},ae={class:"title"},ie={class:"title"},re={class:"title"},ne={class:"col m4"},le={class:"title"},se=["href"],oe={key:0},ce={class:"title"},de={key:1},ue={class:"title"},me={key:2},be={class:"title"},he={class:"col m1 right-align"},pe=["title"],ge=Object(n["createElementVNode"])("span",{class:"icon-edit"},null,-1),Se=[ge],Oe=["title"],je=Object(n["createElementVNode"])("span",{class:"icon-delete"},null,-1),ye=[je],ve={key:1},fe={class:"form-group row"},Ee={class:"col s12 m6 input-field"},xe=["placeholder"],Ne=Object(n["createElementVNode"])("div",{class:"col s12 m6"},null,-1),Ve=["id"],Me={key:0},Te=Object(n["createElementVNode"])("br",null,null,-1),Pe=Object(n["createElementVNode"])("br",null,null,-1),Ce={class:""},we={class:"editingSiteFooter"},De=["disabled","value"],ke=["disabled"],_e=["innerHTML"];function Ge(e,t,a,i,r,l){var s,o,c;const d=Object(n["resolveComponent"])("ActivityIndicator"),u=Object(n["resolveComponent"])("GroupedSettings"),m=Object(n["resolveComponent"])("Field"),b=Object(n["resolveComponent"])("PasswordConfirmation");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])(["site card hoverable",{editingSite:e.editMode}]),idsite:e.theSite.idsite,type:e.theSite.type,ref:"root"},[Object(n["createElementVNode"])("div",K,[e.editMode?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",q,[Object(n["createElementVNode"])("div",Y,[Object(n["createElementVNode"])("h4",null,Object(n["toDisplayString"])(e.theSite.name),1),Object(n["createElementVNode"])("ul",null,[Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("span",X,Object(n["toDisplayString"])(e.translate("General_Id"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.theSite.idsite),1)]),Object(n["withDirectives"])(Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("span",J,Object(n["toDisplayString"])(e.translate("SitesManager_Type"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.currentType.name),1)],512),[[n["vShow"],e.availableTypes.length>1]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("a",{target:e.isInternalSetupUrl?"_self":"_blank",title:e.translate("SitesManager_ShowTrackingTag"),href:e.setupUrl},Object(n["toDisplayString"])(e.translate("SitesManager_ShowTrackingTag")),9,Z)],512),[[n["vShow"],e.theSite.idsite&&e.howToSetupUrl]])])]),Object(n["createElementVNode"])("div",ee,[Object(n["createElementVNode"])("ul",null,[Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("span",te,Object(n["toDisplayString"])(e.translate("SitesManager_Timezone"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.theSite.timezone_name),1)]),Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("span",ae,Object(n["toDisplayString"])(e.translate("SitesManager_Currency"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.theSite.currency_name),1)]),Object(n["withDirectives"])(Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("span",ie,Object(n["toDisplayString"])(e.translate("Goals_Ecommerce"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("General_Yes")),1)],512),[[n["vShow"],1===e.theSite.ecommerce||"1"===e.theSite.ecommerce]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("span",re,Object(n["toDisplayString"])(e.translate("Actions_SubmenuSitesearch"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("General_Yes")),1)],512),[[n["vShow"],1===e.theSite.sitesearch||"1"===e.theSite.sitesearch]])])]),Object(n["createElementVNode"])("div",ne,[Object(n["createElementVNode"])("ul",null,[Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("span",le,Object(n["toDisplayString"])(e.translate("SitesManager_Urls")),1),Object(n["createTextVNode"])(": "),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.theSite.alias_urls,(t,a)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:t},[Object(n["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:t},Object(n["toDisplayString"])(t)+Object(n["toDisplayString"])(a===e.theSite.alias_urls.length-1?"":", "),9,se)]))),128))]),null!==(s=e.theSite.excluded_ips)&&void 0!==s&&s.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",oe,[Object(n["createElementVNode"])("span",ce,Object(n["toDisplayString"])(e.translate("SitesManager_ExcludedIps"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.theSite.excluded_ips.split(/\s*,\s*/g).join(", ")),1)])):Object(n["createCommentVNode"])("",!0),null!==(o=e.theSite.excluded_parameters)&&void 0!==o&&o.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",de,[Object(n["createElementVNode"])("span",ue,Object(n["toDisplayString"])(e.translate("SitesManager_ExcludedParameters"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.theSite.excluded_parameters.split(/\s*,\s*/g).join(", ")),1)])):Object(n["createCommentVNode"])("",!0),null!==(c=e.theSite.excluded_user_agents)&&void 0!==c&&c.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",me,[Object(n["createElementVNode"])("span",be,Object(n["toDisplayString"])(e.translate("SitesManager_ExcludedUserAgents"))+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.theSite.excluded_user_agents.split(/\s*,\s*/g).join(", ")),1)])):Object(n["createCommentVNode"])("",!0)])]),Object(n["createElementVNode"])("div",he,[Object(n["createElementVNode"])("button",{class:"table-action",onClick:t[0]||(t[0]=t=>e.editSite()),title:e.translate("General_Edit")},Se,8,pe),Object(n["withDirectives"])(Object(n["createElementVNode"])("button",{class:"table-action",onClick:t[1]||(t[1]=t=>e.getMessagesToWarnOnSiteRemoval()),title:e.translate("General_Delete")},ye,8,Oe),[[n["vShow"],e.theSite.idsite]])])])),e.editMode?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ve,[Object(n["createElementVNode"])("div",fe,[Object(n["createElementVNode"])("div",Ee,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.theSite.name=t),maxlength:"90",placeholder:e.translate("General_Name")},null,8,xe),[[n["vModelText"],e.theSite.name]]),Object(n["createElementVNode"])("label",null,Object(n["toDisplayString"])(e.translate("General_Name")),1)]),Ne]),Object(n["createVNode"])(d,{loading:e.isLoading},null,8,["loading"]),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.measurableSettings,t=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:t.pluginName},[Object(n["createVNode"])(u,{"group-name":t.pluginName,settings:t.settings,"all-setting-values":e.settingValues,onChange:a=>e.settingValues[`${t.pluginName}.${a.name}`]=a.value},null,8,["group-name","settings","all-setting-values","onChange"])]))),128)),Object(n["createVNode"])(m,{uicontrol:"select",name:"currency",modelValue:e.theSite.currency,"onUpdate:modelValue":t[3]||(t[3]=t=>e.theSite.currency=t),title:e.translate("SitesManager_Currency"),"inline-help":e.translate("SitesManager_CurrencySymbolWillBeUsedForGoals"),options:e.currencies},null,8,["modelValue","title","inline-help","options"]),Object(n["createVNode"])(m,{uicontrol:"select",name:"timezone",modelValue:e.theSite.timezone,"onUpdate:modelValue":t[4]||(t[4]=t=>e.theSite.timezone=t),title:e.translate("SitesManager_Timezone"),"inline-help":"#timezoneHelpText-"+e.theSite.idsite,options:e.timezones},null,8,["modelValue","title","inline-help","options"]),Object(n["createElementVNode"])("div",{id:"timezoneHelpText-"+e.theSite.idsite,class:"inline-help-node"},[Object(n["createElementVNode"])("div",null,[e.timezoneSupportEnabled?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Me,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_AdvancedTimezoneSupportNotFound"))+" ",1),Te])),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.utcTimeIs)+" ",1),Pe,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_ChangingYourTimezoneWillOnlyAffectDataForward")),1)])],8,Ve),e.privacyManagerEnabled&&e.theSite&&e.theSite.idsite?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Object(n["createElementVNode"])("h3",Ce,Object(n["toDisplayString"])(e.translate("PrivacyManager_TrackingDataAnonymizationSettings")),1),Object(n["createVNode"])(d,{loading:e.isLoadingPrivacy},null,8,["loading"]),e.isLoadingPrivacy?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["resolveDynamicComponent"])(e.anonymizeIpComponent),Object(n["mergeProps"])({key:0,"id-site-specific":e.theSite.idsite,"trigger-save":"save"==e.triggerSavePrivacySettings},e.anonymisationSettings,{onUpdated:e.onPrivacyUpdated,onAborted:e.onPrivacyAborted,onCancel:t[5]||(t[5]=t=>e.cancelEditSite(e.site))}),null,16,["id-site-specific","trigger-save","onUpdated","onAborted"]))],64)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",we,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{disabled:e.isSaving,type:"submit",class:"btn",value:e.translate("General_Save"),onClick:t[6]||(t[6]=t=>e.saveSite())},null,8,De),[[n["vShow"],!e.isLoading]]),Object(n["createElementVNode"])("button",{class:"btn btn-link",disabled:e.isSaving,onClick:t[7]||(t[7]=t=>e.cancelEditSite(e.site))},Object(n["toDisplayString"])(e.translate("General_Cancel","","")),9,ke)])])):Object(n["createCommentVNode"])("",!0)]),Object(n["createVNode"])(b,{modelValue:e.showRemoveDialog,"onUpdate:modelValue":t[8]||(t[8]=t=>e.showRemoveDialog=t),onConfirmed:e.deleteSite,"password-field-id":"currentUserPassword-"+e.theSite.idsite},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.removeDialogTitle),1),Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.translate("SitesManager_DeleteSiteExplanation")),1),e.deleteSiteExplanation?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(e.deleteSiteExplanation)},null,8,_e)):Object(n["createCommentVNode"])("",!0)]),_:1},8,["modelValue","onConfirmed","password-field-id"])],10,W)}var Le=a("a5a2");const Ae=Object(n["computed"])(()=>g.timezones.value.map(({group:e,label:t,code:a})=>({group:e,key:t,value:a})));function Ue(e){return"undefined"===typeof e.idsite}var Be=Object(n["defineComponent"])({props:{site:{type:Object,required:!0},timezoneSupportEnabled:{type:Boolean},utcTime:{type:Date,required:!0},globalSettings:{type:Object,required:!0},privacyManagerEnabled:{type:Boolean,default:!1}},data(){return{isLoading:!1,isLoadingPrivacy:!1,isSaving:!1,editMode:!1,theSite:Object.assign({},this.site),measurableSettings:[],anonymisationSettings:[],settingValues:{},showRemoveDialog:!1,deleteSiteExplanation:"",triggerSavePrivacySettings:""}},components:{PasswordConfirmation:Le["PasswordConfirmation"],Field:Le["Field"],GroupedSettings:Le["GroupedSettings"],ActivityIndicator:l["ActivityIndicator"]},emits:["delete","editSite","cancelEditSite","save"],created(){b.init(),g.init(),d.init(),this.onSiteChanged()},watch:{site(){this.onSiteChanged()},measurableSettings(e){if(!e.length)return;const t={};e.forEach(e=>{e.settings.forEach(a=>{t[`${e.pluginName}.${a.name}`]=a.value})}),this.settingValues=t}},methods:{onSiteChanged(){const e=this.site;this.theSite=Object.assign({},e);const t=Ue(e);if(t){const e=this.globalSettings;this.theSite.timezone=e.defaultTimezone,this.theSite.currency=e.defaultCurrency}const a=d.getEditSiteIdParameter();(t||a&&""+e.idsite===a)&&this.editSite()},editSite(){this.editMode=!0;const e=this.theSite.idsite;if(this.$emit("editSite",{idSite:e}),this.measurableSettings=[],this.anonymisationSettings=[],Ue(this.theSite)){if(!this.currentType)return;this.measurableSettings=this.currentType.settings||[]}else this.isLoading=!0,l["AjaxHelper"].fetch({method:"SitesManager.getSiteSettings",idSite:e}).then(e=>{this.measurableSettings=e}).finally(()=>{this.isLoading=!1}),this.privacyManagerEnabled&&e&&(this.isLoadingPrivacy=!0,l["AjaxHelper"].fetch({method:"PrivacyManager.getAnonymisationSettings",idSiteSpecific:e}).then(e=>{this.anonymisationSettings=e}).finally(()=>{this.isLoadingPrivacy=!1}))},onPrivacyUpdated(){this.triggerSavePrivacySettings="done",this.anonymisationSettings=[]},onPrivacyAborted(){this.triggerSavePrivacySettings="abort",this.isSaving=!1},saveSite(){if(this.isSaving)return;this.isSaving=!0;const e={siteName:this.theSite.name,timezone:this.theSite.timezone,currency:this.theSite.currency,type:this.theSite.type,settingValues:{}},t=Ue(this.theSite);let a="SitesManager.addSite";t||(a="SitesManager.updateSite",e.idSite=this.theSite.idsite),Object.entries(this.settingValues).forEach(([t,a])=>{const[i,r]=t.split("."),n=e.settingValues;n[i]||(n[i]=[]);let l=a;!1===a?l="0":!0===a?l="1":Array.isArray(a)&&(l=a.filter(e=>!!e)),n[i].push({name:r,value:l})});const i=()=>{const a=l["NotificationsStore"].show({message:t?Object(l["translate"])("SitesManager_WebsiteCreated"):Object(l["translate"])("SitesManager_WebsiteUpdated"),context:"success",id:"websitecreated",type:"transient"});l["NotificationsStore"].scrollToNotification(a),d.removeEditSiteIdParameterFromHash(),this.isSaving=!1,this.editMode=!1,this.$emit("save",{site:this.theSite,settingValues:e.settingValues,isNew:t})},r=()=>Promise.resolve(l["AjaxHelper"].post({method:a},e)).then(e=>{!this.theSite.idsite&&e&&e.value&&(this.theSite.idsite=""+e.value);const t=g.timezones.value.find(e=>e.code===this.theSite.timezone);this.theSite.timezone_name=(null===t||void 0===t?void 0:t.label)||this.theSite.timezone,this.theSite.currency&&(this.theSite.currency_name=b.currencies.value[this.theSite.currency])});if(t)r().then(()=>{i()});else{const e=this.getTriggerPrivacySettingsSavePromise();e.then(()=>r().then(()=>{i()}).catch(()=>{this.isSaving=!1})).catch(()=>{this.isSaving=!1})}},cancelEditSite(e){this.editMode=!1,d.removeEditSiteIdParameterFromHash(),this.$emit("cancelEditSite",{site:e,element:this.$refs.root})},deleteSite(e){l["AjaxHelper"].post({idSite:this.theSite.idsite,module:"API",format:"json",method:"SitesManager.deleteSite"},{passwordConfirmation:e}).then(()=>{this.$emit("delete",this.theSite)})},getMessagesToWarnOnSiteRemoval(){l["AjaxHelper"].post({idSite:this.theSite.idsite,module:"API",format:"json",method:"SitesManager.getMessagesToWarnOnSiteRemoval"}).then(e=>{this.deleteSiteExplanation="",e.length&&(this.deleteSiteExplanation+=e.join("<br>")),this.showRemoveDialog=!0})},getTriggerPrivacySettingsSavePromise(){return new Promise((e,t)=>{const a=this.$watch("triggerSavePrivacySettings",i=>{"done"===i&&(a(),e(!0)),"abort"===i&&(a(),t())},{immediate:!1});this.triggerSavePrivacySettings="save"})}},computed:{availableTypes(){return d.types.value},setupUrl(){const e=this.theSite;let t="",a="";return this.isInternalSetupUrl&&(t=l["MatomoUrl"].stringify({idSite:e.idsite,period:l["MatomoUrl"].parsed.value.period,date:l["MatomoUrl"].parsed.value.date,updated:"false"}),a=-1===this.howToSetupUrl.indexOf("?")?"?":"&"),`${this.howToSetupUrl}${a}${t}`},utcTimeIs(){const e=this.utcTime,t=e=>e.toString().padStart(2,"0"),a=t(e.getHours()),i=t(e.getMinutes()),r=t(e.getSeconds()),n=`${Object(l["format"])(this.utcTime)} ${a}:${i}:${r}`;return Object(l["translate"])("SitesManager_UTCTimeIs",n)},timezones(){return Ae.value},currencies(){return b.currencies.value},currentType(){const e=this.site,t=d.typesById.value[e.type];return t||{name:e.type}},howToSetupUrl(){const e=this.currentType;if(e)return e.howToSetupUrl},isInternalSetupUrl(){const{howToSetupUrl:e}=this;return!!e&&"?"===(""+e).substring(0,1)},removeDialogTitle(){return Object(l["translate"])("SitesManager_DeleteConfirm",`"${this.theSite.name}" (idSite = ${this.theSite.idsite})`)},anonymizeIpComponent(){return this.privacyManagerEnabled?Object(l["useExternalPluginComponent"])("PrivacyManager","AnonymizeIp"):""}}});Be.render=Ge;var Ie=Be;function ze(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class He{constructor(){ze(this,"privateState",Object(n["reactive"])({isLoading:!1,globalSettings:{keepURLFragmentsGlobal:!1,defaultCurrency:"",defaultTimezone:"",excludedIpsGlobal:"",excludedQueryParametersGlobal:"",excludedUserAgentsGlobal:"",excludedReferrersGlobal:"",searchKeywordParametersGlobal:"",searchCategoryParametersGlobal:"",exclusionTypeForQueryParams:""}})),ze(this,"isLoading",Object(n["computed"])(()=>Object(n["readonly"])(this.privateState).isLoading)),ze(this,"globalSettings",Object(n["computed"])(()=>Object(n["readonly"])(this.privateState).globalSettings))}init(){return this.fetchGlobalSettings()}saveGlobalSettings(e){return this.privateState.isLoading=!0,l["AjaxHelper"].post({module:"SitesManager",format:"json",action:"setGlobalSettings"},e,{withTokenInUrl:!0}).finally(()=>{this.privateState.isLoading=!1})}fetchGlobalSettings(){this.privateState.isLoading=!0,l["AjaxHelper"].fetch({module:"SitesManager",action:"getGlobalSettings"}).then(e=>{this.privateState.globalSettings=Object.assign(Object.assign({},e),{},{excludedIpsGlobal:e.excludedIpsGlobal||"",excludedQueryParametersGlobal:e.excludedQueryParametersGlobal||"",excludedUserAgentsGlobal:e.excludedUserAgentsGlobal||"",excludedReferrersGlobal:e.excludedReferrersGlobal||"",searchKeywordParametersGlobal:e.searchKeywordParametersGlobal||"",searchCategoryParametersGlobal:e.searchCategoryParametersGlobal||"",exclusionTypeForQueryParams:e.exclusionTypeForQueryParams||""})}).finally(()=>{this.privateState.isLoading=!1})}}var Fe=new He,Qe=Object(n["defineComponent"])({props:{rollUpEnabled:Boolean,privacyManagerEnabled:Boolean},components:{ButtonBar:$,ContentBlock:l["ContentBlock"],EnrichedHeadline:l["EnrichedHeadline"],MatomoDialog:l["MatomoDialog"],MatomoLoader:l["MatomoLoader"],SiteFields:Ie},directives:{ContentIntro:l["ContentIntro"]},data(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds());return{pageSize:10,currentPage:0,showAddSiteDialog:!1,searchTerm:"",activeSearchTerm:"",fetchedSites:[],isLoadingInitialEntities:!1,utcTime:t,totalNumberOfSites:null,isSiteBeingEdited:!1,fetchLimitedSitesAbortController:null}},created(){g.init(),d.init(),Fe.init(),this.isLoadingInitialEntities=!0,Promise.all([d.fetchAvailableTypes(),this.fetchLimitedSitesWithAdminAccess(),this.getTotalNumberOfSites()]).then(()=>{this.triggerAddSiteIfRequested()}).finally(()=>{this.isLoadingInitialEntities=!1}),Object(n["watch"])(()=>l["MatomoUrl"].hashQuery.value,()=>{this.checkGlobalSettingsHash()})},computed:{sites(){const e=this.fetchedSites.filter(e=>!e.idsite).length;return this.fetchedSites.slice(0,this.pageSize+e)},isLoading(){return!!this.fetchLimitedSitesAbortController||this.isLoadingInitialEntities||null===this.totalNumberOfSites||d.isLoading.value||g.isLoading.value||Fe.isLoading.value},availableTypes(){return d.types.value},timezoneSupportEnabled(){return g.timezoneSupportEnabled.value},globalSettings(){return Fe.globalSettings.value},headlineText(){return Object(l["translate"])("SitesManager_XManagement",this.availableTypes.length>1?Object(l["translate"])("General_Measurables"):Object(l["translate"])("SitesManager_Sites"))},subheaderText(){const e=Object(l["translate"])("SitesManager_ChooseMeasurableTypeSubheader"),t=this.rollUpEnabled?Object(l["translate"])("SitesManager_ChooseMeasurableTypeSubheaderRollUp"):"";return`${e} ${t}`.trim()},mainDescription(){return Object(l["translate"])("SitesManager_YouCurrentlyHaveAccessToNWebsites",`<strong>${this.totalNumberOfSites}</strong>`)},hasSuperUserAccess(){return l["Matomo"].hasSuperUserAccess},superUserAccessMessage(){return Object(l["translate"])("SitesManager_SuperUserAccessCan","<a href='#globalSettings'>","</a>")},hasPrev(){return this.currentPage>=1},hasNext(){return this.fetchedSites.filter(e=>!!e.idsite).length>=this.pageSize+1},offsetStart(){return this.currentPage*this.pageSize+1},offsetEnd(){return this.offsetStart+this.sites.filter(e=>!!e.idsite).length-1}},methods:{checkGlobalSettingsHash(){const e=l["MatomoUrl"].hashQuery.value;!l["Matomo"].hasSuperUserAccess||"globalSettings"!==e&&"/globalSettings"!==e||l["MatomoUrl"].updateLocation(Object.assign(Object.assign({},l["MatomoUrl"].urlParsed.value),{},{action:"globalSettings"}))},addNewEntity(){this.availableTypes.length>1?this.showAddSiteDialog=!0:1===this.availableTypes.length&&this.addSite(this.availableTypes[0].id)},addSite(e){let t=e;const a={isAllowed:!0,measurableType:t};l["Matomo"].postEvent("SitesManager.initAddSite",a),a&&!a.isAllowed||(t||(t="website"),this.fetchedSites.unshift({type:t}),this.isSiteBeingEdited=!0)},afterCancelEdit({site:e,element:t}){this.isSiteBeingEdited=!1,e.idsite?t.scrollIntoView():this.fetchedSites=this.fetchedSites.filter(e=>!!e.idsite)},fetchLimitedSitesWithAdminAccess(e=""){this.fetchLimitedSitesAbortController&&this.fetchLimitedSitesAbortController.abort(),this.fetchLimitedSitesAbortController=new AbortController;const t=this.pageSize+1,a=this.currentPage*this.pageSize,i={method:"SitesManager.getSitesWithAdminAccess",fetchAliasUrls:1,limit:t+a,filter_offset:a,filter_limit:t};return e&&(i.pattern=e),l["AjaxHelper"].fetch(i).then(e=>{this.fetchedSites=e||[]}).then(t=>(this.activeSearchTerm=e,t)).finally(()=>{this.fetchLimitedSitesAbortController=null})},getTotalNumberOfSites(){return l["AjaxHelper"].fetch({method:"SitesManager.getSitesIdWithAdminAccess",filter_limit:"-1"}).then(e=>{this.totalNumberOfSites=e.length})},triggerAddSiteIfRequested(){const e=d.getEditSiteIdParameter(),t=l["MatomoUrl"].urlParsed.value.showaddsite;"1"===t?this.addNewEntity():e&&(this.searchTerm=e,this.fetchLimitedSitesWithAdminAccess(this.searchTerm))},previousPage(){this.currentPage=Math.max(0,this.currentPage-1),this.fetchLimitedSitesWithAdminAccess(this.activeSearchTerm)},nextPage(){this.currentPage=Math.max(0,this.currentPage+1),this.fetchLimitedSitesWithAdminAccess(this.activeSearchTerm)},searchSites(){this.currentPage=0,this.fetchLimitedSitesWithAdminAccess(this.searchTerm)},afterDelete(e){let t={showaddsite:0};if(l["MatomoUrl"].urlParsed.value.idSite===""+e.idsite){const a=this.sites.find(t=>t.idsite!==e.idsite);a&&(t=Object.assign(Object.assign({},t),{},{idSite:a.idsite}))}l["Matomo"].helper.redirect(t)},afterSave(e,t,a,i){const r=["excluded_ips","excluded_parameters","excluded_user_agents","sitesearch_keyword_parameters","sitesearch_category_parameters"],n=Object.assign({},e);Object.values(t).forEach(e=>{e.forEach(e=>{"urls"===e.name?n.alias_urls=e.value:-1!==r.indexOf(e.name)?n[e.name]=e.value.join(", "):n[e.name]=e.value})}),this.fetchedSites[a]=n,i&&null!==this.totalNumberOfSites&&(this.totalNumberOfSites+=1),this.isSiteBeingEdited=!1}}});Qe.render=k;var Re=Qe;const $e={class:"SitesManager"},We=Object(n["createElementVNode"])("a",{name:"globalSettings",id:"globalSettings"},null,-1),Ke={id:"excludedIpsGlobalHelp",class:"inline-help-node"},qe=Object(n["createElementVNode"])("br",null,null,-1),Ye=Object(n["createElementVNode"])("br",null,null,-1),Xe=["innerHTML"],Je={id:"excludedUserAgentsGlobalHelp",class:"inline-help-node"},Ze=Object(n["createElementVNode"])("br",null,null,-1),et=Object(n["createElementVNode"])("br",null,null,-1),tt={id:"excludedReferrersGlobalHelp",class:"inline-help-node"},at=Object(n["createElementVNode"])("br",null,null,-1),it=Object(n["createElementVNode"])("br",null,null,-1),rt=Object(n["createElementVNode"])("br",null,null,-1),nt=Object(n["createElementVNode"])("br",null,null,-1),lt=Object(n["createElementVNode"])("br",null,null,-1),st={id:"timezoneHelp",class:"inline-help-node"},ot={key:0},ct=Object(n["createElementVNode"])("br",null,null,-1),dt=Object(n["createElementVNode"])("br",null,null,-1),ut={id:"keepURLFragmentsHelp",class:"inline-help-node"},mt=["innerHTML"],bt={class:"alert alert-info"};function ht(e,t,a,i,r,l){const s=Object(n["resolveComponent"])("Field"),o=Object(n["resolveComponent"])("ExcludeQueryParameterSettings"),c=Object(n["resolveComponent"])("SaveButton"),d=Object(n["resolveComponent"])("ContentBlock");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",$e,[Object(n["withDirectives"])(Object(n["createVNode"])(d,{"content-title":e.translate("SitesManager_GlobalWebsitesSettings")},{default:Object(n["withCtx"])(()=>[We,Object(n["createElementVNode"])("div",Ke,[Object(n["createElementVNode"])("div",null,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_HelpExcludedIpAddresses","1.2.3.4/24","1.2.3.*","1.2.*.*"))+" ",1),qe,Ye,Object(n["createElementVNode"])("span",{innerHTML:e.$sanitize(e.yourCurrentIpAddressIs)},null,8,Xe)])]),Object(n["createElementVNode"])("div",Je,[Object(n["createElementVNode"])("div",null,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp1"))+" ",1),Ze,et,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_GlobalListExcludedUserAgents_Desc"))+" "+Object(n["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp2"))+" "+Object(n["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp3","/bot|spider|crawl|scanner/i")),1)])]),Object(n["createElementVNode"])("div",tt,[Object(n["createElementVNode"])("div",null,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_ExcludedReferrersHelp"))+" ",1),at,it,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_ExcludedReferrersHelpDetails"))+" ",1),rt,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_ExcludedReferrersHelpExamples","www.example.org","http://example.org/mypath","https://www.example.org/?param=1","https://sub.example.org/"))+" ",1),nt,lt,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_ExcludedReferrersHelpSubDomains",".sub.example.org","http://sub.example.org/mypath","https://new.sub.example.org/")),1)])]),Object(n["createElementVNode"])("div",st,[Object(n["createElementVNode"])("div",null,[e.timezoneSupportEnabled?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",ot,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_AdvancedTimezoneSupportNotFound"))+" ",1),ct])),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_UTCTimeIs",e.utcTimeDate))+" ",1),dt,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_ChangingYourTimezoneWillOnlyAffectDataForward")),1)])]),Object(n["createElementVNode"])("div",ut,[Object(n["createElementVNode"])("div",{innerHTML:e.$sanitize(e.keepUrlFragmentHelp)},null,8,mt),Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.translate("SitesManager_KeepURLFragmentsHelp2")),1)]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"textarea",name:"excludedIpsGlobal","var-type":"array",modelValue:e.excludedIpsGlobal,"onUpdate:modelValue":t[0]||(t[0]=t=>e.excludedIpsGlobal=t),title:e.translate("SitesManager_ListOfIpsToBeExcludedOnAllWebsites"),introduction:e.translate("SitesManager_GlobalListExcludedIps"),"inline-help":"#excludedIpsGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(n["createVNode"])(o,{exclusionTypeForQueryParams:e.exclusionTypeForQueryParams,"onUpdate:exclusionTypeForQueryParams":t[1]||(t[1]=t=>e.exclusionTypeForQueryParams=t),excludedQueryParametersGlobal:e.excludedQueryParametersGlobal,"onUpdate:excludedQueryParametersGlobal":t[2]||(t[2]=t=>e.excludedQueryParametersGlobal=t),commonSensitiveQueryParams:e.commonSensitiveQueryParams},null,8,["exclusionTypeForQueryParams","excludedQueryParametersGlobal","commonSensitiveQueryParams"]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"textarea",name:"excludedUserAgentsGlobal","var-type":"array",modelValue:e.excludedUserAgentsGlobal,"onUpdate:modelValue":t[3]||(t[3]=t=>e.excludedUserAgentsGlobal=t),title:e.translate("SitesManager_GlobalListExcludedUserAgents_Desc"),introduction:e.translate("SitesManager_GlobalListExcludedUserAgents"),"inline-help":"#excludedUserAgentsGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"textarea",name:"excludedReferrersGlobal","var-type":"array",modelValue:e.excludedReferrersGlobal,"onUpdate:modelValue":t[4]||(t[4]=t=>e.excludedReferrersGlobal=t),title:e.translate("SitesManager_GlobalListExcludedReferrersDesc"),introduction:e.translate("SitesManager_GlobalListExcludedReferrers"),"inline-help":"#excludedReferrersGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"checkbox",name:"keepURLFragmentsGlobal",modelValue:e.keepURLFragmentsGlobal,"onUpdate:modelValue":t[5]||(t[5]=t=>e.keepURLFragmentsGlobal=t),title:e.translate("SitesManager_KeepURLFragmentsLong"),introduction:e.translate("SitesManager_KeepURLFragments"),"inline-help":"#keepURLFragmentsHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(n["createElementVNode"])("h3",null,Object(n["toDisplayString"])(e.translate("SitesManager_TrackingSiteSearch")),1),Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.translate("SitesManager_SiteSearchUse")),1),Object(n["createElementVNode"])("div",bt,Object(n["toDisplayString"])(e.translate("SitesManager_SearchParametersNote"))+" "+Object(n["toDisplayString"])(e.translate("SitesManager_SearchParametersNote2")),1),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"text",name:"searchKeywordParametersGlobal","var-type":"array",modelValue:e.searchKeywordParametersGlobal,"onUpdate:modelValue":t[6]||(t[6]=t=>e.searchKeywordParametersGlobal=t),title:e.translate("SitesManager_SearchKeywordLabel"),"inline-help":e.translate("SitesManager_SearchKeywordParametersDesc"),disabled:e.isLoading},null,8,["modelValue","title","inline-help","disabled"])]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"text",name:"searchCategoryParametersGlobal","var-type":"array",modelValue:e.searchCategoryParametersGlobal,"onUpdate:modelValue":t[7]||(t[7]=t=>e.searchCategoryParametersGlobal=t),title:e.translate("SitesManager_SearchCategoryLabel"),"inline-help":e.searchCategoryParamsInlineHelp,disabled:e.isLoading},null,8,["modelValue","title","inline-help","disabled"])]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"select",name:"defaultTimezone",options:e.timezoneOptions,title:e.translate("SitesManager_SelectDefaultTimezone"),introduction:e.translate("SitesManager_DefaultTimezoneForNewWebsites"),"inline-help":"#timezoneHelp",disabled:e.isLoading,modelValue:e.defaultTimezone,"onUpdate:modelValue":t[8]||(t[8]=t=>e.defaultTimezone=t)},null,8,["options","title","introduction","disabled","modelValue"])]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"select",name:"defaultCurrency",modelValue:e.defaultCurrency,"onUpdate:modelValue":t[9]||(t[9]=t=>e.defaultCurrency=t),options:e.currencies,title:e.translate("SitesManager_SelectDefaultCurrency"),introduction:e.translate("SitesManager_DefaultCurrencyForNewWebsites"),"inline-help":e.translate("SitesManager_CurrencySymbolWillBeUsedForGoals"),disabled:e.isLoading},null,8,["modelValue","options","title","introduction","inline-help","disabled"])]),Object(n["createVNode"])(c,{saving:e.isSaving,onConfirm:t[10]||(t[10]=t=>e.saveGlobalSettings())},null,8,["saving"])]),_:1},8,["content-title"]),[[n["vShow"],e.hasSuperUserAccess]])])}const pt={class:"siteManagerGlobalExcludedUrlParameters"},gt={id:"excludedQueryParametersGlobalHelp",class:"inline-help-node"},St={id:"excludedQueryParametersGlobalExclusionTypeHelp",class:"inline-help-node"},Ot=Object(n["createElementVNode"])("span",{class:"icon-chevron-down"},null,-1),jt=Object(n["createElementVNode"])("span",{class:"icon-chevron-up"},null,-1),yt={key:0},vt=Object(n["createElementVNode"])("br",null,null,-1),ft=Object(n["createElementVNode"])("br",null,null,-1),Et=Object(n["createElementVNode"])("br",null,null,-1),xt=Object(n["createElementVNode"])("br",null,null,-1),Nt=["value"];function Vt(e,t,a,i,r,l){const s=Object(n["resolveComponent"])("Field");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",pt,[Object(n["createElementVNode"])("div",gt,[Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.translate("SitesManager_ListOfQueryParametersToExclude","/^sess.*|.*[dD]ate$/")),1)]),Object(n["createElementVNode"])("div",St,[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.translate("SitesManager_ExclusionTypeDescriptionCommonSessionParameters")),513),[[n["vShow"],"common_session_parameters"===e.localExclusionTypeForQueryParams]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",null,[Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.translate("SitesManager_ExclusionTypeDescriptionMatomoRecommendedPII")),1),Object(n["createElementVNode"])("div",null,[e.showListOfCommonExclusions?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:"javascript:;",onClick:t[0]||(t[0]=Object(n["withModifiers"])(t=>e.showListOfCommonExclusions=!0,["prevent"]))},[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_ExclusionViewListLink"))+" ",1),Ot])),e.showListOfCommonExclusions?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:1,href:"javascript:;",onClick:t[1]||(t[1]=Object(n["withModifiers"])(t=>e.showListOfCommonExclusions=!1,["prevent"]))},[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_ExclusionViewListLink"))+" ",1),jt])):Object(n["createCommentVNode"])("",!0)]),e.showListOfCommonExclusions?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",yt,Object(n["toDisplayString"])(e.commonSensitiveQueryParams.join(", ")),1)):Object(n["createCommentVNode"])("",!0),vt,ft,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_MatomoWillAutomaticallyExcludeCommonSessionParametersInAddition","phpsessid, sessionid, ...")),1)],512),[[n["vShow"],"matomo_recommended_pii"===e.localExclusionTypeForQueryParams]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",null,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.translate("SitesManager_ExclusionTypeDescriptionCustom"))+" ",1),Et,xt,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("SitesManager_MatomoWillAutomaticallyExcludeCommonSessionParametersInAddition","phpsessid, sessionid, ...")),1)],512),[[n["vShow"],"custom"===e.localExclusionTypeForQueryParams]])]),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"radio",name:"exclusionType",introduction:e.translate("SitesManager_GlobalListExcludedQueryParameters"),options:e.exclusionTypeOptions,modelValue:e.localExclusionTypeForQueryParams,"onUpdate:modelValue":t[2]||(t[2]=t=>e.localExclusionTypeForQueryParams=t),"inline-help":"#excludedQueryParametersGlobalExclusionTypeHelp"},null,8,["introduction","options","modelValue"])]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(s,{uicontrol:"textarea",name:"excludedQueryParametersGlobal","var-type":"array",class:"limited-height-scrolling-textarea",modelValue:e.localExcludedQueryParametersGlobal,"onUpdate:modelValue":t[3]||(t[3]=t=>e.localExcludedQueryParametersGlobal=t),"model-value":e.localExcludedQueryParametersGlobal.join("\n"),onInput:t[4]||(t[4]=t=>e.onInputExcludedQueryParametersGlobal(t.target.value)),title:e.translate("SitesManager_ListOfQueryParametersToBeExcludedOnAllWebsites"),"inline-help":"#excludedQueryParametersGlobalHelp"},null,8,["modelValue","model-value","title"]),Object(n["createElementVNode"])("input",{type:"button",onClick:t[5]||(t[5]=t=>e.addCommonPIIQueryParams()),class:"btn",value:e.translate("SitesManager_AddSensibleExclusionsToMyCustomListButtonText")},null,8,Nt)],512),[[n["vShow"],"custom"===e.localExclusionTypeForQueryParams]])])}var Mt=Object(n["defineComponent"])({components:{Field:Le["Field"]},props:{exclusionTypeForQueryParams:{type:String,default:"common_session_parameters"},excludedQueryParametersGlobal:{type:Array,default:()=>[]},commonSensitiveQueryParams:{type:Array,default:()=>[]}},data(){return{localExclusionTypeForQueryParams:this.exclusionTypeForQueryParams,localExcludedQueryParametersGlobal:this.excludedQueryParametersGlobal,exclusionTypeOptions:[{value:Object(l["translate"])("SitesManager_ExclusionTypeOptionCommonSessionParameters"),key:"common_session_parameters"},{value:Object(l["translate"])("SitesManager_ExclusionTypeOptionMatomoRecommendedPII"),key:"matomo_recommended_pii"},{value:Object(l["translate"])("SitesManager_ExclusionTypeOptionCustom"),key:"custom"}],showListOfCommonExclusions:!1}},watch:{exclusionTypeForQueryParams:{handler(e){this.localExclusionTypeForQueryParams=e}},localExclusionTypeForQueryParams:{handler(e){this.updateExclusionType(e)},immediate:!0},excludedQueryParametersGlobal:{handler(e){this.localExcludedQueryParametersGlobal=e}}},methods:{updateExclusionType(e){"custom"!==e&&(this.localExcludedQueryParametersGlobal=[],this.onInputExcludedQueryParametersGlobal("")),this.$emit("update:exclusionTypeForQueryParams",e)},onInputExcludedQueryParametersGlobal(e){const t=e.split("\n");this.$emit("update:excludedQueryParametersGlobal",t)},addCommonPIIQueryParams(){let e=this.localExcludedQueryParametersGlobal.filter(e=>!this.commonSensitiveQueryParams.includes(e));e=e.concat(this.commonSensitiveQueryParams),this.localExcludedQueryParametersGlobal=e,this.$emit("update:excludedQueryParametersGlobal",e)}}});Mt.render=Vt;var Tt=Mt,Pt=Object(n["defineComponent"])({components:{ExcludeQueryParameterSettings:Tt,ContentBlock:l["ContentBlock"],Field:Le["Field"],SaveButton:Le["SaveButton"]},props:{commonSensitiveQueryParams:{type:Array,default:()=>[]}},data(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),a=Fe.globalSettings.value;return{currentIpAddress:null,utcTime:t,keepURLFragmentsGlobal:a.keepURLFragmentsGlobal,defaultTimezone:a.defaultTimezone,defaultCurrency:a.defaultCurrency,excludedIpsGlobal:(a.excludedIpsGlobal||"").split(","),excludedQueryParametersGlobal:(a.excludedQueryParametersGlobal||"").split(","),excludedUserAgentsGlobal:(a.excludedUserAgentsGlobal||"").split(","),excludedReferrersGlobal:(a.excludedReferrersGlobal||"").split(","),searchKeywordParametersGlobal:(a.searchKeywordParametersGlobal||"").split(","),searchCategoryParametersGlobal:(a.searchCategoryParametersGlobal||"").split(","),isSaving:!1,exclusionTypeForQueryParams:a.exclusionTypeForQueryParams}},created(){b.init(),g.init(),Fe.init(),Object(n["watch"])(()=>Fe.globalSettings.value,e=>{this.keepURLFragmentsGlobal=e.keepURLFragmentsGlobal,this.defaultTimezone=e.defaultTimezone,this.defaultCurrency=e.defaultCurrency,this.excludedIpsGlobal=(e.excludedIpsGlobal||"").split(","),this.excludedQueryParametersGlobal=(e.excludedQueryParametersGlobal||"").split(","),this.excludedUserAgentsGlobal=(e.excludedUserAgentsGlobal||"").split(","),this.excludedReferrersGlobal=(e.excludedReferrersGlobal||"").split(","),this.searchKeywordParametersGlobal=(e.searchKeywordParametersGlobal||"").split(","),this.searchCategoryParametersGlobal=(e.searchCategoryParametersGlobal||"").split(","),this.exclusionTypeForQueryParams=e.exclusionTypeForQueryParams}),l["AjaxHelper"].fetch({method:"API.getIpFromHeader"}).then(e=>{this.currentIpAddress=e.value})},methods:{saveGlobalSettings(){this.isSaving=!0,Fe.saveGlobalSettings({keepURLFragments:this.keepURLFragmentsGlobal,currency:this.defaultCurrency,timezone:this.defaultTimezone,excludedIps:this.excludedIpsGlobal.join(","),excludedQueryParameters:this.excludedQueryParametersGlobal.join(","),excludedUserAgents:this.excludedUserAgentsGlobal.join(","),excludedReferrers:this.excludedReferrersGlobal.join(","),searchKeywordParameters:this.searchKeywordParametersGlobal.join(","),searchCategoryParameters:this.searchCategoryParametersGlobal.join(","),exclusionTypeForQueryParams:this.exclusionTypeForQueryParams}).then(()=>{l["Matomo"].helper.redirect({showaddsite:!1})}).finally(()=>{this.isSaving=!1})}},computed:{isLoading(){return Fe.isLoading.value||g.isLoading.value||b.isLoading.value},timezones(){return g.timezones.value},timezoneOptions(){return this.timezones.map(({group:e,label:t,code:a})=>({group:e,key:t,value:a}))},currencies(){return b.currencies.value},hasSuperUserAccess(){return l["Matomo"].hasSuperUserAccess},yourCurrentIpAddressIs(){return Object(l["translate"])("SitesManager_YourCurrentIpAddressIs",`<i>${this.currentIpAddress}</i>`)},timezoneSupportEnabled(){return g.timezoneSupportEnabled.value},utcTimeDate(){const{utcTime:e}=this,t=e=>e.toString().padStart(2,"0"),a=t(e.getHours()),i=t(e.getMinutes()),r=t(e.getSeconds());return`${Object(l["format"])(this.utcTime)} ${a}:${i}:${r}`},keepUrlFragmentHelp(){return Object(l["translate"])("SitesManager_KeepURLFragmentsHelp","<em>#</em>","<em>example.org/index.html#first_section</em>","<em>example.org/index.html</em>")},searchCategoryParamsInlineHelp(){const e=[Object(l["translate"])("Goals_Optional"),Object(l["translate"])("SitesManager_SearchCategoryDesc"),Object(l["translate"])("SitesManager_SearchCategoryParametersDesc")];return e.join(" ")}}});Pt.render=ht;var Ct=Pt;const wt=Object(n["createElementVNode"])("span",{class:"icon-chevron-left"},null,-1),Dt={id:"start-tracking-data-header"},kt={key:0,class:"row",id:"start-tracking-detection"},_t=["src","alt"],Gt=["href"],Lt={class:"row",id:"start-tracking-method-list"},At=Object(n["createElementVNode"])("span",{class:"icon-search"},null,-1),Ut=["href","onClick"],Bt=["src"],It={class:"list-entry-text"},zt={id:"start-tracking-skip"},Ht=["href"],Ft=["data-method"],Qt=["src","alt"];function Rt(e,t,a,i,r,l){const s=Object(n["resolveComponent"])("VueEntryContainer"),o=Object(n["resolveComponent"])("ActivityIndicator");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[e.showMethodDetails?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,id:"start-tracking-back",onClick:t[0]||(t[0]=Object(n["withModifiers"])(t=>{e.showOverview()},["prevent"]))},[wt,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("Mobile_NavigationBack")),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("h1",Dt,Object(n["toDisplayString"])(e.headline),1),Object(n["createVNode"])(s,{id:"start-tracking-cta",html:e.ctaContent},null,8,["html"]),Object(n["createVNode"])(o,{"loading-message":e.translate("SitesManager_DetectingYourSite")+"…",loading:e.loading},null,8,["loading-message","loading"]),e.loading||e.showMethodDetails?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:1},[e.recommendedMethod?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",kt,[Object(n["createElementVNode"])("img",{src:e.recommendedMethod.icon,alt:e.recommendedMethod.name+" logo"},null,8,_t),Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.recommendedMethod.recommendationTitle),1),Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.recommendedMethod.recommendationText),1),Object(n["createElementVNode"])("a",{href:"#"+e.recommendedMethod.id.toLowerCase(),class:"btn",id:"showMethod",onClick:t[1]||(t[1]=Object(n["withModifiers"])(t=>e.showMethod(e.recommendedMethod.id),["prevent"]))},Object(n["toDisplayString"])(e.recommendedMethod.recommendationButton),9,Gt)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",Lt,[At,Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataOtherInstallMethods")),1),Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataOtherInstallMethodsIntro")),1),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.trackingMethods,t=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{class:"list-entry",key:t.id},[Object(n["createElementVNode"])("a",{href:"#"+t.id.toLowerCase(),onClick:Object(n["withModifiers"])(a=>e.showMethod(t.id),["prevent"])},[t.icon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,src:t.icon,class:"list-entry-icon"},null,8,Bt)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",It,Object(n["toDisplayString"])(t.name),1)],8,Ut)]))),128))])]),Object(n["createElementVNode"])("div",zt,[Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataNotYetReady")),1),Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataTemporarilyHidePage")),1),Object(n["createElementVNode"])("a",{href:e.ignoreSitesWithoutDataLink,class:"ignoreSitesWithoutData"},Object(n["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataHidePageForHour")),9,Ht)])],64)),e.showMethodDetails?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:2,id:"start-tracking-details","data-method":e.showMethodDetails.id},[Object(n["createElementVNode"])("img",{src:e.showMethodDetails.icon,alt:e.showMethodDetails.name+" logo"},null,8,Qt),Object(n["createVNode"])(s,{html:e.showMethodDetails.content},null,8,["html"])],8,Ft)):Object(n["createCommentVNode"])("",!0)])}var $t=Object(n["defineComponent"])({props:{ctaContent:String},components:{ActivityIndicator:l["ActivityIndicator"],VueEntryContainer:l["VueEntryContainer"]},data(){return{loading:!0,updateCheckInterval:1e3,currentInterval:1e3,maxInterval:3e4,showMethodDetails:null,recommendedMethod:null,trackingMethods:[]}},created(){const e={module:"SitesManager",action:"getTrackingMethodsForSite"};l["AjaxHelper"].fetch(e).then(e=>{this.trackingMethods=e.trackingMethods,this.recommendedMethod=e.recommendedMethod,this.loading=!1,Object(n["watch"])(()=>l["MatomoUrl"].hashParsed.value.activeTab,e=>{this.showMethodDetails=this.findTrackingMethod(e)}),l["MatomoUrl"].hashParsed.value.activeTab&&(this.showMethodDetails=this.findTrackingMethod(l["MatomoUrl"].hashParsed.value.activeTab)),this.checkIfSiteHasData()})},methods:{findTrackingMethod(e){if(this.recommendedMethod&&e&&this.recommendedMethod.id.toLowerCase()===e.toLowerCase())return this.recommendedMethod;let t=null;return Object.entries(this.trackingMethods).forEach(([,a])=>{e&&a.id.toLowerCase()===e.toLowerCase()&&(t=a)}),t},showMethod(e){l["MatomoUrl"].updateHash(Object.assign(Object.assign({},l["MatomoUrl"].hashParsed.value),{},{activeTab:e.toLowerCase()}))},showOverview(){l["MatomoUrl"].updateHash(Object.assign(Object.assign({},l["MatomoUrl"].hashParsed.value),{},{activeTab:null}))},checkIfSiteHasData(){const e={method:"Live.getMostRecentVisitsDateTime",date:"today",period:"day",idSite:l["Matomo"].idSite},t={createErrorNotification:!1};l["AjaxHelper"].fetch(e,t).then(e=>{e&&""!==e.value?window.broadcast.propagateNewPage("date=today"):(window.setTimeout(this.checkIfSiteHasData,this.currentInterval),this.currentInterval=Math.min(this.currentInterval+this.updateCheckInterval,this.maxInterval))}).catch(()=>{})}},computed:{ignoreSitesWithoutDataLink(){return"?"+l["MatomoUrl"].stringify(Object.assign(Object.assign({},l["MatomoUrl"].urlParsed.value),{},{module:"SitesManager",action:"ignoreNoDataMessage"}))},headline(){return this.showMethodDetails&&this.showMethodDetails.name?99===this.showMethodDetails.type?this.showMethodDetails.name:Object(l["translate"])("SitesManager_SiteWithoutDataInstallWithX",this.showMethodDetails.name):Object(l["translate"])("SitesManager_SiteWithoutDataChooseTrackingMethod")}}});$t.render=Rt;var Wt=$t;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["Installation"]=t(require("CoreHome"),require("vue")):e["Installation"]=t(e["CoreHome"],e["Vue"])})("undefined"!==typeof self?self:this,(function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Installation/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"SystemCheckPage",(function(){return A})),n.d(t,"SystemCheck",(function(){return ce})),"undefined"!==typeof window){var r=window.document.currentScript,o=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var l=n("8bbf");const a={key:0,class:"alert alert-danger"},c=["innerHTML"],s={key:1,class:"alert alert-warning"},i={key:2,class:"alert alert-success"};function p(e,t,n,r,o,p){const m=Object(l["resolveComponent"])("SystemCheckSection"),y=Object(l["resolveComponent"])("ContentBlock");return Object(l["openBlock"])(),Object(l["createBlock"])(y,{"content-title":e.translate("Installation_SystemCheck"),feature:"true"},{default:Object(l["withCtx"])(()=>[e.hasErrors?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",a,[Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize(e.thereWereErrorsText)},null,8,c),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("Installation_SeeBelowForMoreInfo")),1)])):e.hasWarnings?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",s,Object(l["toDisplayString"])(e.translate("Installation_SystemCheckSummaryThereWereWarnings"))+" "+Object(l["toDisplayString"])(e.translate("Installation_SeeBelowForMoreInfo")),1)):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",i,Object(l["toDisplayString"])(e.translate("Installation_SystemCheckSummaryNoProblems")),1)),Object(l["createVNode"])(m,{"error-type":e.errorType,"warning-type":e.warningType,"informational-type":e.informationalType,"system-check-info":e.systemCheckInfo,"mandatory-results":e.mandatoryResults,"optional-results":e.optionalResults,"informational-results":e.informationalResults,"is-installation":e.isInstallation},null,8,["error-type","warning-type","informational-type","system-check-info","mandatory-results","optional-results","informational-results","is-installation"])]),_:1},8,["content-title"])}var m=n("19dc");const y=Object(l["createElementVNode"])("br",null,null,-1),u=Object(l["createElementVNode"])("br",null,null,-1),d=["innerHTML"],b={class:"entityTable system-check",id:"systemCheckRequired"},j={class:"entityTable system-check",id:"systemCheckOptional"},O={class:"entityTable system-check",id:"systemCheckInformational"};function f(e,t,n,r,o,a){const c=Object(l["resolveComponent"])("DiagnosticTable"),s=Object(l["resolveDirective"])("content-table");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createElementVNode"])("p",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("Installation_CopyBelowInfoForSupport"))+" ",1),y,Object(l["createTextVNode"])(),u,Object(l["createElementVNode"])("a",{href:"",onClick:t[0]||(t[0]=Object(l["withModifiers"])(t=>e.copyInfo(),["prevent"])),class:"btn",style:{"margin-right":"3.5px"}},Object(l["toDisplayString"])(e.translate("Installation_CopySystemCheck")),1),Object(l["createElementVNode"])("a",{href:"",onClick:t[1]||(t[1]=Object(l["withModifiers"])(t=>e.downloadInfo(),["prevent"])),class:"btn"},Object(l["toDisplayString"])(e.translate("Installation_DownloadSystemCheck")),1)]),Object(l["createElementVNode"])("div",null,[Object(l["createElementVNode"])("textarea",{style:{width:"100%",height:"200px"},readonly:"",id:"matomo_system_check_info",ref:"systemCheckInfo",innerHTML:e.$sanitize(e.systemCheckInfo)},null,8,d),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("table",b,[Object(l["createElementVNode"])("tbody",null,[Object(l["createVNode"])(c,{results:e.mandatoryResults,"informational-type":e.informationalType,"warning-type":e.warningType,"error-type":e.errorType},null,8,["results","informational-type","warning-type","error-type"])])])),[[s,{off:e.isInstallation}]]),Object(l["createElementVNode"])("h3",null,Object(l["toDisplayString"])(e.translate("Installation_Optional")),1),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("table",j,[Object(l["createElementVNode"])("tbody",null,[Object(l["createVNode"])(c,{results:e.optionalResults,"informational-type":e.informationalType,"warning-type":e.warningType,"error-type":e.errorType},null,8,["results","informational-type","warning-type","error-type"])])])),[[s,{off:e.isInstallation}]]),Object(l["createElementVNode"])("h3",null,Object(l["toDisplayString"])(e.translate("Installation_InformationalResults")),1),Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("table",O,[Object(l["createElementVNode"])("tbody",null,[Object(l["createVNode"])(c,{results:e.informationalResults,"informational-type":e.informationalType,"warning-type":e.warningType,"error-type":e.errorType},null,8,["results","informational-type","warning-type","error-type"])])])),[[s,{off:e.isInstallation}]])])],64)}const k=["innerHTML"],g={key:0},h=Object(l["createElementVNode"])("span",{class:"icon-error"},null,-1),S=["innerHTML"],E={key:1},C=Object(l["createElementVNode"])("span",{class:"icon-warning"},null,-1),T=["innerHTML"],N={key:2},V=Object(l["createElementVNode"])("span",{class:"icon-info"},null,-1),B=["innerHTML"],w={key:3},v=Object(l["createElementVNode"])("span",{class:"icon-ok"},null,-1),I=["innerHTML"],q=Object(l["createElementVNode"])("br",null,null,-1),x={key:0},_=["innerHTML"];function M(e,t,n,r,o,a){const c=Object(l["resolveComponent"])("Passthrough");return Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.results,(t,n)=>(Object(l["openBlock"])(),Object(l["createBlock"])(c,{key:n},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("td",{innerHTML:e.$sanitize(t.label)},null,8,k),Object(l["createElementVNode"])("td",null,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t.items,(t,n)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",{key:n},["error"===t.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",g,[h,Object(l["createElementVNode"])("span",{class:"err",innerHTML:e.$sanitize("string"!==typeof t.comment?"":t.comment)},null,8,S)])):"warning"===t.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",E,[C,Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize("string"!==typeof t.comment?"":t.comment)},null,8,T)])):"informational"===t.status?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",N,[V,Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize("string"!==typeof t.comment?"":t.comment)},null,8,B)])):(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",w,[v,Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize("string"!==typeof t.comment?"":t.comment)},null,8,I)])),q]))),128))])]),t.longErrorMessage?(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",x,[Object(l["createElementVNode"])("td",{colspan:"2",class:"error",style:{"font-size":"small"},innerHTML:e.$sanitize(t.longErrorMessage)},null,8,_)])):Object(l["createCommentVNode"])("",!0)]),_:2},1024))),128)}var D=Object(l["defineComponent"])({props:{errorType:{type:String,required:!0},warningType:{type:String,required:!0},informationalType:{type:String,required:!0},results:{type:Array,required:!0}},components:{Passthrough:m["Passthrough"]}});D.render=M;var L=D;const{$:R}=window;var H=Object(l["defineComponent"])({props:{errorType:{type:String,required:!0},warningType:{type:String,required:!0},informationalType:{type:String,required:!0},systemCheckInfo:{type:String,required:!0},mandatoryResults:{type:Array,required:!0},optionalResults:{type:Array,required:!0},informationalResults:{type:Array,required:!0},isInstallation:Boolean},components:{DiagnosticTable:L},directives:{ContentTable:m["ContentTable"]},methods:{copyInfo(){const e=this.$refs.systemCheckInfo;e.select(),document.execCommand("copy"),R(e).effect("highlight",{},600)},downloadInfo(){const e=this.$refs.systemCheckInfo;m["Matomo"].helper.sendContentAsDownload("matomo_system_check.txt",e.innerHTML)}}});H.render=f;var $=H,P=Object(l["defineComponent"])({props:{errorType:{type:String,required:!0},warningType:{type:String,required:!0},informationalType:{type:String,required:!0},systemCheckInfo:{type:String,required:!0},mandatoryResults:{type:Array,required:!0},optionalResults:{type:Array,required:!0},informationalResults:{type:Array,required:!0},isInstallation:Boolean,hasErrors:Boolean,hasWarnings:Boolean},components:{ContentBlock:m["ContentBlock"],SystemCheckSection:$},computed:{thereWereErrorsText(){return Object(m["translate"])("Installation_SystemCheckSummaryThereWereErrors","<strong>","</strong>","<strong>","</strong>")}}});P.render=p;var A=P;const z={key:0},W=Object(l["createElementVNode"])("br",{style:{clear:"both"}},null,-1),F={key:1},G={key:0},U=Object(l["createElementVNode"])("span",{class:"icon-export"},null,-1),J=["href"];function K(e,t,n,r,o,a){const c=Object(l["resolveComponent"])("SystemCheckLegend"),s=Object(l["resolveComponent"])("SystemCheckSection");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[e.showNextStep?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",z,[Object(l["createVNode"])(c,{url:e.systemCheckLegendUrl},null,8,["url"]),W])),Object(l["createElementVNode"])("h2",null,Object(l["toDisplayString"])(e.translate("Installation_SystemCheck")),1),Object(l["createVNode"])(s,{"error-type":e.errorType,"warning-type":e.warningType,"informational-type":e.informationalType,"system-check-info":e.systemCheckInfo,"mandatory-results":e.mandatoryResults,"optional-results":e.optionalResults,"informational-results":e.informationalResults,"is-installation":e.isInstallation},null,8,["error-type","warning-type","informational-type","system-check-info","mandatory-results","optional-results","informational-results","is-installation"]),e.showNextStep?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",F,[e.showNextStep?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("p",G,[U,Object(l["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink("https://matomo.org/docs/requirements/")},Object(l["toDisplayString"])(e.translate("Installation_Requirements")),9,J)])),Object(l["createVNode"])(c,{url:e.systemCheckLegendUrl},null,8,["url"])]))])}const Q={class:"system-check-legend"},X=Object(l["createElementVNode"])("span",{class:"icon-ok"},null,-1),Y=Object(l["createElementVNode"])("span",{class:"icon-warning"},null,-1),Z=Object(l["createElementVNode"])("span",{class:"icon-error"},null,-1),ee={class:"next-step"},te=["href"];function ne(e,t,n,r,o,a){return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createElementVNode"])("div",Q,[Object(l["createElementVNode"])("h2",null,Object(l["toDisplayString"])(e.translate("Installation_Legend")),1),Object(l["createElementVNode"])("p",null,[X,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_Ok")),1)]),Object(l["createElementVNode"])("p",null,[Y,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_Warning"))+": "+Object(l["toDisplayString"])(e.translate("Installation_SystemCheckWarning")),1)]),Object(l["createElementVNode"])("p",null,[Z,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_Error"))+": "+Object(l["toDisplayString"])(e.translate("Installation_SystemCheckError")),1)])]),Object(l["createElementVNode"])("p",ee,[Object(l["createElementVNode"])("a",{href:e.url},Object(l["toDisplayString"])(e.translate("General_RefreshPage"))+" »",9,te)])],64)}var re=Object(l["defineComponent"])({props:{url:{type:String,required:!0}}});re.render=ne;var oe=re;const{$:le}=window;var ae=Object(l["defineComponent"])({props:{showNextStep:Boolean,systemCheckLegendUrl:{type:String,required:!0},errorType:{type:String,required:!0},warningType:{type:String,required:!0},informationalType:{type:String,required:!0},systemCheckInfo:{type:String,required:!0},mandatoryResults:{type:Array,required:!0},optionalResults:{type:Array,required:!0},informationalResults:{type:Array,required:!0},isInstallation:Boolean},components:{SystemCheckSection:$,SystemCheckLegend:oe},mounted(){if("https:"===document.location.protocol){const e=le("p.next-step a");e.attr("href",e.attr("href")+"&clientProtocol=https")}}});ae.render=K;var ce=ae;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["ScheduledReports"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["ScheduledReports"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,r){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="plugins/ScheduledReports/vue/dist/",r(r.s="fae3")}({"19dc":function(t,r){t.exports=e},"8bbf":function(e,r){e.exports=t},a5a2:function(e,t){e.exports=r},fae3:function(e,t,r){"use strict";if(r.r(t),r.d(t,"ReportParameters",(function(){return d})),r.d(t,"ManageScheduledReport",(function(){return Ke})),"undefined"!==typeof window){var o=window.document.currentScript,n=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(r.p=n[1])}var l=r("8bbf");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */const i={key:0};function a(e,t,r,o,n,a){const c=Object(l["resolveComponent"])("Field");return e.report?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",i,[Object(l["createElementVNode"])("div",null,[Object(l["withDirectives"])(Object(l["createVNode"])(c,{uicontrol:"checkbox",name:"report_email_me",introduction:e.translate("ScheduledReports_SendReportTo"),"model-value":e.report.emailMe,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("change","emailMe",t)),title:`${e.translate("ScheduledReports_SentToMe")} (${e.currentUserEmail})`},null,8,["introduction","model-value","title"]),[[l["vShow"],"email"===e.report.type]])]),Object(l["createElementVNode"])("div",null,[Object(l["withDirectives"])(Object(l["createVNode"])(c,{uicontrol:"textarea","var-type":"array","model-value":e.report.additionalEmails,"onUpdate:modelValue":t[1]||(t[1]=t=>e.$emit("change","additionalEmails",t)),title:e.translate("ScheduledReports_AlsoSendReportToTheseEmails")},null,8,["model-value","title"]),[[l["vShow"],"email"===e.report.type]])])])):Object(l["createCommentVNode"])("",!0)}var c=r("a5a2"),p=Object(l["defineComponent"])({props:{report:{type:Object,required:!0},reportType:{type:String,required:!0},defaultDisplayFormat:{type:Number,required:!0},defaultEmailMe:{type:Boolean,required:!0},defaultEvolutionGraph:{type:Boolean,required:!0},currentUserEmail:{type:String,required:!0}},emits:["change"],components:{Field:c["Field"]},setup(e){const{resetReportParametersFunctions:t,updateReportParametersFunctions:r,getReportParametersFunctions:o}=window;t[e.reportType]||(t[e.reportType]=t=>{t.displayFormat=e.defaultDisplayFormat,t.emailMe=e.defaultEmailMe,t.evolutionGraph=e.defaultEvolutionGraph,t.additionalEmails=[]}),r[e.reportType]||(r[e.reportType]=e=>{null!==e&&void 0!==e&&e.parameters&&["displayFormat","emailMe","evolutionGraph","additionalEmails"].forEach(t=>{t in e.parameters&&(e[t]=e.parameters[t])})}),o[e.reportType]||(o[e.reportType]=e=>({displayFormat:e.displayFormat,emailMe:e.emailMe,evolutionGraph:e.evolutionGraph,additionalEmails:e.additionalEmails||[]}))}});p.render=a;var d=p;const s={class:"emailReports",ref:"root"},u={ref:"reportSentSuccess"},m={ref:"reportUpdatedSuccess"},b=Object(l["createElementVNode"])("div",{id:"ajaxError",style:{display:"none"}},null,-1),O={id:"ajaxLoadingDiv",style:{display:"none"}},j={class:"loadingPiwik"},y={class:"loadingSegment"},h=Object(l["createElementVNode"])("a",{id:"bottom"},null,-1);function g(e,t,r,o,n,i){const a=Object(l["resolveComponent"])("MatomoLoader"),c=Object(l["resolveComponent"])("ListReports"),p=Object(l["resolveComponent"])("AddReport");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",s,[Object(l["createElementVNode"])("div",u,null,512),Object(l["createElementVNode"])("div",m,null,512),Object(l["createElementVNode"])("div",null,[b,Object(l["createElementVNode"])("div",O,[Object(l["createElementVNode"])("div",j,[Object(l["createVNode"])(a),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_LoadingData")),1)]),Object(l["createElementVNode"])("div",y,Object(l["toDisplayString"])(e.translate("SegmentEditor_LoadingSegmentedDataMayTakeSomeTime")),1)]),Object(l["withDirectives"])(Object(l["createVNode"])(c,{"content-title":e.contentTitle,"user-login":e.userLogin,"login-module":e.loginModule,reports:e.reports,"site-name":e.decodedSiteName,"segment-editor-activated":e.segmentEditorActivated,"saved-segments-by-id":e.savedSegmentsById,periods:e.periods,"report-types":e.reportTypes,"download-output-type":e.downloadOutputType,language:e.language,"report-formats-by-report-type":e.reportFormatsByReportType,"sending-reports":e.sendingReports,onCreate:t[0]||(t[0]=t=>e.createReport()),onEdit:t[1]||(t[1]=t=>e.editReport(t)),onDelete:t[2]||(t[2]=t=>e.deleteReport(t)),onSendnow:t[3]||(t[3]=t=>e.sendReportNow(t))},null,8,["content-title","user-login","login-module","reports","site-name","segment-editor-activated","saved-segments-by-id","periods","report-types","download-output-type","language","report-formats-by-report-type","sending-reports"]),[[l["vShow"],e.showReportsList]]),e.showReportForm?(Object(l["openBlock"])(),Object(l["createBlock"])(p,{key:0,report:e.report,periods:e.periods,"param-periods":e.paramPeriods,"report-type-options":e.reportTypeOptions,"report-formats-by-report-type-options":e.reportFormatsByReportTypeOptions,"display-formats":e.displayFormats,"reports-by-category-by-report-type":e.reportsByCategoryByReportType,"allow-multiple-reports-by-report-type":e.allowMultipleReportsByReportType,"count-websites":e.countWebsites,"site-name":e.decodedSiteName,"selected-reports":e.selectedReports,"report-types":e.reportTypes,"segment-editor-activated":e.segmentEditorActivated,"saved-segments-by-id":e.savedSegmentsById,onToggleSelectedReport:t[4]||(t[4]=t=>e.toggleSelectedReport(t.reportType,t.uniqueId)),onChange:t[5]||(t[5]=t=>e.onChangeProperty(t.prop,t.value)),onSubmit:t[6]||(t[6]=t=>e.submitReport())},{"report-parameters":Object(l["withCtx"])(()=>[Object(l["renderSlot"])(e.$slots,"report-parameters")]),_:3},8,["report","periods","param-periods","report-type-options","report-formats-by-report-type-options","display-formats","reports-by-category-by-report-type","allow-multiple-reports-by-report-type","count-websites","site-name","selected-reports","report-types","segment-editor-activated","saved-segments-by-id"])):Object(l["createCommentVNode"])("",!0),h])],512)}var v=r("19dc");const R=Object(l["createElementVNode"])("div",{class:"clear"},null,-1),f={key:0},S=["innerHTML"],E={id:"emailScheduleInlineHelp",class:"inline-help-node"},N=Object(l["createElementVNode"])("br",null,null,-1),V={id:"emailReportPeriodInlineHelp",class:"inline-help-node"},k=Object(l["createElementVNode"])("br",null,null,-1),w=Object(l["createElementVNode"])("br",null,null,-1),B={key:0,id:"reportHourHelpText",class:"inline-help-node"},_=["textContent"],T={ref:"reportParameters"},C={class:"report_evolution_graph"},P={class:"row evolution-graph-period"},F={class:"col s12"},D={for:"report_evolution_period_for_each"},M=["checked"],x=["innerHTML"],q={class:"col s12"},L={for:"report_evolution_period_for_prev"},I=["checked"],H=["value"],A={class:"row"},G={class:"col s12"},U={class:"reportCategory"},z={class:"listReports"},W=["name","type","id","checked","onChange"],Z={key:0,class:"entityInlineHelp"},K=Object(l["createElementVNode"])("br",null,null,-1),X=["innerHTML"];function J(e,t,r,o,n,i){const a=Object(l["resolveComponent"])("Field"),c=Object(l["resolveComponent"])("SaveButton"),p=Object(l["resolveComponent"])("ContentBlock"),d=Object(l["resolveDirective"])("form");return Object(l["openBlock"])(),Object(l["createBlock"])(p,{class:"entityAddContainer","content-title":e.contentTitle},{default:Object(l["withCtx"])(()=>[R,Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("form",{id:"addEditReport",onSubmit:t[13]||(t[13]=t=>e.$emit("submit"))},[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(a,{uicontrol:"text",name:"website",title:e.translate("General_Website"),disabled:!0,"model-value":e.siteName},null,8,["title","model-value"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(a,{uicontrol:"textarea",name:"report_description",title:e.translate("General_Description"),"model-value":e.report.description,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("change",{prop:"description",value:t})),"inline-help":e.translate("ScheduledReports_DescriptionOnFirstPageScheduledReport")},null,8,["title","model-value","inline-help"])]),e.segmentEditorActivated?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",f,[Object(l["createVNode"])(a,{uicontrol:"select",name:"report_segment",title:e.translate("SegmentEditor_ChooseASegment"),"model-value":e.report.idsegment,"onUpdate:modelValue":t[1]||(t[1]=t=>e.$emit("change",{prop:"idsegment",value:t})),options:e.savedSegmentsById},{"inline-help":Object(l["withCtx"])(()=>[e.segmentEditorActivated?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:0,id:"reportSegmentInlineHelp",class:"inline-help-node",innerHTML:e.$sanitize(e.reportSegmentInlineHelp)},null,8,S)):Object(l["createCommentVNode"])("",!0)]),_:1},8,["title","model-value","options"])])):Object(l["createCommentVNode"])("",!0),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(a,{uicontrol:"select",name:"report_schedule","model-value":e.report.period,"onUpdate:modelValue":t[2]||(t[2]=t=>{e.$emit("change",{prop:"period",value:t}),e.$emit("change",{prop:"periodParam",value:"never"===e.report.period?null:e.report.period})}),title:e.translate("ScheduledReports_ReportSchedule"),options:e.periods},{"inline-help":Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",E,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("ScheduledReports_WeeklyScheduleHelp"))+" ",1),N,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_MonthlyScheduleHelp")),1)])]),_:1},8,["model-value","title","options"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(a,{uicontrol:"select",name:"report_period","model-value":e.report.periodParam,"onUpdate:modelValue":t[3]||(t[3]=t=>e.$emit("change",{prop:"periodParam",value:t})),options:e.paramPeriods,title:e.translate("ScheduledReports_ReportPeriod")},{"inline-help":Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",V,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("ScheduledReports_ScheduleReportPeriodHelp"))+" ",1),k,w,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_ScheduleReportPeriodHelp2")),1)])]),_:1},8,["model-value","options","title"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(a,{uicontrol:"select",name:"report_hour","model-value":e.report.hour,"onUpdate:modelValue":t[4]||(t[4]=t=>e.$emit("change",{prop:"hour",value:t})),title:e.translate("ScheduledReports_ReportHour","X"),options:e.reportHours},{"inline-help":Object(l["withCtx"])(()=>[0!==e.timezoneOffset&&"0"!==e.timezoneOffset?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",B,[Object(l["createElementVNode"])("span",{textContent:Object(l["toDisplayString"])(e.reportHourUtc)},null,8,_)])):Object(l["createCommentVNode"])("",!0)]),_:1},8,["model-value","title","options"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(a,{uicontrol:"select",name:"report_type",disabled:1===e.reportTypes.length,"model-value":e.report.type,"onUpdate:modelValue":t[5]||(t[5]=t=>e.$emit("change",{prop:"type",value:t})),title:e.translate("ScheduledReports_ReportType"),options:e.reportTypeOptions},null,8,["disabled","model-value","title","options"])]),Object(l["createElementVNode"])("div",T,[Object(l["renderSlot"])(e.$slots,"report-parameters")],512),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.reportFormatsByReportTypeOptions,(t,r)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:r},[Object(l["withDirectives"])(Object(l["createVNode"])(a,{uicontrol:"select",name:"report_format",title:e.translate("ScheduledReports_ReportFormat"),class:Object(l["normalizeClass"])(r),"model-value":e.report["format"+r],"onUpdate:modelValue":t=>e.$emit("change",{prop:"format"+r,value:t}),options:t},null,8,["title","class","model-value","onUpdate:modelValue","options"]),[[l["vShow"],e.report.type===r]])]))),128)),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",null,[Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])(e.report.type)},[Object(l["createVNode"])(a,{uicontrol:"select",name:"display_format","model-value":e.report.displayFormat,"onUpdate:modelValue":t[6]||(t[6]=t=>e.$emit("change",{prop:"displayFormat",value:t})),options:e.displayFormats,introduction:e.translate("ScheduledReports_AggregateReportsFormat")},null,8,["model-value","options","introduction"])],2),Object(l["createElementVNode"])("div",C,[Object(l["withDirectives"])(Object(l["createVNode"])(a,{uicontrol:"checkbox",name:"report_evolution_graph",title:e.translate("ScheduledReports_EvolutionGraph",5),"model-value":e.report.evolutionGraph,"onUpdate:modelValue":t[7]||(t[7]=t=>e.$emit("change",{prop:"evolutionGraph",value:t}))},null,8,["title","model-value"]),[[l["vShow"],-1!==[2,"2",3,"3"].indexOf(e.report.displayFormat)]])]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",P,[Object(l["createElementVNode"])("div",F,[Object(l["createElementVNode"])("label",D,[Object(l["createElementVNode"])("input",{id:"report_evolution_period_for_each",name:"report_evolution_period_for",type:"radio",value:"each",checked:"each"===e.report.evolutionPeriodFor,onChange:t[8]||(t[8]=t=>e.$emit("change",{prop:"evolutionPeriodFor",value:t.target.value}))},null,40,M),Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize(e.evolutionGraphsShowForEachInPeriod)},null,8,x)])]),Object(l["createElementVNode"])("div",q,[Object(l["createElementVNode"])("label",L,[Object(l["createElementVNode"])("input",{id:"report_evolution_period_for_prev",name:"report_evolution_period_for",type:"radio",value:"prev",checked:"prev"===e.report.evolutionPeriodFor,onChange:t[9]||(t[9]=t=>e.$emit("change",{prop:"evolutionPeriodFor",value:t.target.value}))},null,40,I),Object(l["createElementVNode"])("span",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("ScheduledReports_EvolutionGraphsShowForPreviousN",e.frequencyPeriodPlural))+": ",1),Object(l["createElementVNode"])("input",{type:"number",name:"report_evolution_period_n",value:e.report.evolutionPeriodN,onKeydown:t[10]||(t[10]=t=>e.onEvolutionPeriodN(t)),onChange:t[11]||(t[11]=t=>e.onEvolutionPeriodN(t))},null,40,H)])])])],512),[[l["vShow"],-1!==[1,"1",2,"2",3,"3"].indexOf(e.report.displayFormat)]])],512),[[l["vShow"],"pdf"===e.report["format"+e.report.type]||"html"===e.report["format"+e.report.type]]]),Object(l["createElementVNode"])("div",A,[Object(l["createElementVNode"])("h3",G,Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportsIncluded")),1)]),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.reportsByCategoryByReportTypeInColumns,(t,r)=>Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{name:"reportsList",class:Object(l["normalizeClass"])("row "+r),key:r},[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t,(t,o)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{class:"col s12 m6",key:o},[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t,(t,o)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:o},[Object(l["createElementVNode"])("h3",U,Object(l["toDisplayString"])(o),1),Object(l["createElementVNode"])("ul",z,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t,t=>{var o;return Object(l["openBlock"])(),Object(l["createElementBlock"])("li",{key:t.uniqueId},[Object(l["createElementVNode"])("label",null,[Object(l["createElementVNode"])("input",{name:r+"Reports",type:e.allowMultipleReportsByReportType[r]?"checkbox":"radio",id:`${r}${t.uniqueId}`,checked:null===(o=e.selectedReports[r])||void 0===o?void 0:o[t.uniqueId],onChange:o=>e.$emit("toggleSelectedReport",{reportType:r,uniqueId:t.uniqueId})},null,40,W),Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.decode(t.name)),1),"MultiSites_getAll"===t.uniqueId?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Z,Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportIncludeNWebsites",e.countWebsites)),1)):Object(l["createCommentVNode"])("",!0)])])}),128))]),K]))),128))]))),128))],2)),[[l["vShow"],e.report.type===r]])),128)),Object(l["createVNode"])(c,{value:e.saveButtonTitle,onConfirm:t[12]||(t[12]=t=>e.$emit("submit"))},null,8,["value"]),Object(l["createElementVNode"])("div",{class:"entityCancel",innerHTML:e.$sanitize(e.entityCancelText)},null,8,X)],32)),[[d]])]),_:3},8,["content-title"])}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Q(e,t){return""+(24+parseFloat(e)+t)%24}const{$:Y}=window;var ee=Object(l["defineComponent"])({props:{report:{type:Object,required:!0},selectedReports:Object,paramPeriods:{type:Object,required:!0},reportTypeOptions:{type:Object,required:!0},reportFormatsByReportTypeOptions:{type:Object,required:!0},displayFormats:{type:Object,required:!0},reportsByCategoryByReportType:{type:Object,required:!0},allowMultipleReportsByReportType:{type:Object,required:!0},countWebsites:{type:Number,required:!0},siteName:{type:String,required:!0},reportTypes:{type:Object,required:!0},segmentEditorActivated:Boolean,savedSegmentsById:Object,periods:{type:Object,required:!0}},emits:["submit","change","toggleSelectedReport"],components:{ContentBlock:v["ContentBlock"],Field:c["Field"],SaveButton:c["SaveButton"]},directives:{Form:c["Form"]},created(){this.onEvolutionPeriodN=Object(v["debounce"])(this.onEvolutionPeriodN,50)},methods:{onEvolutionPeriodN(e){this.$emit("change",{prop:"evolutionPeriodN",value:e.target.value})},decode(e){return v["Matomo"].helper.htmlDecode(e)}},setup(e,t){const r=Object(l["ref"])(null);return Object(l["watch"])(()=>e.report,e=>{const t=r.value;t.querySelectorAll("[vue-entry]").forEach(t=>{Y(t).data("vueAppInstance").report_=e})}),Object(l["onMounted"])(()=>{const o=r.value;v["Matomo"].helper.compileVueEntryComponents(o,{report:e.report,onChange(e,r){t.emit("change",{prop:e,value:r})}})}),{reportParameters:r}},beforeUnmount(){const e=this.$refs.reportParameters;v["Matomo"].helper.destroyVueComponent(e)},computed:{reportsByCategoryByReportTypeInColumns(){const e=this.reportsByCategoryByReportType,t=Object.entries(e).map(([e,t])=>{const r=Math.floor((Object.keys(t).length+1)/2),o={},n={};let l=o;return Object.entries(t).forEach(([e,t])=>{l[e]=t,Object.keys(l).length>=r&&(l=n)}),[e,[o,n]]});return Object.fromEntries(t)},entityCancelText(){return Object(v["translate"])("General_OrCancel",'<a class="entityCancelLink">',"</a>")},frequencyPeriodSingle(){if(!this.report||!this.report.period)return"";const{ReportPlugin:e}=window;let t=e.periodTranslations[this.report.period];return t||(t=e.periodTranslations.day),t.single},frequencyPeriodPlural(){if(!this.report||!this.report.period)return"";const{ReportPlugin:e}=window;let t=e.periodTranslations[this.report.period];return t||(t=e.periodTranslations.day),t.plural},evolutionGraphsShowForEachInPeriod(){return Object(v["translate"])("ScheduledReports_EvolutionGraphsShowForEachInPeriod","<strong>","</strong>",this.frequencyPeriodSingle)},reportSegmentInlineHelp(){return Object(v["translate"])("ScheduledReports_Segment_HelpScheduledReport",'<a href="./" rel="noreferrer noopener" target="_blank">',"</a>",Object(v["translate"])("SegmentEditor_DefaultAllVisits"),Object(v["translate"])("SegmentEditor_AddNewSegment"))},timezoneOffset(){return v["Matomo"].timezoneOffset},timeZoneDifferenceInHours(){return v["Matomo"].timezoneOffset/3600},reportHours(){const e=[];for(let t=0;t<24;t+=1)2*this.timeZoneDifferenceInHours%2!==0?e.push({key:t+".5",value:t+":30"}):e.push({key:""+t,value:""+t});return e},reportHourUtc(){const e=Q(this.report.hour,-this.timeZoneDifferenceInHours);return Object(v["translate"])("ScheduledReports_ReportHourWithUTC",[e])},saveButtonTitle(){const{ReportPlugin:e}=window,t=this.report.idreport>0;return t?e.updateReportString:e.createReportString},contentTitle(){const{ReportPlugin:e}=window,t=this.report.idreport>0;return t?e.updateReportString:Object(v["translate"])("ScheduledReports_CreateAndScheduleReport")}}});ee.render=J;var te=ee;const re={class:"first"},oe={key:0},ne={colspan:"7"},le=Object(l["createElementVNode"])("br",null,null,-1),ie=Object(l["createElementVNode"])("br",null,null,-1),ae=["href"],ce=Object(l["createElementVNode"])("br",null,null,-1),pe=Object(l["createElementVNode"])("br",null,null,-1),de={key:1},se={colspan:"7"},ue=Object(l["createElementVNode"])("br",null,null,-1),me=Object(l["createElementVNode"])("br",null,null,-1),be=Object(l["createElementVNode"])("br",null,null,-1),Oe={class:"first"},je={key:0,class:"entityInlineHelp",style:{"font-size":"9pt"}},ye={key:0},he={key:1},ge={key:0},ve={key:0},Re=Object(l["createElementVNode"])("br",null,null,-1),fe=["onClick"],Se=["src"],Ee={key:2,class:"loadingPiwik"},Ne=["id","action"],Ve=["value"],ke=Object(l["createElementVNode"])("input",{type:"hidden",name:"force_api_session",value:"1"},null,-1),we=["onClick","id"],Be=["src"],_e={style:{"text-align":"center","padding-top":"2px"}},Te=["onClick","title"],Ce=Object(l["createElementVNode"])("span",{class:"icon-edit"},null,-1),Pe=[Ce],Fe={style:{"text-align":"center","padding-top":"2px"}},De=["onClick","title"],Me=Object(l["createElementVNode"])("span",{class:"icon-delete"},null,-1),xe=[Me],qe={class:"tableActionBar"},Le=Object(l["createElementVNode"])("span",{class:"icon-add"},null,-1);function Ie(e,t,r,o,n,i){const a=Object(l["resolveComponent"])("MatomoLoader"),c=Object(l["resolveComponent"])("ContentBlock"),p=Object(l["resolveDirective"])("content-table");return Object(l["openBlock"])(),Object(l["createBlock"])(c,{id:"entityEditContainer",class:"entityTableContainer","help-url":e.externalRawLink("https://matomo.org/docs/email-reports/"),feature:"true","content-title":e.contentTitle},{default:Object(l["withCtx"])(()=>{var r;return[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("table",null,[Object(l["createElementVNode"])("thead",null,[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("th",re,Object(l["toDisplayString"])(e.translate("General_Description")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportSchedule")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportFormat")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("ScheduledReports_SendReportTo")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("General_Download")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("General_Edit")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("General_Delete")),1)])]),Object(l["createElementVNode"])("tbody",null,["anonymous"===e.userLogin?(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",oe,[Object(l["createElementVNode"])("td",ne,[le,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_MustBeLoggedIn"))+" ",1),ie,Object(l["createTextVNode"])("› "),Object(l["createElementVNode"])("a",{href:"index.php?module="+e.loginModule},Object(l["toDisplayString"])(e.translate("Login_LogIn")),9,ae),ce,pe])])):null!==(r=e.reports)&&void 0!==r&&r.length?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",de,[Object(l["createElementVNode"])("td",se,[ue,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_ThereIsNoReportToManage",e.siteName))+". ",1),me,be])])),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.decodedReports,t=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",{key:t.idreport},[Object(l["createElementVNode"])("td",Oe,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(t.description)+" ",1),e.segmentEditorActivated&&t.idsegment?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",je,[e.savedSegmentsById[t.idsegment]?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",ye,Object(l["toDisplayString"])(e.savedSegmentsById[t.idsegment]),1)):(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",he,Object(l["toDisplayString"])(e.translate("ScheduledReports_SegmentDeleted")),1))])):Object(l["createCommentVNode"])("",!0)]),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(e.periods[t.period])+" ",1),Object(l["createElementVNode"])("td",null,[t.format?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",ge,Object(l["toDisplayString"])(t.format.toUpperCase()),1)):Object(l["createCommentVNode"])("",!0)]),Object(l["createElementVNode"])("td",null,[0===t.recipients.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",ve,Object(l["toDisplayString"])(e.translate("ScheduledReports_NoRecipients")),1)):Object(l["createCommentVNode"])("",!0),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t.recipients,(e,t)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",{key:t},[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e)+" ",1),Re]))),128)),0===t.recipients.length||e.sendingReports.includes(t.idreport)?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("a",{key:1,href:"#",name:"linkSendNow",class:"link_but withIcon",style:{"margin-top":"3px"},onClick:Object(l["withModifiers"])(r=>e.$emit("sendnow",t.idreport),["prevent"])},[Object(l["createElementVNode"])("img",{border:"0",src:e.reportTypes[t.type]},null,8,Se),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_SendReportNow")),1)],8,fe)),e.sendingReports.includes(t.idreport)?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Ee,[Object(l["createVNode"])(a),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_SendingReport")),1)])):Object(l["createCommentVNode"])("",!0)]),Object(l["createElementVNode"])("td",null,[Object(l["createElementVNode"])("form",{method:"POST",target:"_blank",id:"downloadReportForm_"+t.idreport,action:e.linkTo({module:"API",segment:null,method:"ScheduledReports.generateReport",idReport:t.idreport,outputType:e.downloadOutputType,language:e.language,format:-1!==["html","csv","tsv"].indexOf(t.format)?t.format:"original"})},[Object(l["createElementVNode"])("input",{type:"hidden",name:"token_auth",value:e.token_auth},null,8,Ve),ke],8,Ne),Object(l["createElementVNode"])("a",{href:"",rel:"noreferrer noopener",name:"linkDownloadReport",class:"link_but withIcon",onClick:Object(l["withModifiers"])(r=>e.displayReport(t.idreport),["prevent"]),id:t.idreport},[Object(l["createElementVNode"])("img",{border:"0",width:16,height:16,src:e.reportFormatsByReportType[t.type][t.format]},null,8,Be),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_Download")),1)],8,we)]),Object(l["createElementVNode"])("td",_e,[Object(l["createElementVNode"])("button",{class:"table-action",onClick:r=>e.$emit("edit",t.idreport),title:e.translate("General_Edit")},Pe,8,Te)]),Object(l["createElementVNode"])("td",Fe,[Object(l["createElementVNode"])("button",{class:"table-action",onClick:r=>e.$emit("delete",t.idreport),title:e.translate("General_Delete")},xe,8,De)])]))),128))])])),[[p]]),Object(l["createElementVNode"])("div",qe,["anonymous"!==e.userLogin?(Object(l["openBlock"])(),Object(l["createElementBlock"])("button",{key:0,id:"add-report",onClick:t[0]||(t[0]=t=>e.$emit("create"))},[Le,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_CreateAndScheduleReport")),1)])):Object(l["createCommentVNode"])("",!0)])]}),_:1},8,["help-url","content-title"])}var $e=Object(l["defineComponent"])({props:{contentTitle:{type:String,required:!0},userLogin:{type:String,required:!0},loginModule:{type:String,required:!0},reports:{type:Array,required:!0},siteName:{type:String,required:!0},segmentEditorActivated:Boolean,savedSegmentsById:Object,periods:{type:Object,required:!0},downloadOutputType:{type:Number,required:!0},language:{type:String,required:!0},reportFormatsByReportType:{type:Object,required:!0},reportTypes:{type:Object,required:!0},sendingReports:{type:Array,required:!1}},components:{ContentBlock:v["ContentBlock"],MatomoLoader:v["MatomoLoader"]},directives:{ContentTable:v["ContentTable"]},emits:["create","edit","delete","sendnow"],methods:{linkTo(e){return"?"+v["MatomoUrl"].stringify(Object.assign(Object.assign({},v["MatomoUrl"].urlParsed.value),e))},displayReport(e){$("#downloadReportForm_"+e).submit()}},computed:{token_auth(){return v["Matomo"].token_auth},decodedReports(){return this.reports.map(e=>Object.assign(Object.assign({},e),{},{description:v["Matomo"].helper.htmlDecode(e.description)}))}}});$e.render=Ie;var He=$e;function Ae(){v["Matomo"].helper.lazyScrollTo(".emailReports",200)}function Ge(e,t){var r;null!==(r=window.updateReportParametersFunctions)&&void 0!==r&&r[e]&&window.updateReportParametersFunctions[e](t)}function Ue(e,t){var r;null!==(r=window.resetReportParametersFunctions)&&void 0!==r&&r[e]&&window.resetReportParametersFunctions[e](t)}window.resetReportParametersFunctions=window.resetReportParametersFunctions||{},window.updateReportParametersFunctions=window.updateReportParametersFunctions||{},window.getReportParametersFunctions=window.getReportParametersFunctions||{};const{$:ze}=window,We=v["Matomo"].timezoneOffset/3600;var Ze=Object(l["defineComponent"])({props:{contentTitle:{type:String,required:!0},userLogin:{type:String,required:!0},loginModule:{type:String,required:!0},reports:{type:Array,required:!0},siteName:{type:String,required:!0},segmentEditorActivated:Boolean,savedSegmentsById:Object,periods:{type:Object,required:!0},downloadOutputType:{type:Number,required:!0},language:{type:String,required:!0},reportFormatsByReportType:{type:Object,required:!0},paramPeriods:{type:Object,required:!0},reportTypeOptions:{type:Object,required:!0},reportFormatsByReportTypeOptions:{type:Object,required:!0},displayFormats:{type:Object,required:!0},reportsByCategoryByReportType:{type:Object,required:!0},allowMultipleReportsByReportType:{type:Object,required:!0},countWebsites:{type:Number,required:!0},reportTypes:{type:Object,required:!0}},components:{MatomoLoader:v["MatomoLoader"],AddReport:te,ListReports:He},directives:{ContentTable:v["ContentTable"],Form:c["Form"]},mounted(){ze(this.$refs.root).on("click","a.entityCancelLink",()=>{this.showListOfReports()}),v["Matomo"].postEvent("ScheduledReports.ManageScheduledReport.mounted",{element:this.$refs.root})},unmounted(){v["Matomo"].postEvent("ScheduledReports.ManageScheduledReport.unmounted",{element:this.$refs.root})},data(){return{showReportsList:!0,report:{},selectedReports:{},sendingReports:[]}},methods:{sendReportNow(e){this.sendingReports.includes(e)||(Ae(),this.sendingReports.push(e),v["AjaxHelper"].post({method:"ScheduledReports.sendReport"},{idReport:e,force:!0}).then(()=>{this.fadeInOutSuccessMessage(this.$refs.reportSentSuccess,Object(v["translate"])("ScheduledReports_ReportSent"),!1)}).finally(()=>{this.sendingReports=this.sendingReports.filter(t=>t!==e)}))},formSetEditReport(e){const{ReportPlugin:t}=window;let r={idreport:e,type:t.defaultReportType,format:t.defaultReportFormat,description:"",period:t.defaultPeriod,hour:t.defaultHour,reports:[],idsegment:"",evolutionPeriodFor:"prev",evolutionPeriodN:t.defaultEvolutionPeriodN,periodParam:t.defaultPeriod};e>0?(r=t.reportList[e],Ge(r.type,r)):Ue(r.type,r),r.hour=Q(r.hour,We),this.selectedReports={},Object.values(r.reports).forEach(e=>{this.selectedReports[r.type]=this.selectedReports[r.type]||{},this.selectedReports[r.type][e]=!0}),r["format"+r.type]=r.format,r.idsegment||(r.idsegment=""),this.report=r,this.report.description=v["Matomo"].helper.htmlDecode(r.description)},fadeInOutSuccessMessage(e,t,r=!0){v["NotificationsStore"].show({message:t,placeat:e,context:"success",noclear:!0,type:"toast",style:{display:"inline-block",marginTop:"10px",width:"100%"},id:"scheduledReportSuccess"}),r&&v["Matomo"].helper.refreshAfter(2)},changedReportType(){Ue(this.report.type,this.report)},deleteReport(e){v["Matomo"].helper.modalConfirm("#confirm",{yes:()=>{v["AjaxHelper"].post({method:"ScheduledReports.deleteReport"},{idReport:e},{redirectOnSuccess:!0})}})},showListOfReports(e){this.showReportsList=!0,v["Matomo"].helper.hideAjaxError(),("undefined"===typeof e||e)&&Ae()},createReport(){this.showReportsList=!1,Object(l["nextTick"])(()=>{this.formSetEditReport(0)})},editReport(e){this.showReportsList=!1,Object(l["nextTick"])(()=>{this.formSetEditReport(e)})},submitReport(){const e={idReport:this.report.idreport,description:this.report.description,idSegment:this.report.idsegment,reportType:this.report.type,reportFormat:this.report["format"+this.report.type],periodParam:this.report.periodParam,evolutionPeriodFor:this.report.evolutionPeriodFor};"each"!==e.evolutionPeriodFor&&(e.evolutionPeriodN=this.report.evolutionPeriodN);const{period:t}=this.report,r=Q(this.report.hour,-We),o=this.selectedReports[e.reportType]||{},n=Object.keys(o).filter(t=>this.selectedReports[e.reportType][t]);n.length>0&&(e.reports=n);const l=window.getReportParametersFunctions[this.report.type](this.report);e.parameters=l;const i=this.report.idreport>0;return v["AjaxHelper"].post({method:i?"ScheduledReports.updateReport":"ScheduledReports.addReport",period:t,hour:r},e).then(()=>{this.fadeInOutSuccessMessage(this.$refs.reportUpdatedSuccess,Object(v["translate"])("ScheduledReports_ReportUpdated"))}),!1},onChangeProperty(e,t){this.report[e]=t,"type"===e&&this.changedReportType()},toggleSelectedReport(e,t){this.selectedReports[e]=this.selectedReports[e]||{},this.selectedReports[e][t]=!this.selectedReports[e][t]}},computed:{showReportForm(){return!this.showReportsList},decodedSiteName(){return v["Matomo"].helper.htmlDecode(this.siteName)}}});Ze.render=g;var Ke=Ze;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["Live"]=t(require("CoreHome"),require("vue")):e["Live"]=t(e["CoreHome"],e["Vue"])})("undefined"!==typeof self?self:this,(function(e,t){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/Live/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},"8bbf":function(e,o){e.exports=t},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"LiveWidgetRefresh",(function(){return a})),o.d(t,"TotalVisitors",(function(){return L})),o.d(t,"LivePage",(function(){return I})),o.d(t,"IndexHeader",(function(){return U})),o.d(t,"LastVisits",(function(){return G})),"undefined"!==typeof window){var r=window.document.currentScript,n=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(o.p=n[1])}var i=o("19dc");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
const{$:l}=window;var a={mounted(e,t){setTimeout(()=>{const o=i["MatomoUrl"].parsed.value.segment;l(e).find("#visitsLive").liveWidget({interval:t.value.liveRefreshAfterMs,onUpdate:()=>{i["AjaxHelper"].fetch({module:"Live",action:"ajaxTotalVisitors",segment:o},{format:"html"}).then(t=>{i["Matomo"].helper.destroyVueComponent(e),l(e).find("#visitsTotal").replaceWith(t),i["Matomo"].helper.compileVueEntryComponents(e)})},maxRows:10,fadeInSpeed:600,dataUrlParams:{module:"Live",action:"getLastVisitsStart",segment:o}})})}},c=o("8bbf");const s={class:"dataTable",cellspacing:"0"},u={id:"label",class:"sortable label first",style:{cursor:"auto"}},d={class:"thDIV"},b=["title"],m={class:"thDIV"},f=["title"],p={class:"thDIV"},v={class:""},j={class:"label column"},O=["title"],g=["title"],y={class:""},V={class:"label column"},h=["title"],E=["title"];function N(e,t,o,r,n,i){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createElementVNode"])("table",s,[Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",u,[Object(c["createElementVNode"])("div",d,Object(c["toDisplayString"])(e.translate("General_Date")),1)]),Object(c["createElementVNode"])("th",{class:"sortable",style:{cursor:"auto"},title:e.translate("General_ColumnNbVisitsDocumentation")},[Object(c["createElementVNode"])("div",m,Object(c["toDisplayString"])(e.translate("General_ColumnNbVisits")),1)],8,b),Object(c["createElementVNode"])("th",{class:"sortable",style:{cursor:"auto"},title:e.translate("General_ColumnNbActionsDocumentation")},[Object(c["createElementVNode"])("div",p,Object(c["toDisplayString"])(e.translate("General_Actions")),1)],8,f)])]),Object(c["createElementVNode"])("tbody",null,[Object(c["createElementVNode"])("tr",v,[Object(c["createElementVNode"])("td",j,Object(c["toDisplayString"])(e.translate("Live_LastHours",24)),1),Object(c["createElementVNode"])("td",{class:"column",title:e.countErrorToday},Object(c["toDisplayString"])(e.visitorsCountToday||0),9,O),Object(c["createElementVNode"])("td",{class:"column",title:e.countErrorToday},Object(c["toDisplayString"])(e.pisToday||0),9,g)]),Object(c["createElementVNode"])("tr",y,[Object(c["createElementVNode"])("td",V,Object(c["toDisplayString"])(e.translate("Live_LastMinutes",30)),1),Object(c["createElementVNode"])("td",{class:"column",title:e.countErrorHalfHour},Object(c["toDisplayString"])(e.visitorsCountHalfHour||0),9,h),Object(c["createElementVNode"])("td",{class:"column",title:e.countErrorHalfHour},Object(c["toDisplayString"])(e.pisHalfhour||0),9,E)])])])])}var C=Object(c["defineComponent"])({props:{countErrorToday:Number,visitorsCountToday:Number,pisToday:Number,countErrorHalfHour:Number,visitorsCountHalfHour:Number,pisHalfhour:Number}});C.render=N;var L=C;const k={class:"visitsLiveFooter"},w=["title"],_=Object(c["createElementVNode"])("img",{id:"pauseImage",border:"0",src:"plugins/Live/images/pause.png",role:"presentation"},null,-1),D=[_],S=["title"],H=Object(c["createElementVNode"])("img",{id:"playImage",style:{display:"none"},border:"0",src:"plugins/Live/images/play.png",role:"presentation"},null,-1),T=[H],P={key:0},x=["href"];function B(e,t,o,r,n,i){const l=Object(c["resolveComponent"])("VueEntryContainer"),a=Object(c["resolveDirective"])("live-widget-refresh");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["resolveDynamicComponent"])(e.isWidgetized?"Passthrough":"ContentBlock"),{"content-title":e.isWidgetized?void 0:e.translate("Live_VisitorsInRealTime")},{default:Object(c["withCtx"])(()=>[Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createVNode"])(l,{html:e.initialTotalVisitors},null,8,["html"]),Object(c["createVNode"])(l,{html:e.visitors},null,8,["html"])])),[[a,{liveRefreshAfterMs:e.liveRefreshAfterMs}]]),Object(c["createElementVNode"])("div",k,[Object(c["createElementVNode"])("a",{title:e.translate("Live_OnClickPause",e.translate("Live_VisitorsInRealTime")),onClick:t[0]||(t[0]=Object(c["withModifiers"])(t=>e.onClickPause(),["prevent"]))},D,8,w),Object(c["createElementVNode"])("a",{title:e.translate("Live_OnClickStart",e.translate("Live_VisitorsInRealTime")),onClick:t[1]||(t[1]=t=>{e.onClickPlay()})},T,8,S),e.disableLink?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",P,[Object(c["createTextVNode"])("   "),Object(c["createElementVNode"])("a",{class:"rightLink",href:e.visitorLogUrl},Object(c["toDisplayString"])(e.translate("Live_LinkVisitorLog")),9,x)]))])]),_:1},8,["content-title"]))])}var M=Object(c["defineComponent"])({props:{disableLink:Boolean,visitors:String,initialTotalVisitors:String,liveRefreshAfterMs:Number,isWidgetized:Boolean},components:{TotalVisitors:L,VueEntryContainer:i["VueEntryContainer"],ContentBlock:i["ContentBlock"],Passthrough:i["Passthrough"]},directives:{LiveWidgetRefresh:a},computed:{visitorLogUrl(){return"#?"+i["MatomoUrl"].stringify(Object.assign(Object.assign({},i["MatomoUrl"].hashParsed.value),{},{category:"General_Visitors",subcategory:"Live_VisitorLog"}))}},methods:{onClickPause(){window.onClickPause()},onClickPlay(){window.onClickPlay()}}});M.render=B;var I=M;function R(e,t,o,r,n,i){const l=Object(c["resolveComponent"])("EnrichedHeadline"),a=Object(c["resolveDirective"])("content-intro");return Object(c["withDirectives"])((Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createElementVNode"])("h2",null,[Object(c["createVNode"])(l,null,{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.translate("Live_VisitorLog")),1)]),_:1})])])),[[a]])}var A=Object(c["defineComponent"])({components:{EnrichedHeadline:i["EnrichedHeadline"]},directives:{ContentIntro:i["ContentIntro"]}});A.render=R;var U=A;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */const{$:W}=window;var G={mounted(e){W(e).off("click").on("click",".visits-live-launch-visitor-profile",(function(e){return e.preventDefault(),window.broadcast.propagateNewPopoverParameter("visitorProfile",W(this).attr("data-visitor-id")),!1})).tooltip({track:!0,content(){const e=W(this).attr("title")||"";return window.vueSanitize(e.replace(/\n/g,"<br />"))},show:{delay:100,duration:0},hide:!1})}};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["SegmentEditor"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["SegmentEditor"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/SegmentEditor/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"SegmentGeneratorStore",(function(){return d})),n.d(t,"SegmentGenerator",(function(){return U})),"undefined"!==typeof window){var o=window.document.currentScript,i=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var a=n("8bbf"),r=n("19dc");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class l{constructor(){s(this,"privateState",Object(a["reactive"])({isLoading:!1,segments:[]})),s(this,"state",Object(a["computed"])(()=>Object(a["readonly"])(this.privateState))),s(this,"loadSegmentsAbort",void 0),s(this,"loadSegmentsPromise",void 0),s(this,"fetchedSiteId",void 0)}loadSegments(e,t){if(this.loadSegmentsAbort&&(this.loadSegmentsAbort.abort(),this.loadSegmentsAbort=void 0),this.privateState.isLoading=!0,this.fetchedSiteId!==e&&(this.loadSegmentsAbort=void 0,this.fetchedSiteId=e),!this.loadSegmentsPromise){let t=void 0,n=void 0;"all"!==e&&e?e&&(t=e,n=e):(t="all",n="all"),this.loadSegmentsAbort=new AbortController,this.loadSegmentsPromise=r["AjaxHelper"].fetch({method:"API.getSegmentsMetadata",filter_limit:"-1",_hideImplementationData:0,idSites:t,idSite:n})}return this.loadSegmentsPromise.then(e=>(this.privateState.isLoading=!1,e&&(this.privateState.segments=t?e.filter(e=>e.sqlSegment&&e.sqlSegment.match(/log_visit\./)):e),this.state.value.segments)).finally(()=>{this.privateState.isLoading=!1,delete this.loadSegmentsPromise})}}var d=new l;const c={class:"segment-generator",ref:"root"},u={class:"segment-rows"},m={class:"segment-row"},p=["onClick"],g={class:"segment-loading"},h={class:"segment-row-inputs valign-wrapper"},v={class:"segment-input metricListBlock valign-wrapper"},O={style:{width:"100%"}},f={class:"segment-input metricMatchBlock valign-wrapper"},b={style:{display:"inline-block"}},j={class:"segment-input metricValueBlock valign-wrapper"},S={class:"form-group row",style:{width:"100%"}},C={class:"input-field col s12"},y=Object(a["createElementVNode"])("span",{role:"status","aria-live":"polite",class:"ui-helper-hidden-accessible"},null,-1),V=Object(a["createElementVNode"])("div",{class:"clear"},null,-1),k={class:"segment-or"},N=["onClick"],E=["innerHTML"],w={class:"segment-and"},A=["innerHTML"];function L(e,t,n,o,i,r){const s=Object(a["resolveComponent"])("ActivityIndicator"),l=Object(a["resolveComponent"])("MatomoLoader"),d=Object(a["resolveComponent"])("Field"),L=Object(a["resolveComponent"])("ValueInput");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",c,[Object(a["createVNode"])(s,{loading:e.isLoading},null,8,["loading"]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.conditions,(t,n)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])("segmentRow"+n),key:n},[Object(a["createElementVNode"])("div",u,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(t.orConditions,(n,o)=>{var i,r;return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])("orCondId"+n.id),key:o},[Object(a["createElementVNode"])("div",m,[Object(a["createElementVNode"])("a",{class:"segment-close",onClick:o=>e.removeOrCondition(t,n)},null,8,p),Object(a["createElementVNode"])("div",g,[Object(a["withDirectives"])(Object(a["createVNode"])(l,null,null,512),[[a["vShow"],e.conditionValuesLoading[n.id]]])]),Object(a["createElementVNode"])("div",h,[Object(a["createElementVNode"])("div",v,[Object(a["createElementVNode"])("div",O,[Object(a["createVNode"])(d,{uicontrol:"expandable-select",name:"segments","model-value":n.segment,"onUpdate:modelValue":t=>e.onSegmentSelection(t,n),title:null===(i=e.segments[n.segment])||void 0===i?void 0:i.name,"full-width":!0,options:e.segmentList},null,8,["model-value","onUpdate:modelValue","title","options"])])]),Object(a["createElementVNode"])("div",f,[Object(a["createElementVNode"])("div",b,[Object(a["createVNode"])(d,{uicontrol:"select",name:"matchType","model-value":n.matches,"onUpdate:modelValue":t=>{n.matches=t,e.computeSegmentDefinition()},"full-width":!0,options:e.matches[null===(r=e.segments[n.segment])||void 0===r?void 0:r.type]},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",j,[Object(a["createElementVNode"])("div",S,[Object(a["createElementVNode"])("div",C,[y,Object(a["createVNode"])(L,{value:n.value,onUpdate:e=>{n.value=e,this.computeSegmentDefinition()}},null,8,["value","onUpdate"])])])]),V])]),Object(a["createElementVNode"])("div",k,Object(a["toDisplayString"])(e.translate("SegmentEditor_OperatorOR")),1)],2)}),128)),Object(a["createElementVNode"])("div",{class:"segment-add-or",onClick:n=>e.addNewOrCondition(t)},[Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("a",{innerHTML:e.$sanitize(e.addNewOrConditionLinkText)},null,8,E)])],8,N)]),Object(a["createElementVNode"])("div",w,Object(a["toDisplayString"])(e.translate("SegmentEditor_OperatorAND")),1)],2))),128)),Object(a["createElementVNode"])("div",{class:"segment-add-row initial",onClick:t[0]||(t[0]=t=>e.addNewAndCondition())},[Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("a",{innerHTML:e.$sanitize(e.addNewAndConditionLinkText)},null,8,A)])])],512)}var I=n("a5a2");const _=["placeholder","title","value"];function x(e,t,n,o,i,r){return Object(a["openBlock"])(),Object(a["createElementBlock"])("input",{placeholder:e.translate("General_Value"),type:"text",class:"autocomplete",title:e.translate("General_Value"),autocomplete:"off",value:e.value,onKeydown:t[0]||(t[0]=t=>e.onKeydownOrConditionValue(t)),onChange:t[1]||(t[1]=t=>e.onKeydownOrConditionValue(t))},null,40,_)}var B=Object(a["defineComponent"])({props:{value:null},created(){this.onKeydownOrConditionValue=Object(r["debounce"])(this.onKeydownOrConditionValue,50)},emits:["update"],methods:{onKeydownOrConditionValue(e){this.$emit("update",e.target.value)}}});B.render=x;var D=B;function M(){return{metric:[{key:"==",value:Object(r["translate"])("General_OperationEquals")},{key:"!=",value:Object(r["translate"])("General_OperationNotEquals")},{key:"<=",value:Object(r["translate"])("General_OperationAtMost")},{key:">=",value:Object(r["translate"])("General_OperationAtLeast")},{key:"<",value:Object(r["translate"])("General_OperationLessThan")},{key:">",value:Object(r["translate"])("General_OperationGreaterThan")}],dimension:[{key:"==",value:Object(r["translate"])("General_OperationIs")},{key:"!=",value:Object(r["translate"])("General_OperationIsNot")},{key:"=@",value:Object(r["translate"])("General_OperationContains")},{key:"!@",value:Object(r["translate"])("General_OperationDoesNotContain")},{key:"=^",value:Object(r["translate"])("General_OperationStartsWith")},{key:"=$",value:Object(r["translate"])("General_OperationEndsWith")}]}}function P(){let e="";const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(let n=1;n<=10;n+=1)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function $(e){const t=["==","!=","<=",">=","=@","!@","<",">","=^","=$"],n={};let o,i,a=e.length,r=!1;for(let l=0;l<t.length;l+=1)o=t[l],i=e.indexOf(o),-1!==i&&i<a&&(a=i,1===o.length&&(r=!0));a<e.length&&(!0===r?(n.segment=e.slice(0,a),n.matches=e.slice(a,a+1),n.value=decodeURIComponent(e.slice(a+1))):(n.segment=e.slice(0,a),n.matches=e.slice(a,a+2),n.value=decodeURIComponent(e.slice(a+2))),'""'===n.value&&(n.value=""));try{n.value=decodeURIComponent(n.value)}catch(s){}return n}function G(e){return e?(""+e).replace(/(<([^>]+)>)/gi,""):e}const{$:q}=window;var T=Object(a["defineComponent"])({props:{addInitialCondition:Boolean,visitSegmentsOnly:Boolean,idsite:{type:[String,Number],default:()=>r["Matomo"].idSite},modelValue:{type:String,default:""}},components:{ActivityIndicator:r["ActivityIndicator"],Field:I["Field"],MatomoLoader:r["MatomoLoader"],ValueInput:D},data(){return{conditions:[],queriedSegments:[],matches:M(),conditionValuesLoading:{},segmentDefinition:""}},emits:["update:modelValue"],watch:{modelValue(e){(e||"")!==(this.segmentDefinition||"")&&this.setSegmentString(e)},conditions:{deep:!0,handler(){this.computeSegmentDefinition()}},segmentDefinition(e){(e||"")!==(this.modelValue||"")&&this.$emit("update:modelValue",e)},idsite(e){this.reloadSegments(e,this.visitSegmentsOnly)}},created(){this.matches[""]=this.matches.dimension,this.setSegmentString(this.modelValue),this.segmentDefinition=this.modelValue,this.reloadSegments(this.idsite,this.visitSegmentsOnly)},methods:{reloadSegments(e,t){d.loadSegments(e,t).then(e=>{this.queriedSegments=e.map(e=>Object.assign(Object.assign({},e),{},{category:e.category||"Others"})),this.addInitialCondition&&0===this.conditions.length&&this.addNewAndCondition()})},addAndCondition(e){this.conditions.push(e)},addNewOrCondition(e){if(!this.firstSegment)return;const t={segment:this.firstSegment,matches:this.firstMatch,value:""};this.addOrCondition(e,t)},addOrCondition(e,t){this.conditionValuesLoading[t.id]=!1,t.id=P(),e.orConditions.push(t),Object(a["nextTick"])(()=>{this.updateAutocomplete(t)})},onSegmentSelection(e,t){t.segment=e,this.updateAutocomplete(t),this.computeSegmentDefinition(),this.focusValueInput(t)},updateAutocomplete(e){this.conditionValuesLoading[e.id]=!0,q(`.orCondId${e.id} .metricValueBlock input`,this.$refs.root).autocomplete({source:[],minLength:0});const t=new AbortController;let n=!1;r["AjaxHelper"].fetch({module:"API",format:"json",method:"API.getSuggestedValuesForSegment",segmentName:e.segment,idSite:this.idsite},{createErrorNotification:!1}).then(t=>{this.conditionValuesLoading[e.id]=!1,n=!0;let o=t;Array.isArray(o)&&(o=o.map(e=>""+e));const i=q(`.orCondId${e.id} .metricValueBlock input`).autocomplete({source:o,minLength:0,select:(t,n)=>{t.preventDefault(),e.value=n.item.value,this.computeSegmentDefinition(),this.$forceUpdate()}}).off("click").click(()=>{q(i).autocomplete("search",e.value)})}).catch(()=>{n=!0,this.conditionValuesLoading[e.id]=!1,q(`.orCondId${e.id} .metricValueBlock input`).autocomplete({source:[],minLength:0}).autocomplete("search",e.value)}),setTimeout(()=>{n||t.abort()},2e4)},removeOrCondition(e,t){const n=e.orConditions.indexOf(t);if(n>-1&&e.orConditions.splice(n,1),0===e.orConditions.length){const t=this.conditions.indexOf(e);n>-1&&this.conditions.splice(t,1)}},setSegmentString(e){if(this.conditions=[],!e)return;const t=e.split(";").map(e=>e.split(","));this.conditions=t.map(e=>{const t={orConditions:[]};return e.forEach(e=>{const n=$(e);this.addOrCondition(t,n)}),t})},addNewAndCondition(){const e={orConditions:[]};this.firstSegment&&(this.addAndCondition(e),this.addNewOrCondition(e))},computeSegmentDefinition(){let e="";this.conditions.forEach(t=>{if(!t.orConditions.length)return;let n="";t.orConditions.forEach(e=>{if(!e.value&&!e.segment&&!e.matches)return;""!==n&&(n+=",");const t=encodeURIComponent(encodeURIComponent(e.value));n+=`${e.segment}${e.matches}${t}`}),""!==e&&(e+=";"),e+=n}),this.segmentDefinition=e},focusValueInput(e){const t=q(`.orCondId${e.id} .metricValueBlock input`);t.focus(),t.val()&&t.select()}},computed:{firstSegment(){var e;return(null===(e=this.queriedSegments[0])||void 0===e?void 0:e.segment)||null},firstMatch(){const e=this.queriedSegments[0];return e?e.type&&this.matches[e.type]?this.matches[e.type][0].key:this.matches[""][0].key:null},segments(){const e={};return this.queriedSegments.forEach(t=>{e[t.segment]=t}),e},segmentList(){return this.queriedSegments.map(e=>({group:e.category,key:e.segment,value:e.name,tooltip:e.acceptedValues?G(e.acceptedValues):void 0}))},addNewOrConditionLinkText(){return"+ "+Object(r["translate"])("SegmentEditor_AddANDorORCondition",`<span>${Object(r["translate"])("SegmentEditor_OperatorOR")}</span>`)},andConditionLabel(){return this.conditions.length?Object(r["translate"])("SegmentEditor_OperatorAND"):""},addNewAndConditionLinkText(){return"+ "+Object(r["translate"])("SegmentEditor_AddANDorORCondition",`<span>${this.andConditionLabel}</span>`)},isLoading(){return d.state.value.isLoading}}});T.render=L;var U=T;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin","SegmentEditor"],t):"object"===typeof exports?exports["PrivacyManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):e["PrivacyManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"],e["SegmentEditor"])})("undefined"!==typeof self?self:this,(function(e,t,n,a){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/PrivacyManager/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},f06f:function(e,t){e.exports=a},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ManageGdpr",(function(){return le})),n.d(t,"AnonymizeIp",(function(){return Pe})),n.d(t,"OptOutCustomizer",(function(){return at})),n.d(t,"AnonymizeLogData",(function(){return Rt})),n.d(t,"DoNotTrackPreference",(function(){return $t})),n.d(t,"ReportDeletionSettings",(function(){return Kt})),n.d(t,"DeleteOldLogs",(function(){return an})),n.d(t,"DeleteOldReports",(function(){return On})),n.d(t,"ScheduleReportDeletion",(function(){return An})),n.d(t,"AskingForConsent",(function(){return Jn})),n.d(t,"GdprOverview",(function(){return fa})),n.d(t,"PreviousAnonymizations",(function(){return Ia})),n.d(t,"PrivacySettings",(function(){return Ga})),n.d(t,"Compliance",(function(){return Oo})),n.d(t,"UsersOptOut",(function(){return fo})),"undefined"!==typeof window){var a=window.document.currentScript,o=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var i=n("8bbf");const l={class:"manageGdpr"},r={class:"intro"},c=Object(i["createElementVNode"])("br",null,null,-1),s=Object(i["createElementVNode"])("br",null,null,-1),d=Object(i["createElementVNode"])("br",null,null,-1),m=Object(i["createElementVNode"])("br",null,null,-1),u=["innerHTML"],b={class:"form-group row"},p={class:"col s12 input-field"},g={for:"gdprsite",class:"siteSelectorLabel"},O={class:"sites_autocomplete"},j={key:0,class:"form-group row segmentFilterGroup"},h={class:"col s12"},y={style:{margin:"8px 0",display:"inline-block"}},v={key:2,class:"dataUnavailable system notification notification-icon notification-info"},S=["innerHTML"],f={key:0,class:"system notification notification-icon notification-info"},V={class:"notification-body"},C=["innerHTML"],E=Object(i["createElementVNode"])("br",null,null,-1),N=Object(i["createElementVNode"])("br",null,null,-1),D=Object(i["createElementVNode"])("br",null,null,-1),k=Object(i["createElementVNode"])("br",null,null,-1),M={class:"checkInclude"},P={colspan:"8"},_=["title"],w={class:"checkInclude"},T=["title"],z={class:"visitId"},A={class:"visitorId"},B=["title","onClick"],I={class:"visitorIp"},x=["title","onClick"],L={class:"userId"},F=["title","onClick"],R=["title"],U=["src"],H=["title"],q=["src"],G=["title"],K=["src"],W=["title"],Y=["src"],J=["onClick"],Q=Object(i["createElementVNode"])("img",{src:"plugins/Live/images/visitorProfileLaunch.png",style:{"margin-right":"3.5px"}},null,-1),X={class:"ui-confirm",id:"confirmDeleteDataSubject",ref:"confirmDeleteDataSubject"},Z=["value"],ee=["value"];function te(e,t,n,a,o,$){const te=Object(i["resolveComponent"])("SiteSelector"),ne=Object(i["resolveComponent"])("SegmentGenerator"),ae=Object(i["resolveComponent"])("SaveButton"),oe=Object(i["resolveComponent"])("ContentBlock"),ie=Object(i["resolveComponent"])("Field"),le=Object(i["resolveDirective"])("content-table");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",l,[Object(i["createVNode"])(oe,{"content-title":e.translate("PrivacyManager_GdprTools")},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",r,[Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntro1"))+" ",1),c,s,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntro2"))+" ",1),d]),Object(i["createElementVNode"])("ol",null,[Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntroAccessRight")),1),Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntroEraseRight")),1)]),Object(i["createElementVNode"])("p",null,[m,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.overviewHintText)},null,8,u)])]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_SearchForDataSubject")),1),Object(i["createElementVNode"])("div",b,[Object(i["createElementVNode"])("div",p,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",g,Object(i["toDisplayString"])(e.translate("PrivacyManager_SelectWebsite")),1),Object(i["createElementVNode"])("div",O,[Object(i["createVNode"])(te,{id:"gdprsite",modelValue:e.site,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.site=t),t[1]||(t[1]=t=>e.changeSite(t))],"show-all-sites-item":!0,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["modelValue"])])])])]),e.isVisitorLogAndProfileEnabled?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",j,[Object(i["createElementVNode"])("div",h,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",y,Object(i["toDisplayString"])(e.translate("PrivacyManager_FindDataSubjectsBy")),1),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(ne,{modelValue:e.segment_filter,"onUpdate:modelValue":t[2]||(t[2]=t=>e.segment_filter=t),"visit-segments-only":!0,idsite:e.site.id,"show-segment-editor":!0},null,8,["modelValue","idsite"])])])])])):Object(i["createCommentVNode"])("",!0),e.isVisitorLogAndProfileEnabled?(Object(i["openBlock"])(),Object(i["createBlock"])(ae,{key:1,class:"findDataSubjects",value:e.translate("PrivacyManager_FindMatchingDataSubjects"),onConfirm:t[3]||(t[3]=t=>e.findDataSubjects()),disabled:!e.segment_filter,saving:e.isLoading},null,8,["value","disabled","saving"])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",v,[Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_SiteDataNotAvailable")),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_VisitorLogsProfilesDisabledMessage")),1),Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.siteSettingsTextSingle)},null,8,S)]))]),_:1},8,["content-title"]),e.allWebsitesContainsDisabledSite?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",f,[Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_SiteDataNotAvailableCertainSites")),1),Object(i["createElementVNode"])("div",V,[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_VisitorLogsProfilesSiteNamesDisabledMessage")),1),Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.siteSettingsText)},null,8,C)])])):Object(i["createCommentVNode"])("",!0),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_NoDataSubjectsFound")),1)],512),[[i["vShow"],!e.dataSubjects.length&&e.hasSearched]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_MatchingDataSubjects")),1),Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_VisitsMatchedCriteria"))+" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_ExportingNote"))+" ",1),E,Object(i["createTextVNode"])(),N,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_DeletionFromMatomoOnly"))+" ",1),D,k,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_ResultIncludesAllVisits")),1)]),Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("table",null,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",M,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(ie,{uicontrol:"checkbox",name:"activateAll","model-value":e.toggleAll,"onUpdate:modelValue":t[4]||(t[4]=t=>{e.toggleAll=t,e.toggleActivateAll()}),"full-width":!0},null,8,["model-value"])])]),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_Website")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_VisitId")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_VisitorID")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_VisitorIP")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_UserId")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_Details")),1),Object(i["withDirectives"])(Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_Action")),513),[[i["vShow"],e.profileEnabled]])])]),Object(i["createElementVNode"])("tbody",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("td",P,Object(i["toDisplayString"])(e.translate("PrivacyManager_ResultTruncated","400")),1)],512),[[i["vShow"],e.dataSubjects.length>400]]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.dataSubjects,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{title:`${e.translate("PrivacyManager_LastAction")}: ${t.lastActionDateTime}`,key:n},[Object(i["createElementVNode"])("td",w,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(ie,{uicontrol:"checkbox",name:"subject"+t.idVisit,modelValue:e.dataSubjectsActive[n],"onUpdate:modelValue":t=>e.dataSubjectsActive[n]=t,"full-width":!0},null,8,["name","modelValue","onUpdate:modelValue"])])]),Object(i["createElementVNode"])("td",{class:"site",title:`(${e.translate("General_Id")} ${t.idSite})`},Object(i["toDisplayString"])(t.siteName),9,T),Object(i["createElementVNode"])("td",z,Object(i["toDisplayString"])(t.idVisit),1),Object(i["createElementVNode"])("td",A,[Object(i["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddVisitorIdToSearch"),onClick:n=>e.addFilter("visitorId",t.visitorId)},Object(i["toDisplayString"])(t.visitorId),9,B)]),Object(i["createElementVNode"])("td",I,[Object(i["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddVisitorIPToSearch"),onClick:n=>e.addFilter("visitIp",t.visitIp)},Object(i["toDisplayString"])(t.visitIp),9,x)]),Object(i["createElementVNode"])("td",L,[Object(i["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddUserIdToSearch"),onClick:n=>e.addFilter("userId",t.userId)},Object(i["toDisplayString"])(t.userId),9,F)]),Object(i["createElementVNode"])("td",null,[Object(i["createElementVNode"])("span",{title:`${t.deviceType} ${t.deviceModel}`,style:{"margin-right":"3.5px"}},[Object(i["createElementVNode"])("img",{height:"16",src:t.deviceTypeIcon},null,8,U)],8,R),Object(i["createElementVNode"])("span",{title:t.operatingSystem,style:{"margin-right":"3.5px"}},[Object(i["createElementVNode"])("img",{height:"16",src:t.operatingSystemIcon},null,8,q)],8,H),Object(i["createElementVNode"])("span",{title:`${t.browser} ${t.browserFamilyDescription}`,style:{"margin-right":"3.5px"}},[Object(i["createElementVNode"])("img",{height:"16",src:t.browserIcon},null,8,K)],8,G),Object(i["createElementVNode"])("span",{title:`${t.country} ${t.region||""}`},[Object(i["createElementVNode"])("img",{height:"16",src:t.countryFlag},null,8,Y)],8,W)]),Object(i["withDirectives"])(Object(i["createElementVNode"])("td",null,[Object(i["createElementVNode"])("a",{class:"visitorLogTooltip",title:"View visitor profile",onClick:n=>e.showProfile(t.visitorId,t.idSite)},[Q,Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translate("Live_ViewVisitorProfile")),1)],8,J)],512),[[i["vShow"],e.profileEnabled]])],8,_))),128))])])),[[le]]),Object(i["createVNode"])(ae,{class:"exportDataSubjects",style:{"margin-right":"3.5px"},onConfirm:t[5]||(t[5]=t=>e.exportDataSubject()),disabled:!e.hasActiveDataSubjects,value:e.translate("PrivacyManager_ExportSelectedVisits")},null,8,["disabled","value"]),Object(i["createVNode"])(ae,{class:"deleteDataSubjects",onConfirm:t[6]||(t[6]=t=>e.deleteDataSubject()),disabled:!e.hasActiveDataSubjects||e.isDeleting,value:e.translate("PrivacyManager_DeleteSelectedVisits")},null,8,["disabled","value"])],512),[[i["vShow"],e.dataSubjects.length]]),Object(i["createElementVNode"])("div",X,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteVisitsConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Z),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,ee)],512)])}var ne=n("19dc"),ae=n("f06f"),oe=n("a5a2"),ie=Object(i["defineComponent"])({components:{ContentBlock:ne["ContentBlock"],SiteSelector:ne["SiteSelector"],SegmentGenerator:ae["SegmentGenerator"],SaveButton:oe["SaveButton"],Field:oe["Field"]},directives:{ContentTable:ne["ContentTable"]},data(){return{isLoading:!1,isDeleting:!1,site:{id:"all",name:Object(ne["translate"])("UsersManager_AllWebsites")},segment_filter:"visitId==",dataSubjects:[],toggleAll:!0,hasSearched:!1,profileEnabled:ne["Matomo"].visitorProfileEnabled,dataSubjectsActive:[],isVisitorLogAndProfileEnabled:!0,allWebsitesContainsDisabledSite:!1}},created(){this.changeSite(this.site)},watch:{site(e){"all"!==e.id?(this.allWebsitesContainsDisabledSite=!1,this.isLoading=!0,this.dataSubjects=[],this.hasSearched=!1,ne["AjaxHelper"].fetch({method:"Live.isVisitorProfileEnabled",idSite:e.id}).then(e=>{this.isVisitorLogAndProfileEnabled=e.value}).finally(()=>{this.isLoading=!1})):this.isVisitorLogAndProfileEnabled=!0}},setup(){const e=ne["AjaxHelper"].fetch({method:"SitesManager.getSitesIdWithAdminAccess",filter_limit:"-1"});return{getSites(){return e}}},methods:{changeSite(e){ne["AjaxHelper"].fetch({module:"API",method:"Live.isVisitorProfileEnabled",filter_limit:-1,idSite:e.id},{createErrorNotification:!1}).then(e=>{e.value||"userId=="!==this.segment_filter?e.value&&"visitId=="===this.segment_filter&&(this.segment_filter="userId=="):this.segment_filter="visitId=="}).catch(()=>{this.segment_filter="visitId=="})},showSuccessNotification(e){const t=ne["NotificationsStore"].show({message:e,context:"success",id:"manageGdpr",type:"transient"});setTimeout(()=>{ne["NotificationsStore"].scrollToNotification(t)},200)},linkTo(e,t="PrivacyManager"){return"?"+ne["MatomoUrl"].stringify(Object.assign(Object.assign({},ne["MatomoUrl"].urlParsed.value),{},{module:t,action:e}))},toggleActivateAll(){this.dataSubjectsActive.fill(this.toggleAll)},showProfile(e,t){ne["Matomo"].helper.showVisitorProfilePopup(e,t)},exportDataSubject(){const e=this.activatedDataSubjects;ne["AjaxHelper"].post({module:"API",method:"PrivacyManager.exportDataSubjects",format:"json",filter_limit:-1},{visits:e}).then(e=>{this.showSuccessNotification(Object(ne["translate"])("PrivacyManager_VisitsSuccessfullyExported")),ne["Matomo"].helper.sendContentAsDownload("exported_data_subjects.json",JSON.stringify(e))})},deleteDataSubject(){ne["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteDataSubject,{yes:()=>{this.isDeleting=!0;const e=this.activatedDataSubjects;ne["AjaxHelper"].post({module:"API",method:"PrivacyManager.deleteDataSubjects",filter_limit:-1},{visits:e}).then(()=>{this.dataSubjects=[],this.showSuccessNotification(Object(ne["translate"])("PrivacyManager_VisitsSuccessfullyDeleted")),this.findDataSubjects()}).finally(()=>{this.isDeleting=!1})}})},addFilter(e,t){this.segment_filter+=`,${e}==${t}`,this.findDataSubjects()},findDataSubjects(){this.dataSubjects=[],this.dataSubjectsActive=[],this.isLoading=!0,this.toggleAll=!0,this.hasSearched=!1,this.getSites().then(e=>{let t=this.site.id;"all"!==t||ne["Matomo"].hasSuperUserAccess||(t=e,Array.isArray(e)&&(t=e.join(","))),ne["AjaxHelper"].fetch({method:"Live.isVisitorProfileEnabled",idSite:t}).then(e=>{this.allWebsitesContainsDisabledSite=!e.value}),ne["AjaxHelper"].fetch({idSite:t,module:"API",method:"PrivacyManager.findDataSubjects",segment:this.segment_filter}).then(e=>{this.hasSearched=!0,this.dataSubjectsActive=e.map(()=>!0),this.dataSubjects=e}).finally(()=>{this.isLoading=!1})})}},computed:{hasActiveDataSubjects(){return!!this.activatedDataSubjects.length},activatedDataSubjects(){return this.dataSubjects.filter((e,t)=>this.dataSubjectsActive[t]).map(e=>({idsite:e.idSite,idvisit:e.idVisit}))},overviewHintText(){return Object(ne["translate"])("PrivacyManager_GdprToolsOverviewHint",`<a href="${this.linkTo("gdprOverview")}">`,"</a>")},siteSettingsText(){return Object(ne["translate"])("PrivacyManager_PleaseEnableVisitorLogsProfilesSites",`<a href="${this.linkTo("index","SitesManager")}">`,"</a>")},siteSettingsTextSingle(){return Object(ne["translate"])("PrivacyManager_PleaseEnableVisitorLogsProfiles",`<a href="${this.linkTo("index","SitesManager")}">`,"</a>")}}});ie.render=te;var le=ie;const re={class:"anonymizeSettings"},ce={class:"anonymizeIpSettingsField"},se={class:"maskLengthField"},de={class:"useAnonymizedIpForVisitEnrichmentField"},me={class:"anonymizeUserIdField"},ue=Object(i["createElementVNode"])("br",null,null,-1),be=Object(i["createElementVNode"])("br",null,null,-1),pe={class:"anonymizeOrderIdField"},ge={key:0,class:"forceCookielessTrackingField"},Oe=Object(i["createElementVNode"])("br",null,null,-1),je=Object(i["createElementVNode"])("br",null,null,-1),he={key:0},ye=Object(i["createElementVNode"])("br",null,null,-1),ve=Object(i["createElementVNode"])("br",null,null,-1),Se={class:"alert-warning alert"},fe={class:"anonymizeReferrerField"},Ve={class:"randomizeConfigIdField"},Ce={key:2,class:"footer-buttons"};function Ee(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveComponent"])("PasswordConfirmation"),d=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",re,[e.idSiteSpecific?(Object(i["openBlock"])(),Object(i["createBlock"])(r,{key:0,uicontrol:"radio",name:"useSiteSpecificSettings"+e.idSiteSpecific,title:e.translate("PrivacyManager_SiteAnonymizationConfig"),modelValue:e.actualUseSiteSpecificSettings,"onUpdate:modelValue":t[0]||(t[0]=t=>e.actualUseSiteSpecificSettings=t),options:e.useSiteSpecificSettingsOptions,"inline-help":e.useSiteSpecificSettingsHelpText},null,8,["name","title","modelValue","options","inline-help"])):Object(i["createCommentVNode"])("",!0),e.showSettings?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:1},[Object(i["createElementVNode"])("div",ce,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"anonymizeIpSettings"+e.idSiteSpecific,title:e.translate("PrivacyManager_UseAnonymizeIp"),modelValue:e.actualEnabled,"onUpdate:modelValue":t[1]||(t[1]=t=>e.actualEnabled=t),"inline-help":e.anonymizeIpEnabledHelp,"extra-metadata":e.getExtraMetadataForField("ipAnonymizerEnabled")},null,8,["name","title","modelValue","inline-help","extra-metadata"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",se,[Object(i["createVNode"])(r,{uicontrol:"radio",name:"maskLength"+e.idSiteSpecific,title:e.translate("PrivacyManager_AnonymizeIpMaskLengtDescription"),modelValue:e.actualMaskLength,"onUpdate:modelValue":t[2]||(t[2]=t=>e.actualMaskLength=t),options:e.maskLengthOptions,"inline-help":e.translate("PrivacyManager_GeolocationAnonymizeIpNote"),"extra-metadata":e.getExtraMetadataForField("ipAddressMaskLength")},null,8,["name","title","modelValue","options","inline-help","extra-metadata"])]),Object(i["createElementVNode"])("div",de,[Object(i["createVNode"])(r,{uicontrol:"radio",name:"useAnonymizedIpForVisitEnrichment"+e.idSiteSpecific,title:e.translate("PrivacyManager_UseAnonymizedIpForVisitEnrichment"),modelValue:e.actualUseAnonymizedIpForVisitEnrichment,"onUpdate:modelValue":t[3]||(t[3]=t=>e.actualUseAnonymizedIpForVisitEnrichment=t),options:e.useAnonymizedIpForVisitEnrichmentOptions,"inline-help":e.translate("PrivacyManager_UseAnonymizedIpForVisitEnrichmentNote"),"extra-metadata":e.getExtraMetadataForField("useAnonymizedIpForVisitEnrichment")},null,8,["name","title","modelValue","options","inline-help","extra-metadata"])])],512),[[i["vShow"],e.actualEnabled]]),Object(i["createElementVNode"])("div",me,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"anonymizeUserId"+e.idSiteSpecific,title:e.translate("PrivacyManager_PseudonymizeUserId"),modelValue:e.actualAnonymizeUserId,"onUpdate:modelValue":t[4]||(t[4]=t=>e.actualAnonymizeUserId=t),"extra-metadata":e.getExtraMetadataForField("anonymizeUserId")},{"inline-help":Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_PseudonymizeUserIdNote"))+" ",1),ue,be,Object(i["createElementVNode"])("em",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_PseudonymizeUserIdNote2")),1)]),_:1},8,["name","title","modelValue","extra-metadata"])]),Object(i["createElementVNode"])("div",pe,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"anonymizeOrderId"+e.idSiteSpecific,title:e.translate("PrivacyManager_UseAnonymizeOrderId"),modelValue:e.actualAnonymizeOrderId,"onUpdate:modelValue":t[5]||(t[5]=t=>e.actualAnonymizeOrderId=t),"inline-help":e.translate("PrivacyManager_AnonymizeOrderIdNote"),"extra-metadata":e.getExtraMetadataForField("anonymizeOrderId")},null,8,["name","title","modelValue","inline-help","extra-metadata"])]),e.idSiteSpecific?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ge,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"forceCookielessTracking",title:e.translate("PrivacyManager_ForceCookielessTracking"),modelValue:e.actualForceCookielessTracking,"onUpdate:modelValue":t[6]||(t[6]=t=>e.actualForceCookielessTracking=t),"extra-metadata":e.getExtraMetadataForField("forceCookielessTracking")},{"inline-help":Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescription",e.trackerFileName))+" ",1),Oe,je,Object(i["createElementVNode"])("em",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescription2")),1),e.trackerWritable?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",he,[ye,ve,Object(i["createElementVNode"])("p",Se,Object(i["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescriptionNotWritable",e.trackerFileName)),1)]))]),_:1},8,["title","modelValue","extra-metadata"])])),Object(i["createElementVNode"])("div",fe,[Object(i["createVNode"])(r,{uicontrol:"select",name:"anonymizeReferrer"+e.idSiteSpecific,title:e.translate("PrivacyManager_AnonymizeReferrer"),modelValue:e.actualAnonymizeReferrer,"onUpdate:modelValue":t[7]||(t[7]=t=>e.actualAnonymizeReferrer=t),options:e.referrerAnonymizationOptions,"inline-help":e.translate("PrivacyManager_AnonymizeReferrerNote"),"extra-metadata":e.getExtraMetadataForField("anonymizeReferrer")},null,8,["name","title","modelValue","options","inline-help","extra-metadata"])]),Object(i["createElementVNode"])("div",Ve,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"randomizeConfigId"+e.idSiteSpecific,title:e.translate("PrivacyManager_UseRandomizeConfigId"),modelValue:e.actualRandomizeConfigId,"onUpdate:modelValue":t[8]||(t[8]=t=>e.actualRandomizeConfigId=t),"inline-help":e.randomiseConfigIdHelpText,"extra-metadata":e.getExtraMetadataForField("randomizeConfigId")},null,8,["name","title","modelValue","inline-help","extra-metadata"])])],64)):Object(i["createCommentVNode"])("",!0),e.idSiteSpecific?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ce,[Object(i["createVNode"])(c,{onConfirm:t[9]||(t[9]=t=>e.shouldSave()),saving:e.isLoading},null,8,["saving"])])),Object(i["createVNode"])(s,{modelValue:e.showPasswordConfirmation,"onUpdate:modelValue":t[10]||(t[10]=t=>e.showPasswordConfirmation=t),onConfirmed:e.save,onAborted:e.abortPasswordConfirmation},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.passwordConfirmationTitle),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_ConfirmConfigRandomisationExplanation")),1)]),_:1},8,["modelValue","onConfirmed","onAborted"])])),[[d]])}function Ne(e){return!0===e||1===e||"1"===e?1:0}const De="system",ke="site-specific";var Me=Object(i["defineComponent"])({props:{ipAnonymizerEnabled:Boolean,anonymizeUserId:Boolean,ipAddressMaskLength:{type:[Number,String],required:!0},useAnonymizedIpForVisitEnrichment:{type:[Boolean,String,Number],default:0},anonymizeOrderId:Boolean,forceCookielessTracking:Boolean,anonymizeReferrer:String,maskLengthOptions:{type:Array,required:!0},useAnonymizedIpForVisitEnrichmentOptions:{type:Array,required:!0},trackerFileName:{type:String,required:!0},trackerWritable:{type:Boolean,required:!0},referrerAnonymizationOptions:{type:Object,required:!0},randomizeConfigId:Boolean,idSiteSpecific:{type:[String,Number]},useSiteSpecificSettings:{type:Boolean,default:!1},triggerSave:{type:Boolean,default:!1},extraMetadata:{type:Object,default:()=>({})}},components:{Field:oe["Field"],PasswordConfirmation:oe["PasswordConfirmation"],SaveButton:oe["SaveButton"]},directives:{Form:oe["Form"]},emits:["updated","aborted"],data(){return{isLoading:!1,actualEnabled:this.ipAnonymizerEnabled,actualUseSiteSpecificSettings:this.getActualUseSiteSpecificSettings(),actualMaskLength:+this.ipAddressMaskLength,actualUseAnonymizedIpForVisitEnrichment:Ne(this.useAnonymizedIpForVisitEnrichment),actualAnonymizeUserId:!!this.anonymizeUserId,actualAnonymizeOrderId:!!this.anonymizeOrderId,actualForceCookielessTracking:!!this.forceCookielessTracking,actualAnonymizeReferrer:this.anonymizeReferrer,actualRandomizeConfigId:!!this.randomizeConfigId,showPasswordConfirmation:!1}},methods:{shouldSave(){this.showSettings&&this.actualRandomizeConfigId?this.showPasswordConfirmation=!0:this.save()},abortPasswordConfirmation(){this.$emit("aborted")},save(e){this.isLoading=!0;const t={anonymizeIPEnable:Ne(this.actualEnabled),anonymizeUserId:Ne(this.actualAnonymizeUserId),anonymizeOrderId:Ne(this.actualAnonymizeOrderId),forceCookielessTracking:this.idSiteSpecific?void 0:Ne(this.actualForceCookielessTracking),anonymizeReferrer:this.actualAnonymizeReferrer?this.actualAnonymizeReferrer:"",ipAddressMaskLength:this.actualMaskLength,useAnonymizedIpForVisitEnrichment:this.actualUseAnonymizedIpForVisitEnrichment,randomizeConfigId:Ne(this.actualRandomizeConfigId),idSiteSpecific:this.idSiteSpecific?this.idSiteSpecific:void 0,useSiteSpecificSettings:this.idSiteSpecific?Ne(this.isSiteSpecificSettingsEnabled):void 0};e&&(t.passwordConfirmation=e),ne["AjaxHelper"].post({module:"API",method:"PrivacyManager.setAnonymizeIpSettings"},t).then(()=>{if(!this.idSiteSpecific){const e=ne["NotificationsStore"].show({message:Object(ne["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"toast"});ne["NotificationsStore"].scrollToNotification(e)}this.$emit("updated")}).catch(()=>{this.$emit("aborted")}).finally(()=>{this.isLoading=!1})},getActualUseSiteSpecificSettings(){return this.idSiteSpecific&&this.useSiteSpecificSettings?ke:De},randomiseConfigIdHelpText(){const e=Object(ne["translate"])("PrivacyManager_RandomizeConfigIdNote"),t=Object(ne["translate"])("PrivacyManager_RandomizeConfigIdNoteWarning","<strong>","</strong>");return`${e}<br><br>${t}`},getExtraMetadataForField(e){var t;return null===(t=this.extraMetadata)||void 0===t?void 0:t[e]}},computed:{anonymizeIpEnabledHelp(){const e=Object(ne["translate"])("PrivacyManager_AnonymizeIpInlineHelp"),t=Object(ne["translate"])("PrivacyManager_AnonymizeIpDescription");return`${e} ${t}`},passwordConfirmationTitle(){return this.idSiteSpecific?Object(ne["translate"])("PrivacyManager_ConfirmConfigRandomisationEnabledPerSite"):Object(ne["translate"])("PrivacyManager_ConfirmConfigRandomisationEnabled")},useSiteSpecificSettingsHelpText(){const e="?"+ne["MatomoUrl"].stringify(Object.assign(Object.assign({},ne["MatomoUrl"].urlParsed.value),{},{module:"PrivacyManager",action:"privacySettings"}));return Object(ne["translate"])("PrivacyManager_UseSiteSpecificSettingsHelpText",`<a href="${e}" rel="noreferrer noopener" target="_blank">`,"</a>",Object(ne["translate"])("PrivacyManager_UseSiteSpecificSettings"))},showSettings(){return!this.idSiteSpecific||this.isSiteSpecificSettingsEnabled},isSiteSpecificSettingsEnabled(){return this.idSiteSpecific&&this.actualUseSiteSpecificSettings===ke},useSiteSpecificSettingsOptions(){return[{value:Object(ne["translate"])("PrivacyManager_UseSystemSettings"),key:De},{value:Object(ne["translate"])("PrivacyManager_UseSiteSpecificSettings"),key:ke}]}},watch:{triggerSave(e){e&&this.shouldSave()}}});Me.render=Ee;var Pe=Me;const _e={class:"optOutCustomizer"},we=["innerHTML"],Te={key:0,id:"opt-out-styling"},ze=["value"],Ae=["value"],Be=["value"],Ie=["value"],xe=Object(i["createStaticVNode"])('<option value="px">px</option><option value="pt">pt</option><option value="em">em</option><option value="rem">rem</option><option value="%">%</option>',5),Le=[xe],Fe=["value"],Re=["src"],Ue={class:"form-group row"},He={class:"col s12 m6"},$e={for:"codeType1"},qe={for:"codeType2"},Ge={key:0},Ke={class:"col s12 m6"},We=["innerHTML"],Ye={ref:"pre"},Je=["innerHTML"],Qe={class:"system notification notification-info optOutTestReminder"},Xe=["innerHTML"];function Ze(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveDirective"])("copy-to-clipboard");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("div",_e,[Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("CoreAdminHome_OptOutExplanation"))+" ",1),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.readThisToLearnMore)},null,8,we)]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutAppearance")),1),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("span",null,[Object(i["createElementVNode"])("label",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"applyStyling",type:"checkbox",name:"applyStyling","onUpdate:modelValue":t[0]||(t[0]=t=>e.applyStyling=t),onKeydown:t[1]||(t[1]=t=>e.updateCode()),onChange:t[2]||(t[2]=t=>e.updateCode())},null,544),[[i["vModelCheckbox"],e.applyStyling]]),Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_ApplyStyling")),1)])])]),e.applyStyling?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Te,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_FontColor"))+": ",1),Object(i["createElementVNode"])("input",{type:"color",value:e.fontColor,onKeydown:t[3]||(t[3]=t=>e.onFontColorChange(t)),onChange:t[4]||(t[4]=t=>e.onFontColorChange(t))},null,40,ze)]),Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_BackgroundColor"))+": ",1),Object(i["createElementVNode"])("input",{type:"color",value:e.backgroundColor,onKeydown:t[5]||(t[5]=t=>e.onBgColorChange(t)),onChange:t[6]||(t[6]=t=>e.onBgColorChange(t))},null,40,Ae)]),Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_FontSize"))+": ",1),Object(i["createElementVNode"])("input",{id:"FontSizeInput",type:"number",min:"1",max:"100",value:e.fontSize,onKeydown:t[7]||(t[7]=t=>e.onFontSizeChange(t)),onChange:t[8]||(t[8]=t=>e.onFontSizeChange(t))},null,40,Be)]),Object(i["createElementVNode"])("span",null,[Object(i["createElementVNode"])("select",{class:"browser-default",value:e.fontSizeUnit,onKeydown:t[9]||(t[9]=t=>e.onFontSizeUnitChange(t)),onChange:t[10]||(t[10]=t=>e.onFontSizeUnitChange(t))},Le,40,Ie)]),Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_FontFamily"))+": ",1),Object(i["createElementVNode"])("input",{id:"FontFamilyInput",type:"text",value:e.fontFamily,onKeydown:t[11]||(t[11]=t=>e.onFontFamilyChange(t)),onChange:t[12]||(t[12]=t=>e.onFontFamilyChange(t))},null,40,Fe)])])])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("span",null,[Object(i["createElementVNode"])("label",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{id:"showIntro",type:"checkbox",name:"showIntro","onUpdate:modelValue":t[13]||(t[13]=t=>e.showIntro=t),onKeydown:t[14]||(t[14]=t=>e.updateCode()),onChange:t[15]||(t[15]=t=>e.updateCode())},null,544),[[i["vModelCheckbox"],e.showIntro]]),Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_ShowIntro")),1)])])]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutPreview")),1),Object(i["createElementVNode"])("iframe",{id:"previewIframe",style:{border:"1px solid #333",height:"200px",width:"600px"},src:e.iframeUrl,class:Object(i["normalizeClass"])({withBg:e.withBg})},null,10,Re)]),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",Ue,[Object(i["createElementVNode"])("div",He,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutHtmlCode")),1),Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("label",$e,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"radio",id:"codeType1",name:"codeType",value:"tracker","onUpdate:modelValue":t[16]||(t[16]=t=>e.codeType=t),onKeydown:t[17]||(t[17]=t=>e.updateCode()),onChange:t[18]||(t[18]=t=>e.updateCode())},null,544),[[i["vModelRadio"],e.codeType]]),Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutUseTracker")),1)])]),Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("label",qe,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"radio",id:"codeType2",name:"codeType",value:"selfContained","onUpdate:modelValue":t[19]||(t[19]=t=>e.codeType=t),onKeydown:t[20]||(t[20]=t=>e.updateCode()),onChange:t[21]||(t[21]=t=>e.updateCode())},null,544),[[i["vModelRadio"],e.codeType]]),Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutUseStandalone")),1)])]),"selfContained"===e.codeType?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ge,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"select",name:"language",modelValue:e.language,"onUpdate:modelValue":t[22]||(t[22]=t=>e.language=t),title:e.translate("General_Language"),options:e.languageOptions,onKeydown:t[23]||(t[23]=t=>e.updateCode()),onChange:t[24]||(t[24]=t=>e.updateCode())},null,8,["modelValue","title","options"])])])):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("div",Ke,[Object(i["createElementVNode"])("div",{class:"form-help",innerHTML:e.$sanitize(e.codeTypeHelp)},null,8,We)])])]),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("pre",Ye,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.codeBox)+"\n      ",1)])),[[c,{}]])]),Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.optOutExplanationIntro)},null,8,Je),Object(i["createElementVNode"])("div",Qe,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTest")),1)]),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestBody")),1),Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("ul",null,[Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestStep1")),1),Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestStep2")),1),Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestStep3")),1),Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutRememberToTestStep4")),1)])])]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_BuildYourOwn")),1),Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.optOutCustomOptOutLink)},null,8,Xe)])],64)}function et(e){const t=parseInt(e,16),n=t>>16&255,a=t>>8&255,o=255&t;return n>=225&&a>=225&&o>=225}const{$:tt}=window;var nt=Object(i["defineComponent"])({props:{currentLanguageCode:{type:String,required:!0},languageOptions:{type:Object,required:!0},matomoUrl:String},components:{Field:oe["Field"]},directives:{CopyToClipboard:ne["CopyToClipboard"]},data(){return{fontSizeUnit:"px",backgroundColor:"#FFFFFF",fontColor:"#000000",fontSize:"12",fontFamily:"Arial",showIntro:!0,applyStyling:!1,codeType:"tracker",code:"",language:this.currentLanguageCode}},created(){this.onFontColorChange=Object(ne["debounce"])(this.onFontColorChange,50),this.onBgColorChange=Object(ne["debounce"])(this.onBgColorChange,50),this.onFontSizeChange=Object(ne["debounce"])(this.onFontSizeChange,50),this.onFontSizeUnitChange=Object(ne["debounce"])(this.onFontSizeUnitChange,50),this.onFontFamilyChange=Object(ne["debounce"])(this.onFontFamilyChange,50),this.matomoUrl&&this.updateCode()},methods:{onFontColorChange(e){this.fontColor=e.target.value,this.updateCode()},onBgColorChange(e){this.backgroundColor=e.target.value,this.updateCode()},onFontSizeChange(e){this.fontSize=e.target.value,this.updateCode()},onFontSizeUnitChange(e){this.fontSizeUnit=e.target.value,this.updateCode()},onFontFamilyChange(e){this.fontFamily=e.target.value,this.updateCode()},updateCode(){let e="CoreAdminHome.getOptOutJSEmbedCode";"selfContained"===this.codeType&&(e="CoreAdminHome.getOptOutSelfContainedEmbedCode"),ne["AjaxHelper"].fetch({method:e,backgroundColor:this.backgroundColor.substr(1),fontColor:this.fontColor.substr(1),fontSize:this.fontSizeWithUnit,fontFamily:this.fontFamily,showIntro:!0===this.showIntro?1:0,applyStyling:!0===this.applyStyling?1:0,matomoUrl:this.matomoUrl,language:"selfContained"===this.codeType?this.language:"auto"}).then(e=>{this.code=e.value||""})}},watch:{codeBox(){const e=this.$refs.pre,t=tt(e).queue("fx").length>0;t||tt(e).effect("highlight",{},1500)}},computed:{fontSizeWithUnit(){return this.fontSize?`${this.fontSize}${this.fontSizeUnit}`:""},withBg(){return!!this.matomoUrl&&""===this.backgroundColor&&""!==this.fontColor&&et(this.fontColor.slice(1))},codeBox(){return this.matomoUrl?this.code:""},iframeUrl(){const e=ne["MatomoUrl"].stringify({module:"CoreAdminHome",action:"optOut",language:this.language,backgroundColor:this.backgroundColor.substr(1),fontColor:this.fontColor.substr(1),fontSize:this.fontSizeWithUnit,fontFamily:this.fontFamily,applyStyling:!0===this.applyStyling?1:0,showIntro:!0===this.showIntro?1:0});return`${this.matomoUrl}index.php?${e}`},readThisToLearnMore(){return Object(ne["translate"])("General_ReadThisToLearnMore",Object(ne["externalLink"])("https://matomo.org/faq/how-to/faq_25918/"),"</a>")},optOutExplanationIntro(){return Object(ne["translate"])("CoreAdminHome_OptOutExplanationIntro",`<a href="${this.iframeUrl}" rel="noreferrer noopener" target="_blank">`,"</a>")},optOutCustomOptOutLink(){const e="https://developer.matomo.org/guides/tracking-javascript-guide#optional-creating-a-custom-opt-out-form";return Object(ne["translate"])("CoreAdminHome_OptOutCustomOptOutLink",Object(ne["externalLink"])(e),"</a>")},codeTypeHelp(){return Object(ne["translate"])("PrivacyManager_OptOutCodeTypeExplanation")}}});nt.render=Ze;var at=nt;const ot={class:"anonymizeLogData"},it={class:"form-group row"},lt={class:"col s12 input-field"},rt={for:"anonymizeSite",class:"siteSelectorLabel"},ct={class:"sites_autocomplete"},st={class:"form-group row"},dt={class:"col s6 input-field"},mt={for:"anonymizeStartDate",class:"active"},ut=["value"],bt={class:"col s6 input-field"},pt={for:"anonymizeEndDate",class:"active"},gt=["value"],Ot={name:"anonymizeIp"},jt={name:"anonymizeLocation"},ht={name:"anonymizeTheUserId"},yt={class:"form-group row"},vt={class:"col s12 m6"},St={for:"visit_columns"},ft={class:"innerFormField",name:"visit_columns"},Vt=["onClick","title"],Ct={class:"col s12 m6"},Et={class:"form-help"},Nt={class:"inline-help"},Dt={class:"form-group row"},kt={class:"col s12"},Mt={class:"form-group row"},Pt={class:"col s12 m6"},_t={for:"action_columns"},wt={class:"innerFormField",name:"action_columns"},Tt=["onClick","title"],zt={class:"col s12 m6"},At={class:"form-help"},Bt={class:"inline-help"},It=Object(i["createElementVNode"])("span",{class:"icon-info"},null,-1);function xt(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("SiteSelector"),c=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SaveButton"),d=Object(i["resolveComponent"])("PasswordConfirmation");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ot,[Object(i["createElementVNode"])("div",it,[Object(i["createElementVNode"])("div",lt,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",rt,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeSites")),1),Object(i["createElementVNode"])("div",ct,[Object(i["createVNode"])(r,{id:"anonymizeSite",modelValue:e.site,"onUpdate:modelValue":t[0]||(t[0]=t=>e.site=t),"show-all-sites-item":!0,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["modelValue"])])])])]),Object(i["createElementVNode"])("div",st,[Object(i["createElementVNode"])("div",dt,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",mt,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeRowDataFrom")),1),Object(i["createElementVNode"])("input",{type:"text",id:"anonymizeStartDate",class:"anonymizeStartDate",ref:"anonymizeStartDate",name:"anonymizeStartDate",value:e.startDate,onKeydown:t[1]||(t[1]=t=>e.onKeydownStartDate(t)),onChange:t[2]||(t[2]=t=>e.onKeydownStartDate(t))},null,40,ut)])]),Object(i["createElementVNode"])("div",bt,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",pt,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeRowDataTo")),1),Object(i["createElementVNode"])("input",{type:"text",class:"anonymizeEndDate",id:"anonymizeEndDate",ref:"anonymizeEndDate",name:"anonymizeEndDate",value:e.endDate,onKeydown:t[3]||(t[3]=t=>e.onKeydownEndDate(t)),onChange:t[4]||(t[4]=t=>e.onKeydownEndDate(t))},null,40,gt)])])]),Object(i["createElementVNode"])("div",Ot,[Object(i["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeIp",title:e.translate("PrivacyManager_AnonymizeIp"),modelValue:e.anonymizeIp,"onUpdate:modelValue":t[5]||(t[5]=t=>e.anonymizeIp=t),introduction:e.translate("General_Visit"),"inline-help":e.translate("PrivacyManager_AnonymizeIpHelp")},null,8,["title","modelValue","introduction","inline-help"])]),Object(i["createElementVNode"])("div",jt,[Object(i["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeLocation",title:e.translate("PrivacyManager_AnonymizeLocation"),modelValue:e.anonymizeLocation,"onUpdate:modelValue":t[6]||(t[6]=t=>e.anonymizeLocation=t),"inline-help":e.translate("PrivacyManager_AnonymizeLocationHelp")},null,8,["title","modelValue","inline-help"])]),Object(i["createElementVNode"])("div",ht,[Object(i["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeTheUserId",title:e.translate("PrivacyManager_AnonymizeUserId"),modelValue:e.anonymizeUserId,"onUpdate:modelValue":t[7]||(t[7]=t=>e.anonymizeUserId=t),"inline-help":e.translate("PrivacyManager_AnonymizeUserIdHelp")},null,8,["title","modelValue","inline-help"])]),Object(i["createElementVNode"])("div",yt,[Object(i["createElementVNode"])("div",vt,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",St,Object(i["toDisplayString"])(e.translate("PrivacyManager_UnsetVisitColumns")),1),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.selectedVisitColumns,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])(`selectedVisitColumns selectedVisitColumns${n} multiple valign-wrapper`),key:n},[Object(i["createElementVNode"])("div",ft,[Object(i["createVNode"])(c,{uicontrol:"select",name:"visit_columns","model-value":t.column,"onUpdate:modelValue":n=>{t.column=n,e.onVisitColumnChange()},"full-width":!0,options:e.availableVisitColumns},null,8,["model-value","onUpdate:modelValue","options"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"icon-minus valign",onClick:t=>e.removeVisitColumn(n),title:e.translate("General_Remove")},null,8,Vt),[[i["vShow"],n+1!==e.selectedVisitColumns.length]])],2))),128))])]),Object(i["createElementVNode"])("div",Ct,[Object(i["createElementVNode"])("div",Et,[Object(i["createElementVNode"])("span",Nt,Object(i["toDisplayString"])(e.translate("PrivacyManager_UnsetVisitColumnsHelp")),1)])])]),Object(i["createElementVNode"])("div",Dt,[Object(i["createElementVNode"])("div",kt,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("General_Action")),1)])]),Object(i["createElementVNode"])("div",Mt,[Object(i["createElementVNode"])("div",Pt,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",_t,Object(i["toDisplayString"])(e.translate("PrivacyManager_UnsetActionColumns")),1),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.selectedActionColumns,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])(`selectedActionColumns selectedActionColumns${n} multiple valign-wrapper`),key:n},[Object(i["createElementVNode"])("div",wt,[Object(i["createVNode"])(c,{uicontrol:"select",name:"action_columns","model-value":t.column,"onUpdate:modelValue":n=>{t.column=n,e.onActionColumnChange()},"full-width":!0,options:e.availableActionColumns},null,8,["model-value","onUpdate:modelValue","options"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"icon-minus valign",onClick:t=>e.removeActionColumn(n),title:e.translate("General_Remove")},null,8,Tt),[[i["vShow"],n+1!==e.selectedActionColumns.length]])],2))),128))])]),Object(i["createElementVNode"])("div",zt,[Object(i["createElementVNode"])("div",At,[Object(i["createElementVNode"])("span",Bt,Object(i["toDisplayString"])(e.translate("PrivacyManager_UnsetActionColumnsHelp")),1)])])]),Object(i["createElementVNode"])("p",null,[It,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeProcessInfo")),1)]),Object(i["createVNode"])(s,{class:"anonymizePastData",onConfirm:t[8]||(t[8]=t=>e.showPasswordConfirmModal=!0),disabled:e.isAnonymizePastDataDisabled,value:e.translate("PrivacyManager_AnonymizeDataNow")},null,8,["disabled","value"]),Object(i["createVNode"])(d,{modelValue:e.showPasswordConfirmModal,"onUpdate:modelValue":t[9]||(t[9]=t=>e.showPasswordConfirmModal=t),onConfirmed:e.scheduleAnonymization},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeDataConfirm")),1)]),_:1},8,["modelValue","onConfirmed"])])}function Lt(e){return e<10?"0"+e:e}var Ft=Object(i["defineComponent"])({components:{PasswordConfirmation:oe["PasswordConfirmation"],SiteSelector:ne["SiteSelector"],Field:oe["Field"],SaveButton:oe["SaveButton"]},data(){const e=new Date,t=`${e.getFullYear()}-${Lt(e.getMonth()+1)}-${Lt(e.getDay()+1)}`;return{isLoading:!1,isDeleting:!1,anonymizeIp:!1,anonymizeLocation:!1,anonymizeUserId:!1,site:{id:"all",name:"All Websites"},availableVisitColumns:[],availableActionColumns:[],selectedVisitColumns:[{column:""}],selectedActionColumns:[{column:""}],startDate:t,endDate:t,showPasswordConfirmModal:!1}},created(){this.onKeydownStartDate=Object(ne["debounce"])(this.onKeydownStartDate,50),this.onKeydownEndDate=Object(ne["debounce"])(this.onKeydownEndDate,50),ne["AjaxHelper"].fetch({method:"PrivacyManager.getAvailableVisitColumnsToAnonymize"}).then(e=>{this.availableVisitColumns=[],e.forEach(e=>{this.availableVisitColumns.push({key:e.column_name,value:e.column_name})})}),ne["AjaxHelper"].fetch({method:"PrivacyManager.getAvailableLinkVisitActionColumnsToAnonymize"}).then(e=>{this.availableActionColumns=[],e.forEach(e=>{this.availableActionColumns.push({key:e.column_name,value:e.column_name})})}),setTimeout(()=>{const e=ne["Matomo"].getBaseDatePickerOptions(null),t=ne["Matomo"].getBaseDatePickerOptions(null);$(this.$refs.anonymizeStartDate).datepicker(e),$(this.$refs.anonymizeEndDate).datepicker(t)})},methods:{onVisitColumnChange(){const e=this.selectedVisitColumns.every(e=>!(null===e||void 0===e||!e.column));e&&this.addVisitColumn()},addVisitColumn(){this.selectedVisitColumns.push({column:""})},removeVisitColumn(e){if(e>-1){const t=this.selectedVisitColumns.length-1;t===e?this.selectedVisitColumns[e]={column:""}:this.selectedVisitColumns.splice(e,1)}},onActionColumnChange(){const e=this.selectedActionColumns.every(e=>!(null===e||void 0===e||!e.column));e&&this.addActionColumn()},addActionColumn(){this.selectedActionColumns.push({column:""})},removeActionColumn(e){if(e>-1){const t=this.selectedActionColumns.length-1;t===e?this.selectedActionColumns[e]={column:""}:this.selectedActionColumns.splice(e,1)}},scheduleAnonymization(e){let t=`${this.startDate},${this.endDate}`;this.startDate===this.endDate&&(t=this.startDate);const n={date:t};n.idSites=this.site.id,n.anonymizeIp=this.anonymizeIp?"1":"0",n.anonymizeLocation=this.anonymizeLocation?"1":"0",n.anonymizeUserId=this.anonymizeUserId?"1":"0",n.unsetVisitColumns=this.selectedVisitColumns.filter(e=>!(null===e||void 0===e||!e.column)).map(e=>e.column),n.unsetLinkVisitActionColumns=this.selectedActionColumns.filter(e=>!(null===e||void 0===e||!e.column)).map(e=>e.column),n.passwordConfirmation=e,ne["AjaxHelper"].post({method:"PrivacyManager.anonymizeSomeRawData"},n).then(()=>{window.location.reload(!0)})},onKeydownStartDate(e){this.startDate=e.target.value},onKeydownEndDate(e){this.endDate=e.target.value}},computed:{isAnonymizePastDataDisabled(){return!this.anonymizeIp&&!this.anonymizeLocation&&!this.selectedVisitColumns&&!this.selectedActionColumns}}});Ft.render=xt;var Rt=Ft;function Ut(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"radio",name:"doNotTrack",modelValue:e.enabled,"onUpdate:modelValue":t[0]||(t[0]=t=>e.enabled=t),options:e.doNotTrackOptions,"inline-help":e.translate("PrivacyManager_DoNotTrack_Description")},null,8,["modelValue","options","inline-help"])]),Object(i["createVNode"])(c,{onConfirm:t[1]||(t[1]=t=>e.save()),saving:e.isLoading},null,8,["saving"])])),[[s]])}var Ht=Object(i["defineComponent"])({props:{dntSupport:Boolean,doNotTrackOptions:{type:Array,required:!0}},components:{Field:oe["Field"],SaveButton:oe["SaveButton"]},directives:{Form:oe["Form"]},data(){return{isLoading:!1,enabled:this.dntSupport?1:0}},methods:{save(){this.isLoading=!0;let e="deactivateDoNotTrack";this.enabled&&"0"!==this.enabled&&(e="activateDoNotTrack"),ne["AjaxHelper"].post({module:"API",method:"PrivacyManager."+e}).then(()=>{const e=ne["NotificationsStore"].show({message:Object(ne["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"transient"});ne["NotificationsStore"].scrollToNotification(e)}).finally(()=>{this.isLoading=!1})}}});Ht.render=Ut;var $t=Ht;function qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class Gt{constructor(){qt(this,"privateState",Object(i["reactive"])({settings:{},showEstimate:!1,loadingEstimation:!1,estimation:"",isModified:!1})),qt(this,"state",Object(i["computed"])(()=>Object(i["readonly"])(this.privateState))),qt(this,"enableDeleteReports",Object(i["computed"])(()=>this.state.value.settings.enableDeleteReports)),qt(this,"enableDeleteLogs",Object(i["computed"])(()=>this.state.value.settings.enableDeleteLogs)),qt(this,"currentRequest",void 0)}updateSettings(e){this.initSettings(e),this.privateState.isModified=!0}initSettings(e){this.privateState.settings=Object.assign(Object.assign({},this.privateState.settings),e),this.reloadDbStats()}savePurgeDataSettings(e,t,n){return this.privateState.isModified=!1,ne["AjaxHelper"].post({module:"API",method:e},Object.assign(Object.assign({},t),{},{enableDeleteLogs:t.enableDeleteLogs?"1":"0",enableDeleteReports:t.enableDeleteReports?"1":"0",passwordConfirmation:n})).then(()=>{const e=ne["NotificationsStore"].show({message:Object(ne["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"toast"});ne["NotificationsStore"].scrollToNotification(e)})}isEitherDeleteSectionEnabled(){return this.state.value.settings.enableDeleteLogs||this.state.value.settings.enableDeleteReports}isManualEstimationLinkShowing(){return window.$("#getPurgeEstimateLink").length>0}reloadDbStats(e){if(this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=void 0),!e&&(!this.isEitherDeleteSectionEnabled()||this.isManualEstimationLinkShowing()))return;this.privateState.loadingEstimation=!0,this.privateState.estimation="",this.privateState.showEstimate=!1;const{settings:t}=this.privateState,n=Object.assign(Object.assign({},t),{},{enableDeleteLogs:t.enableDeleteLogs?"1":"0",enableDeleteReports:t.enableDeleteReports?"1":"0"});!0===e&&(n.forceEstimate=1),this.currentRequest=new AbortController,ne["AjaxHelper"].post({module:"PrivacyManager",action:"getDatabaseSize",format:"html"},n,{abortController:this.currentRequest,format:"html"}).then(e=>{this.privateState.estimation=e,this.privateState.showEstimate=!0,this.privateState.loadingEstimation=!1}).finally(()=>{this.currentRequest=void 0,this.privateState.loadingEstimation=!1})}}var Kt=new Gt;const Wt={id:"formDeleteSettings"},Yt={id:"deleteLogSettingEnabled"},Jt={class:"alert alert-warning deleteOldLogsWarning",style:{width:"50%"}},Qt=["href"],Xt={id:"deleteLogSettings"},Zt={key:0},en={key:1};function tn(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveComponent"])("PasswordConfirmation"),d=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Wt,[Object(i["createElementVNode"])("div",Yt,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteEnable","model-value":e.enabled,"onUpdate:modelValue":t[0]||(t[0]=t=>{e.enabled=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_UseDeleteLog"),"inline-help":e.translate("PrivacyManager_DeleteRawDataInfo")},null,8,["model-value","title","inline-help"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",Jt,[Object(i["createElementVNode"])("a",{href:e.externalRawLink("https://matomo.org/faq/general/faq_125"),rel:"noreferrer noopener",target:"_blank"},Object(i["toDisplayString"])(e.translate("General_ClickHere")),9,Qt)],512),[[i["vShow"],e.enabled]])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",Xt,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"text",name:"deleteOlderThan","model-value":e.deleteOlderThan,"onUpdate:modelValue":t[1]||(t[1]=t=>{e.deleteOlderThan=t,e.reloadDbStats()}),title:e.deleteOlderThanTitle,"inline-help":e.translate("PrivacyManager_LeastDaysInput","1")},null,8,["model-value","title","inline-help"])])],512),[[i["vShow"],e.enabled]]),Object(i["createVNode"])(c,{onConfirm:t[2]||(t[2]=e=>this.showPasswordConfirmModal=!0),saving:e.isLoading},null,8,["saving"]),Object(i["createVNode"])(s,{modelValue:e.showPasswordConfirmModal,"onUpdate:modelValue":t[3]||(t[3]=t=>e.showPasswordConfirmModal=t),onConfirmed:e.saveSettings},{default:Object(i["withCtx"])(()=>[e.enabled&&!e.enableDeleteReports?(Object(i["openBlock"])(),Object(i["createElementBlock"])("h2",Zt,Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteLogsConfirm")),1)):Object(i["createCommentVNode"])("",!0),e.enabled&&e.enableDeleteReports?(Object(i["openBlock"])(),Object(i["createElementBlock"])("h2",en,Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteBothConfirm")),1)):Object(i["createCommentVNode"])("",!0)]),_:1},8,["modelValue","onConfirmed"])])),[[d]])}var nn=Object(i["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{PasswordConfirmation:oe["PasswordConfirmation"],Field:oe["Field"],SaveButton:oe["SaveButton"]},directives:{Form:oe["Form"]},data(){return{isLoading:!1,enabled:1===parseInt(this.deleteData.config.delete_logs_enable,10),deleteOlderThan:this.deleteData.config.delete_logs_older_than,showPasswordConfirmModal:!1}},created(){setTimeout(()=>{Kt.initSettings(this.settings)})},methods:{saveSettings(e){const t="PrivacyManager.setDeleteLogsSettings";this.isLoading=!0,Kt.savePurgeDataSettings(t,this.settings,e).finally(()=>{this.isLoading=!1})},reloadDbStats(){Kt.updateSettings(this.settings)}},computed:{settings(){return{enableDeleteLogs:!!this.enabled,deleteLogsOlderThan:this.deleteOlderThan}},deleteOlderThanTitle(){return`${Object(ne["translate"])("PrivacyManager_DeleteLogsOlderThan")} (${Object(ne["translate"])("Intl_PeriodDays")})`},enableDeleteReports(){return!!Kt.enableDeleteReports.value}}});nn.render=tn;var an=nn;const on={id:"formDeleteSettings"},ln={id:"deleteReportsSettingEnabled"},rn={class:"alert alert-warning",style:{width:"50%"}},cn=Object(i["createElementVNode"])("br",null,null,-1),sn=Object(i["createElementVNode"])("br",null,null,-1),dn={id:"deleteReportsSettings"},mn={key:0},un={key:1};function bn(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveComponent"])("PasswordConfirmation"),d=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",on,[Object(i["createElementVNode"])("div",ln,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsEnable","model-value":e.enabled,"onUpdate:modelValue":t[0]||(t[0]=t=>{e.enabled=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_UseDeleteReports"),"inline-help":e.translate("PrivacyManager_DeleteAggregateReportsDetailedInfo")},null,8,["model-value","title","inline-help"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",rn,[Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteReportsInfo2",e.deleteOldLogsText)),1),cn,sn,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteReportsInfo3",e.deleteOldLogsText)),1)])],512),[[i["vShow"],e.enabled]])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",dn,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"text",name:"deleteReportsOlderThan","model-value":e.deleteOlderThan,"onUpdate:modelValue":t[1]||(t[1]=t=>{e.deleteOlderThan=t,e.reloadDbStats()}),title:e.deleteReportsOlderThanTitle,"inline-help":e.translate("PrivacyManager_LeastMonthsInput","1")},null,8,["model-value","title","inline-help"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepBasic","model-value":e.keepBasic,"onUpdate:modelValue":t[2]||(t[2]=t=>{e.keepBasic=t,e.reloadDbStats()}),title:e.deleteReportsKeepBasicTitle,"inline-help":e.translate("PrivacyManager_KeepBasicMetricsReportsDetailedInfo")},null,8,["model-value","title","inline-help"])]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_KeepDataFor")),1),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepDay","model-value":e.keepDataForDay,"onUpdate:modelValue":t[3]||(t[3]=t=>{e.keepDataForDay=t,e.reloadDbStats()}),title:e.translate("General_DailyReports")},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepWeek","model-value":e.keepDataForWeek,"onUpdate:modelValue":t[4]||(t[4]=t=>{e.keepDataForWeek=t,e.reloadDbStats()}),title:e.translate("General_WeeklyReports")},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepMonth","model-value":e.keepDataForMonth,"onUpdate:modelValue":t[5]||(t[5]=t=>{e.keepDataForMonth=t,e.reloadDbStats()}),title:`${e.translate("General_MonthlyReports")} (${e.translate("General_Recommended")})`},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepYear","model-value":e.keepDataForYear,"onUpdate:modelValue":t[6]||(t[6]=t=>{e.keepDataForYear=t,e.reloadDbStats()}),title:`${e.translate("General_YearlyReports")} (${e.translate("General_Recommended")})`},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepRange","model-value":e.keepDataForRange,"onUpdate:modelValue":t[7]||(t[7]=t=>{e.keepDataForRange=t,e.reloadDbStats()}),title:e.translate("General_RangeReports")},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepSegments","model-value":e.keepDataForSegments,"onUpdate:modelValue":t[8]||(t[8]=t=>{e.keepDataForSegments=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_KeepReportSegments")},null,8,["model-value","title"])])])],512),[[i["vShow"],e.enabled]]),Object(i["createVNode"])(c,{onConfirm:t[9]||(t[9]=e=>this.showPasswordConfirmModal=!0),saving:e.isLoading},null,8,["saving"]),Object(i["createVNode"])(s,{modelValue:e.showPasswordConfirmModal,"onUpdate:modelValue":t[10]||(t[10]=t=>e.showPasswordConfirmModal=t),onConfirmed:e.saveSettings},{default:Object(i["withCtx"])(()=>[e.enabled&&!e.enableDeleteLogs?(Object(i["openBlock"])(),Object(i["createElementBlock"])("h2",mn,Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteReportsConfirm")),1)):Object(i["createCommentVNode"])("",!0),e.enabled&&e.enableDeleteLogs?(Object(i["openBlock"])(),Object(i["createElementBlock"])("h2",un,Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteBothConfirm")),1)):Object(i["createCommentVNode"])("",!0)]),_:1},8,["modelValue","onConfirmed"])])),[[d]])}function pn(e){return e?"1":"0"}var gn=Object(i["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{Field:oe["Field"],SaveButton:oe["SaveButton"],PasswordConfirmation:oe["PasswordConfirmation"]},directives:{Form:oe["Form"]},data(){return{isLoading:!1,enabled:1===parseInt(this.deleteData.config.delete_reports_enable,10),deleteOlderThan:this.deleteData.config.delete_reports_older_than,keepBasic:1===parseInt(this.deleteData.config.delete_reports_keep_basic_metrics,10),keepDataForDay:1===parseInt(this.deleteData.config.delete_reports_keep_day_reports,10),keepDataForWeek:1===parseInt(this.deleteData.config.delete_reports_keep_week_reports,10),keepDataForMonth:1===parseInt(this.deleteData.config.delete_reports_keep_month_reports,10),keepDataForYear:1===parseInt(this.deleteData.config.delete_reports_keep_year_reports,10),keepDataForRange:1===parseInt(this.deleteData.config.delete_reports_keep_range_reports,10),keepDataForSegments:1===parseInt(this.deleteData.config.delete_reports_keep_segment_reports,10),showPasswordConfirmModal:!1}},created(){setTimeout(()=>{Kt.initSettings(this.settings)})},methods:{saveSettings(e){const t="PrivacyManager.setDeleteReportsSettings";this.isLoading=!0,Kt.savePurgeDataSettings(t,this.settings,e).finally(()=>{this.isLoading=!1})},reloadDbStats(){Kt.updateSettings(this.settings)}},computed:{settings(){return{enableDeleteReports:this.enabled,deleteReportsOlderThan:this.deleteOlderThan,keepBasic:pn(this.keepBasic),keepDay:pn(this.keepDataForDay),keepWeek:pn(this.keepDataForWeek),keepMonth:pn(this.keepDataForMonth),keepYear:pn(this.keepDataForYear),keepRange:pn(this.keepDataForRange),keepSegments:pn(this.keepDataForSegments)}},deleteOldLogsText(){return Object(ne["translate"])("PrivacyManager_UseDeleteLog")},deleteReportsOlderThanTitle(){const e=Object(ne["translate"])("PrivacyManager_DeleteReportsOlderThan");return`${e} (${Object(ne["translate"])("Intl_PeriodMonths")})`},deleteReportsKeepBasicTitle(){const e=Object(ne["translate"])("PrivacyManager_KeepBasicMetrics");return`${e} (${Object(ne["translate"])("General_Recommended")})`},enableDeleteLogs(){return!!Kt.enableDeleteLogs.value}}});gn.render=bn;var On=gn;const jn={id:"formDeleteSettings"},hn={id:"deleteSchedulingSettings"},yn={id:"deleteSchedulingSettingsInlineHelp",class:"inline-help-node"},vn={key:0},Sn=Object(i["createElementVNode"])("br",null,null,-1),fn=Object(i["createElementVNode"])("br",null,null,-1),Vn=Object(i["createElementVNode"])("br",null,null,-1),Cn=Object(i["createElementVNode"])("br",null,null,-1),En={key:0,id:"deleteDataEstimateSect",class:"form-group row"},Nn={class:"col s12",id:"databaseSizeHeadline"},Dn={class:"col s12 m6"},kn=["innerHTML"],Mn={class:"col s12 m6"},Pn={key:0,class:"form-help"},_n={class:"ui-confirm",id:"saveSettingsBeforePurge"},wn=["value"];function Tn(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("ActivityIndicator"),c=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SaveButton"),d=Object(i["resolveComponent"])("PasswordConfirmation"),m=Object(i["resolveComponent"])("ContentBlock"),u=Object(i["resolveDirective"])("form");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",jn,[Object(i["withDirectives"])(Object(i["createVNode"])(m,{id:"scheduleSettingsHeadline","content-title":e.translate("PrivacyManager_DeleteSchedulingSettings")},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",hn,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(c,{uicontrol:"select",name:"deleteLowestInterval",title:e.translate("PrivacyManager_DeleteDataInterval"),modelValue:e.deleteLowestInterval,"onUpdate:modelValue":t[1]||(t[1]=t=>e.deleteLowestInterval=t),options:e.scheduleDeletionOptions},{"inline-help":Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",yn,[e.deleteData.lastRun?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",vn,[Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_LastDelete"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.deleteData.lastRunPretty)+" ",1),Sn,fn])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_NextDelete"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.deleteData.nextRunPretty)+" ",1),Vn,Cn,Object(i["withDirectives"])(Object(i["createElementVNode"])("a",{id:"purgeDataNowLink",href:"#",onClick:t[0]||(t[0]=Object(i["withModifiers"])(t=>e.executeDataPurge(),["prevent"]))},Object(i["toDisplayString"])(e.translate("PrivacyManager_PurgeNow")),513),[[i["vShow"],e.showPurgeNowLink]]),Object(i["createVNode"])(r,{"loading-message":e.translate("PrivacyManager_PurgingData"),loading:e.loadingDataPurge},null,8,["loading-message","loading"]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{id:"db-purged-message"},Object(i["toDisplayString"])(e.translate("PrivacyManager_DBPurged")),513),[[i["vShow"],e.dataWasPurged]])])]),_:1},8,["title","modelValue","options"])])]),"1"===e.deleteData.config.enable_database_size_estimate||1===e.deleteData.config.enable_database_size_estimate?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",En,[Object(i["createElementVNode"])("h3",Nn,Object(i["toDisplayString"])(e.translate("PrivacyManager_ReportsDataSavedEstimate")),1),Object(i["createElementVNode"])("div",Dn,[Object(i["withDirectives"])(Object(i["createElementVNode"])("div",{id:"deleteDataEstimate",innerHTML:e.$sanitize(e.estimation)},null,8,kn),[[i["vShow"],e.showEstimate]]),Object(i["createTextVNode"])(" "),Object(i["createVNode"])(r,{loading:e.loadingEstimation},null,8,["loading"])]),Object(i["createElementVNode"])("div",Mn,["1"!==e.deleteData.config.enable_auto_database_size_estimate&&1!==e.deleteData.config.enable_auto_database_size_estimate?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Pn,[Object(i["createElementVNode"])("a",{id:"getPurgeEstimateLink",href:"#",onClick:t[2]||(t[2]=Object(i["withModifiers"])(t=>e.getPurgeEstimate(),["prevent"]))},Object(i["toDisplayString"])(e.translate("PrivacyManager_GetPurgeEstimate")),1)])):Object(i["createCommentVNode"])("",!0)])])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(s,{onConfirm:t[3]||(t[3]=t=>e.showPasswordConfirmModal=!0),saving:e.isLoading},null,8,["saving"]),Object(i["createVNode"])(d,{modelValue:e.showPasswordConfirmModal,"onUpdate:modelValue":t[4]||(t[4]=t=>e.showPasswordConfirmModal=t),onConfirmed:e.save},null,8,["modelValue","onConfirmed"]),Object(i["createVNode"])(d,{modelValue:e.showPasswordConfirmModalForPurge,"onUpdate:modelValue":t[5]||(t[5]=t=>e.showPasswordConfirmModalForPurge=t),onConfirmed:e.executePurgeNow},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_PurgeNowConfirm")),1)]),_:1},8,["modelValue","onConfirmed"])]),_:1},8,["content-title"]),[[i["vShow"],e.isEitherDeleteSectionEnabled]])])),[[u]]),Object(i["createElementVNode"])("div",_n,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_SaveSettingsBeforePurge")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Ok")},null,8,wn)])],64)}var zn=Object(i["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{ContentBlock:ne["ContentBlock"],ActivityIndicator:ne["ActivityIndicator"],Field:oe["Field"],SaveButton:oe["SaveButton"],PasswordConfirmation:oe["PasswordConfirmation"]},directives:{Form:oe["Form"]},data(){return{isLoading:!1,loadingDataPurge:!1,dataWasPurged:!1,showPurgeNowLink:!0,deleteLowestInterval:this.deleteData.config.delete_logs_schedule_lowest_interval,showPasswordConfirmModal:!1,showPasswordConfirmModalForPurge:!1}},methods:{save(e){const t="PrivacyManager.setScheduleReportDeletionSettings";Kt.savePurgeDataSettings(t,{deleteLowestInterval:this.deleteLowestInterval},e)},executeDataPurge(){Kt.state.value.isModified?ne["Matomo"].helper.modalConfirm("#saveSettingsBeforePurge",{yes:()=>null}):this.showPasswordConfirmModalForPurge=!0},getPurgeEstimate(){return Kt.reloadDbStats(!0)},executePurgeNow(e){return this.loadingDataPurge=!0,this.showPurgeNowLink=!1,ne["AjaxHelper"].post({module:"API",method:"PrivacyManager.executeDataPurge"},{passwordConfirmation:e}).then(()=>{Kt.reloadDbStats(),this.dataWasPurged=!0,setTimeout(()=>{this.dataWasPurged=!1,this.showPurgeNowLink=!0},2e3)}).catch(()=>{this.showPurgeNowLink=!0}).finally(()=>{this.loadingDataPurge=!1})}},computed:{showEstimate(){return Kt.state.value.showEstimate},isEitherDeleteSectionEnabled(){return Kt.isEitherDeleteSectionEnabled()},estimation(){return Kt.state.value.estimation},loadingEstimation(){return Kt.state.value.loadingEstimation}}});zn.render=Tn;var An=zn;const Bn=["innerHTML"],In=["innerHTML"],xn=["innerHTML"],Ln=Object(i["createElementVNode"])("br",null,null,-1),Fn=Object(i["createElementVNode"])("br",null,null,-1),Rn=["innerHTML"],Un=Object(i["createElementVNode"])("br",null,null,-1),Hn=Object(i["createElementVNode"])("br",null,null,-1),$n=["innerHTML"],qn=["innerHTML"],Gn=Object(i["createElementVNode"])("p",null,null,-1),Kn=["innerHTML"];function Wn(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("ContentBlock"),c=Object(i["resolveDirective"])("content-intro");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AskingForConsent")),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_ConsentExplanation")),1)])),[[c]]),e.consentManagerName?(Object(i["openBlock"])(),Object(i["createBlock"])(r,{key:0,"content-title":e.translate("PrivacyManager_ConsentManager"),class:"privacyAskingForConsent"},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.consentManagerDetectedText)},null,8,Bn),e.consentManagerIsConnected?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(e.translate("PrivacyManager_ConsentManagerConnected",e.consentManagerName))},null,8,In)):Object(i["createCommentVNode"])("",!0)]),_:1},8,["content-title"])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(r,{"content-title":e.translate("PrivacyManager_WhenDoINeedConsent"),class:"privacyAskingForConsent"},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.whenConsentIsNeeded1)},null,8,xn),Ln,Fn,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.whenConsentIsNeeded2)},null,8,Rn),Un,Hn,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.whenConsentIsNeeded3)},null,8,$n)])]),_:1},8,["content-title"]),Object(i["createVNode"])(r,{"content-title":e.translate("PrivacyManager_HowDoIAskForConsent"),class:"privacyAskingForConsent"},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_HowDoIAskForConsentIntro")),1),Object(i["createElementVNode"])("ul",{innerHTML:e.$sanitize(e.consentManagersList)},null,8,qn),Gn,Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.howDoIAskForConsentOthers)},null,8,Kn)]),_:1},8,["content-title"])])}var Yn=Object(i["defineComponent"])({props:{consentManagerName:{type:String,required:!0},consentManagerUrl:{type:String,required:!0},consentManagerIsConnected:{type:Boolean,required:!0},consentManagers:{type:Object,required:!0}},components:{ContentBlock:ne["ContentBlock"]},directives:{ContentIntro:ne["ContentIntro"]},computed:{whenConsentIsNeeded1(){return Object(ne["translate"])("PrivacyManager_WhenConsentIsNeededPart1",Object(ne["externalLink"])("https://matomo.org/faq/new-to-piwik/what-is-gdpr/"),"</a>")},whenConsentIsNeeded2(){const e="https://matomo.org/blog/2018/04/lawful-basis-for-processing-personal-data-under-gdpr-with-matomo/";return Object(ne["translate"])("PrivacyManager_WhenConsentIsNeededPart2",Object(ne["externalLink"])(e),"</a>")},whenConsentIsNeeded3(){return Object(ne["translate"])("PrivacyManager_WhenConsentIsNeededPart3",Object(ne["externalLink"])("https://matomo.org/faq/how-to/faq_35661/"),"</a>")},howDoIAskForConsentOthers(){return Object(ne["translate"])("PrivacyManager_HowDoIAskForConsentOutro",Object(ne["externalLink"])("https://developer.matomo.org/guides/tracking-consent"),"</a>")},consentManagersList(){let e="";return Object.entries(this.consentManagers).forEach(([t,n])=>{const a=Object(ne["externalRawLink"])(n);e+=`<li>  <a href="${a}"     target="_blank" rel="noreferrer noopener">    ${t} ${Object(ne["translate"])("PrivacyManager_ConsentManager")}  </a></li>`}),e},consentManagerDetectedText(){return Object(ne["translate"])("PrivacyManager_ConsentManagerDetected",this.consentManagerName,`<a href="${this.consentManagerUrl}" target="_blank" rel="noreferrer noopener">`,"</a>")}}});Yn.render=Wn;var Jn=Yn;const Qn={class:"gdprOverview"},Xn=Object(i["createElementVNode"])("br",null,null,-1),Zn=Object(i["createElementVNode"])("br",null,null,-1),ea=Object(i["createElementVNode"])("br",null,null,-1),ta=Object(i["createElementVNode"])("br",null,null,-1),na=["innerHTML"],aa=["innerHTML"],oa=["innerHTML"],ia=["innerHTML"],la=["innerHTML"],ra=["innerHTML"],ca=["innerHTML"],sa=["innerHTML"],da=["innerHTML"],ma=["innerHTML"],ua=["innerHTML"],ba=["innerHTML"],pa=["innerHTML"],ga=["innerHTML"],Oa=["innerHTML"],ja=["innerHTML"],ha=Object(i["createElementVNode"])("br",null,null,-1);function ya(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("VueEntryContainer"),c=Object(i["resolveComponent"])("ContentBlock"),s=Object(i["resolveDirective"])("content-intro");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Qn,[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprOverview")),1),Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprOverviewIntro1"))+" ",1),Xn,Zn,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprOverviewIntro2")),1)])])),[[s]]),Object(i["createVNode"])(r,{html:e.afterGDPROverviewIntroContent},null,8,["html"]),Object(i["createVNode"])(c,{"content-title":e.translate("PrivacyManager_GdprChecklists")},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprChecklistDesc1"))+" ",1),ea,ta,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.gdprChecklistDesc2)},null,8,na)])]),_:1},8,["content-title"]),Object(i["createVNode"])(c,{"content-title":e.translate("PrivacyManager_IndividualsRights")},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_IndividualsRightsIntro")),1),Object(i["createElementVNode"])("ol",null,[Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_IndividualsRightsInform")),1),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsAccess"))},null,8,aa),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsErasure"))},null,8,oa),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsRectification"))},null,8,ia),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsPortability"))},null,8,la),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.rightsLinkText("IndividualsRightsObject","usersOptOut"))},null,8,ra),Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_IndividualsRightsChildren")),1)])]),_:1},8,["content-title"]),Object(i["createVNode"])(c,{"content-title":e.translate("PrivacyManager_AwarenessDocumentation")},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AwarenessDocumentationIntro")),1),Object(i["createElementVNode"])("ol",null,[Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AwarenessDocumentationDesc1")),1),Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AwarenessDocumentationDesc2")),1),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.awarenessDocumentationDesc3)},null,8,ca),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.awarenessDocumentationDesc4)},null,8,sa)])]),_:1},8,["content-title"]),Object(i["createVNode"])(c,{"content-title":e.translate("PrivacyManager_SecurityProcedures")},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_SecurityProceduresIntro")),1),Object(i["createElementVNode"])("ol",null,[Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.securityProceduresDesc1)},null,8,da),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.securityProceduresDesc2)},null,8,ma),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.securityProceduresDesc3)},null,8,ua),Object(i["createElementVNode"])("li",{innerHTML:e.$sanitize(e.securityProceduresDesc4)},null,8,ba)])]),_:1},8,["content-title"]),Object(i["createVNode"])(c,{"content-title":e.translate("PrivacyManager_DataRetention")},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_DataRetentionInMatomo")),1),Object(i["createElementVNode"])("ul",null,[e.deleteLogsEnable?(Object(i["openBlock"])(),Object(i["createElementBlock"])("li",{key:0,innerHTML:e.$sanitize(e.translate("PrivacyManager_RawDataRemovedAfter",`<strong>${e.rawDataRetention}</strong>`))},null,8,pa)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("li",{key:1,innerHTML:e.$sanitize(e.translate("PrivacyManager_RawDataNeverRemoved"))},null,8,ga)),e.deleteReportsEnable?(Object(i["openBlock"])(),Object(i["createElementBlock"])("li",{key:2,innerHTML:e.$sanitize(e.translate("PrivacyManager_ReportsRemovedAfter",`<strong>${e.reportRetention}</strong>`))},null,8,Oa)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("li",{key:3,innerHTML:e.$sanitize(e.translate("PrivacyManager_ReportsNeverRemoved"))},null,8,ja))]),Object(i["createElementVNode"])("p",null,[ha,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_DataRetentionOverall")),1)])]),_:1},8,["content-title"])])}function va(e,t){return Object(ne["translate"])("PrivacyManager_"+e,Object(ne["externalLink"])(t),"</a>")}var Sa=Object(i["defineComponent"])({props:{afterGDPROverviewIntroContent:String,deleteLogsEnable:Boolean,deleteReportsEnable:Boolean,rawDataRetention:null,reportRetention:null},components:{ContentBlock:ne["ContentBlock"],VueEntryContainer:ne["VueEntryContainer"]},directives:{ContentIntro:ne["ContentIntro"]},methods:{rightsLinkText(e,t="gdprTools"){const n="?"+ne["MatomoUrl"].stringify({module:"PrivacyManager",action:t});return Object(ne["translate"])("PrivacyManager_"+e,`<a target="_blank" rel="noreferrer noopener" href="${n}">`,"</a>")}},computed:{gdprChecklistDesc2(){return va("GdprChecklistDesc2","https://matomo.org/docs/gdpr")},awarenessDocumentationDesc3(){return va("AwarenessDocumentationDesc3","https://matomo.org/faq/general/faq_18254/")},awarenessDocumentationDesc4(){return va("AwarenessDocumentationDesc4","https://matomo.org/blog/2018/04/gdpr-how-to-fill-in-the-information-asset-register-when-using-matomo/")},securityProceduresDesc1(){return va("SecurityProceduresDesc1","https://matomo.org/docs/security/")},securityProceduresDesc2(){return va("SecurityProceduresDesc2","https://ico.org.uk/for-organisations/guide-to-the-general-data-protection-regulation-gdpr/international-transfers/")},securityProceduresDesc3(){return va("SecurityProceduresDesc3","https://ico.org.uk/for-organisations/guide-to-the-general-data-protection-regulation-gdpr/personal-data-breaches/")},securityProceduresDesc4(){return va("SecurityProceduresDesc4","https://www.cnil.fr/en/guidelines-dpia")}}});Sa.render=ya;var fa=Sa;const Va={key:0},Ca=Object(i["createElementVNode"])("br",null,null,-1),Ea={key:1},Na=Object(i["createElementVNode"])("br",null,null,-1),Da={key:2},ka={key:3},Ma={key:0},Pa=["title"],_a={key:1},wa=["title"],Ta={key:2},za=["title"];function Aa(e,t,n,a,o,l){const r=Object(i["resolveDirective"])("content-table");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_PreviousRawDataAnonymizations")),1),Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("table",null,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_Requester")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AffectedIDSites")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AffectedDate")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_Anonymize")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_VisitColumns")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_LinkVisitActionColumns")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1)])]),Object(i["createElementVNode"])("tbody",null,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.anonymizations,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{key:n},[Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.requester),1),Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.sites.join(", ")),1),Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.date_start)+" - "+Object(i["toDisplayString"])(t.date_end),1),Object(i["createElementVNode"])("td",null,[t.anonymize_ip?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Va,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_IPAddress")),1),Ca])):Object(i["createCommentVNode"])("",!0),t.anonymize_location?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Ea,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Overlay_Location")),1),Na])):Object(i["createCommentVNode"])("",!0),t.anonymize_userid?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Da,Object(i["toDisplayString"])(e.translate("General_UserId")),1)):Object(i["createCommentVNode"])("",!0),t.anonymize_ip||t.anonymize_location||t.anonymize_userid?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",ka,"-"))]),Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.unset_visit_columns.join(", ")),1),Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.unset_link_visit_action_columns.join(", ")),1),Object(i["createElementVNode"])("td",null,[t.job_start_date?t.job_start_date&&!t.job_finish_date?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",_a,[Object(i["createElementVNode"])("span",{class:"icon-info",style:{cursor:"help"},title:`${e.translate("PrivacyManager_ScheduledDate",t.scheduled_date||"")}.\n${e.translate("PrivacyManager_JobStartDate",t.job_start_date)}.\n${e.translate("PrivacyManager_CurrentOutput",t.output)}`},null,8,wa),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_InProgress")),1)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Ta,[Object(i["createElementVNode"])("span",{class:"icon-info",style:{cursor:"help"},title:`${e.translate("PrivacyManager_ScheduledDate",t.scheduled_date||"")}.\n${e.translate("PrivacyManager_JobStartDate",t.job_start_date)}.\n${e.translate("PrivacyManager_JobFinishDate",t.job_finish_date)}.\n${e.translate("PrivacyManager_Output",t.output)}`},null,8,za),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_Done")),1)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Ma,[Object(i["createElementVNode"])("span",{class:"icon-info",style:{cursor:"help"},title:""+e.translate("PrivacyManager_ScheduledDate",t.scheduled_date||"")},null,8,Pa),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_Scheduled")),1)]))])]))),128))])])),[[r]])])}var Ba=Object(i["defineComponent"])({props:{anonymizations:{type:Array,required:!0}},directives:{ContentTable:ne["ContentTable"]}});Ba.render=Aa;var Ia=Ba;const xa=["innerHTML"],La=["innerHTML"],Fa={key:0},Ra=Object(i["createElementVNode"])("a",{name:"anonymizeHistoricalData",id:"anonymizeHistoricalData"},null,-1),Ua={key:1},Ha=Object(i["createElementVNode"])("br",null,null,-1);function $a(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("EnrichedHeadline"),c=Object(i["resolveComponent"])("AnonymizeIp"),s=Object(i["resolveComponent"])("ContentBlock"),d=Object(i["resolveComponent"])("DeleteOldLogs"),m=Object(i["resolveComponent"])("DeleteOldReports"),u=Object(i["resolveComponent"])("ScheduleReportDeletion"),b=Object(i["resolveComponent"])("AnonymizeLogData"),p=Object(i["resolveComponent"])("PreviousAnonymizations"),g=Object(i["resolveDirective"])("content-intro");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("h2",null,[Object(i["createVNode"])(r,{"help-url":e.externalRawLink("https://matomo.org/docs/privacy/")},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeData")),1)]),_:1},8,["help-url"])]),Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.teaserHeader),style:{"margin-right":"3.5px"}},null,8,xa),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.seeAlsoOurOfficialGuide)},null,8,La)])])),[[g]]),Object(i["createVNode"])(s,{id:"anonymizeIPAnchor","content-title":e.translate("PrivacyManager_UseAnonymizeTrackingData")},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(c,{"ip-anonymizer-enabled":e.ipAnonymizerEnabled,"anonymize-user-id":e.anonymizeUserId,"ip-address-mask-length":e.ipAddressMaskLength,"use-anonymized-ip-for-visit-enrichment":e.useAnonymizedIpForVisitEnrichment,"anonymize-order-id":e.anonymizeOrderId,"force-cookieless-tracking":e.forceCookielessTracking,"anonymize-referrer":e.anonymizeReferrer,"mask-length-options":e.maskLengthOptions,"use-anonymized-ip-for-visit-enrichment-options":e.useAnonymizedIpForVisitEnrichmentOptions,"tracker-file-name":e.trackerFileName,"tracker-writable":e.trackerWritable,"referrer-anonymization-options":e.referrerAnonymizationOptions,"randomize-config-id":e.randomizeConfigId,"extra-metadata":e.extraMetadata},null,8,["ip-anonymizer-enabled","anonymize-user-id","ip-address-mask-length","use-anonymized-ip-for-visit-enrichment","anonymize-order-id","force-cookieless-tracking","anonymize-referrer","mask-length-options","use-anonymized-ip-for-visit-enrichment-options","tracker-file-name","tracker-writable","referrer-anonymization-options","randomize-config-id","extra-metadata"])]),_:1},8,["content-title"]),e.isDataPurgeSettingsEnabled?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Fa,[Object(i["createVNode"])(s,{id:"deleteLogsAnchor","content-title":e.translate("PrivacyManager_DeleteOldRawData")},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteDataDescription")),1),Object(i["createVNode"])(d,{"is-data-purge-settings-enabled":e.isDataPurgeSettingsEnabled,"delete-data":e.deleteData,"schedule-deletion-options":e.scheduleDeletionOptions},null,8,["is-data-purge-settings-enabled","delete-data","schedule-deletion-options"])]),_:1},8,["content-title"]),Object(i["createVNode"])(s,{id:"deleteReportsAnchor","content-title":e.translate("PrivacyManager_DeleteOldAggregatedReports")},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(m,{"is-data-purge-settings-enabled":e.isDataPurgeSettingsEnabled,"delete-data":e.deleteData,"schedule-deletion-options":e.scheduleDeletionOptions},null,8,["is-data-purge-settings-enabled","delete-data","schedule-deletion-options"])]),_:1},8,["content-title"]),Object(i["createVNode"])(u,{"is-data-purge-settings-enabled":e.isDataPurgeSettingsEnabled,"delete-data":e.deleteData,"schedule-deletion-options":e.scheduleDeletionOptions},null,8,["is-data-purge-settings-enabled","delete-data","schedule-deletion-options"])])):Object(i["createCommentVNode"])("",!0),Ra,Object(i["createVNode"])(s,{"content-title":e.translate("PrivacyManager_AnonymizePreviousData"),class:"logDataAnonymizer"},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizePreviousDataDescription")),1),e.isSuperUser?(Object(i["openBlock"])(),Object(i["createBlock"])(b,{key:0})):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",Ua,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizePreviousDataOnlySuperUser")),1)),Ha,Object(i["createVNode"])(p,{anonymizations:e.anonymizations},null,8,["anonymizations"])]),_:1},8,["content-title"])])}var qa=Object(i["defineComponent"])({props:{ipAnonymizerEnabled:Boolean,anonymizeUserId:Boolean,ipAddressMaskLength:{type:Number,required:!0},useAnonymizedIpForVisitEnrichment:[Boolean,String,Number],anonymizeOrderId:Boolean,forceCookielessTracking:Boolean,anonymizeReferrer:String,maskLengthOptions:{type:Array,required:!0},useAnonymizedIpForVisitEnrichmentOptions:{type:Array,required:!0},trackerFileName:{type:String,required:!0},trackerWritable:{type:Boolean,required:!0},referrerAnonymizationOptions:{type:Object,required:!0},isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0},anonymizations:{type:Array,required:!0},isSuperUser:Boolean,randomizeConfigId:Boolean,extraMetadata:{type:Object,default:()=>({})}},components:{AnonymizeIp:Pe,EnrichedHeadline:ne["EnrichedHeadline"],ContentBlock:ne["ContentBlock"],DeleteOldLogs:an,DeleteOldReports:On,ScheduleReportDeletion:An,AnonymizeLogData:Rt,PreviousAnonymizations:Ia},directives:{ContentIntro:ne["ContentIntro"]},computed:{teaserHeader(){return Object(ne["translate"])("PrivacyManager_TeaserHeader",'<a href="#anonymizeIPAnchor">',"</a>",'<a href="#deleteLogsAnchor">',"</a>",'<a href="#anonymizeHistoricalData">',"</a>")},seeAlsoOurOfficialGuide(){return Object(ne["translate"])("PrivacyManager_SeeAlsoOurOfficialGuidePrivacy",Object(ne["externalLink"])("https://matomo.org/privacy/"),"</a>")}}});qa.render=$a;var Ga=qa;const Ka={for:"complianceSite"};function Wa(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("EnrichedHeadline"),c=Object(i["resolveComponent"])("SiteSelector"),s=Object(i["resolveComponent"])("ComplianceOverview");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("h2",null,[Object(i["createVNode"])(r,null,{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_Compliance")),1)]),_:1})]),Object(i["createElementVNode"])("label",Ka,Object(i["toDisplayString"])(e.translate("PrivacyManager_ComplianceSelectSite")),1),Object(i["createVNode"])(c,{id:"complianceSite","switch-site-on-select":!1,"show-selected-site":!0,modelValue:e.site,"onUpdate:modelValue":t[0]||(t[0]=t=>e.site=t)},null,8,["modelValue"]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.complianceTypes,t=>(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:t.id,"id-site":e.siteId,"compliance-type":t.id,title:t.title,description:t.description},null,8,["id-site","compliance-type","title","description"]))),128))],64)}async function Ya(){return ne["AjaxHelper"].fetch({method:"PrivacyManager.getCompliancePolicies"},{createErrorNotification:!1})}function Ja(e){const t=Object(i["reactive"])({idSite:null,loading:!1,complianceType:e,complianceModeEnforced:!1,complianceConfigControlled:!1,complianceRequirements:[],fetchComplianceError:null,saveComplianceError:null});function n(){return ne["AjaxHelper"].fetch({idSite:t.idSite,complianceType:t.complianceType,method:"PrivacyManager.getComplianceStatus"},{createErrorNotification:!1})}function a(e){t.complianceModeEnforced=e.complianceModeEnforced,t.complianceConfigControlled=e.complianceConfigControlled,t.complianceRequirements=e.complianceRequirements}function o(){t.idSite&&t.complianceType&&(t.loading=!0,t.fetchComplianceError=null,n().then(e=>{a(e)}).catch(e=>{t.fetchComplianceError=e.message||e}).finally(()=>{t.loading=!1}))}function l(e){t.idSite=e,o()}function r(e,n){t.loading=!0,t.saveComplianceError=null,ne["AjaxHelper"].post({idSite:t.idSite,complianceType:t.complianceType,enforce:e,method:"PrivacyManager.setComplianceStatus"},{createErrorNotification:!1,passwordConfirmation:n}).then(()=>{o()}).catch(e=>{t.saveComplianceError=e.message||e}).finally(()=>{t.loading=!1})}const c=Object(i["readonly"])(t);return{state:c,setIdSite:l,saveComplianceStatus:r}}const Qa=["innerHTML"],Xa={key:0,class:"notification system notification-error"},Za={key:0,class:"notification system notification-error"};function eo(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("ActivityIndicator"),c=Object(i["resolveComponent"])("ComplianceTable"),s=Object(i["resolveComponent"])("Field"),d=Object(i["resolveComponent"])("SaveButton"),m=Object(i["resolveComponent"])("PasswordConfirmation"),u=Object(i["resolveComponent"])("ContentBlock");return Object(i["openBlock"])(),Object(i["createBlock"])(u,{"content-title":e.title},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.description)},null,8,Qa),Object(i["createVNode"])(r,{loading:e.state.loading},null,8,["loading"]),e.state.loading?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[e.state.fetchComplianceError?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Xa,Object(i["toDisplayString"])(e.translate("General_ErrorTryAgain"))+" "+Object(i["toDisplayString"])(e.translate("General_ExceptionContactSupportGeneric",["",""])),1)):(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:1},[Object(i["createVNode"])(c,{results:e.state.complianceRequirements},null,8,["results"]),e.state.complianceConfigControlled?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createVNode"])(s,{uicontrol:"checkbox",name:"site-"+e.idSite+"-"+e.complianceType+"-enableFeature",title:e.translate("PrivacyManager_ComplianceEnforceCheckboxIntro"),introduction:e.translate("PrivacyManager_ComplianceEnforceCheckboxTitle"),"inline-help":e.translate("PrivacyManager_ComplianceEnforceCheckboxHelp"),modelValue:e.shouldEnforceComplianceMode,"onUpdate:modelValue":t[0]||(t[0]=t=>e.shouldEnforceComplianceMode=t)},null,8,["name","title","introduction","inline-help","modelValue"]),e.state.saveComplianceError?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Za,Object(i["toDisplayString"])(e.translate("General_ErrorTryAgain"))+" "+Object(i["toDisplayString"])(e.translate("General_ExceptionContactSupportGeneric",["",""])),1)):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(d,{class:Object(i["normalizeClass"])("site-"+e.idSite+"-"+e.complianceType+"-save"),onConfirm:t[1]||(t[1]=e=>this.showPasswordConfirmation=!0),value:e.translate("General_Save")},null,8,["class","value"]),Object(i["createVNode"])(m,{"model-value":this.showPasswordConfirmation,passwordFieldId:"password"+e.complianceType,onConfirmed:e.saveSettings,onAborted:e.resetSave},null,8,["model-value","passwordFieldId","onConfirmed","onAborted"])],64))],64))],64))]),_:1},8,["content-title"])}const to={class:"card-table dataTable compliance"},no={class:"label"},ao={class:"label"},oo={class:"label"},io=["innerHTML"];function lo(e,t,n,a,o,l){return Object(i["openBlock"])(),Object(i["createElementBlock"])("table",to,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",no,Object(i["toDisplayString"])(e.translate("PrivacyManager_ComplianceTableSettingName")),1),Object(i["createElementVNode"])("th",ao,Object(i["toDisplayString"])(e.translate("PrivacyManager_ComplianceTableSettingStatus")),1),Object(i["createElementVNode"])("th",oo,Object(i["toDisplayString"])(e.translate("PrivacyManager_ComplianceTableSettingNotes")),1)])]),Object(i["createElementVNode"])("tbody",null,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.results,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{key:n},[Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.name),1),Object(i["createElementVNode"])("td",{class:Object(i["normalizeClass"])(["status",e.getStatusClass(t.value)])},[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["icon",e.getIconClass(t.value)])},null,2),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate(e.getStatusText(t.value))),1)],2),Object(i["createElementVNode"])("td",{innerHTML:e.$sanitize(t.notes)},null,8,io)]))),128))])])}const ro={compliant:"compliant",non_compliant:"non-compliant",unknown:"unknown"},co={compliant:"icon-ok",non_compliant:"icon-close",unknown:"icon-circle"},so={compliant:"PrivacyManager_ComplianceCompliant",non_compliant:"PrivacyManager_ComplianceNonCompliant",unknown:"PrivacyManager_ComplianceComplianceUnknown"};var mo=Object(i["defineComponent"])({props:{results:{type:Array,required:!0}},methods:{getStatusClass(e){return ro[e]||ro.unknown},getIconClass(e){return co[e]||co.unknown},getStatusText(e){return so[e]||so.unknown}}});mo.render=lo;var uo=mo,bo=Object(i["defineComponent"])({props:{idSite:{type:String,required:!0},complianceType:{type:String,required:!0},title:{type:String,required:!0},description:{type:String,required:!0}},components:{PasswordConfirmation:oe["PasswordConfirmation"],SaveButton:oe["SaveButton"],Field:oe["Field"],ActivityIndicator:ne["ActivityIndicator"],ComplianceTable:uo,ContentBlock:ne["ContentBlock"]},methods:{saveSettings(e){this.saveComplianceStatus(this.shouldEnforceComplianceMode,e),this.showPasswordConfirmation=!1},resetSave(){this.showPasswordConfirmation=!1}},setup(e){const t=Ja(e.complianceType);t.setIdSite(e.idSite);const n=Object(i["ref"])(!1);return Object(i["watch"])(()=>t.state.complianceModeEnforced,e=>{n.value=e},{immediate:!0}),Object(i["watch"])(()=>e.idSite,e=>{e&&t.setIdSite(e)},{immediate:!0}),{state:t.state,saveComplianceStatus:t.saveComplianceStatus,shouldEnforceComplianceMode:n,showPasswordConfirmation:Object(i["ref"])(!1)}}});bo.render=eo;var po=bo,go=Object(i["defineComponent"])({components:{EnrichedHeadline:ne["EnrichedHeadline"],ComplianceOverview:po,SiteSelector:ne["SiteSelector"]},setup(){var e,t;const n=Object(i["ref"])({id:null!==(e=ne["Matomo"].idSite)&&void 0!==e?e:ne["MatomoUrl"].urlParsed.value.idSite,name:ne["Matomo"].siteName?ne["Matomo"].helper.htmlDecode(ne["Matomo"].siteName):Object(ne["translate"])("General_MultiSitesSummary")}),a=Object(i["ref"])(String(null!==(t=ne["Matomo"].idSite)&&void 0!==t?t:ne["MatomoUrl"].urlParsed.value.idSite));Object(i["watch"])(n,e=>{a.value=null!=(null===e||void 0===e?void 0:e.id)?String(e.id):""});const o=Object(i["ref"])([]);return Object(i["onMounted"])(async()=>{o.value=await Ya()}),{site:n,siteId:a,complianceTypes:o}}});go.render=Wa;var Oo=go;const jo={key:0},ho=Object(i["createElementVNode"])("br",null,null,-1),yo={key:1};function vo(e,t,n,a,o,l){const r=Object(i["resolveComponent"])("OptOutCustomizer"),c=Object(i["resolveComponent"])("ContentBlock"),s=Object(i["resolveComponent"])("Alert"),d=Object(i["resolveComponent"])("DoNotTrackPreference");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createVNode"])(c,{"content-title":e.translate("PrivacyManager_TrackingOptOut")},{default:Object(i["withCtx"])(()=>[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.prefaceComponentsResolved,(e,t)=>(Object(i["openBlock"])(),Object(i["createBlock"])(Object(i["resolveDynamicComponent"])(e),{key:t}))),128)),Object(i["createVNode"])(r,{"matomo-url":e.matomoUrl,language:e.language,"language-options":e.languageOptions},null,8,["matomo-url","language","language-options"])]),_:1},8,["content-title"]),e.isSuperUser?(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:0,id:"DNT","content-title":e.translate("PrivacyManager_DoNotTrack_SupportDNTPreference")},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(s,{severity:"warning"},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_Deprecated")),1)]),_:1}),Object(i["createElementVNode"])("p",null,[e.dntSupport?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",jo,[Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_Enabled")),1),ho,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_EnabledMoreInfo")),1)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",yo,Object(i["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_Disabled"))+" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_DoNotTrack_DisabledMoreInfo")),1))]),Object(i["createVNode"])(d,{"dnt-support":e.dntSupport,"do-not-track-options":e.doNotTrackOptions},null,8,["dnt-support","do-not-track-options"])]),_:1},8,["content-title"])):Object(i["createCommentVNode"])("",!0)])}var So=Object(i["defineComponent"])({props:{language:{type:String,required:!0},matomoUrl:String,isSuperUser:Boolean,dntSupport:Boolean,doNotTrackOptions:{type:Array,required:!0},languageOptions:{type:Object,required:!0}},components:{Alert:ne["Alert"],ContentBlock:ne["ContentBlock"],DoNotTrackPreference:$t,OptOutCustomizer:at},data(){return{prefaceComponents:[]}},computed:{prefaceComponentsResolved(){return Object(i["markRaw"])(this.prefaceComponents.map(e=>Object(i["markRaw"])(Object(ne["useExternalPluginComponent"])(e.plugin,e.component))))}},created(){const e=[];ne["Matomo"].postEvent("PrivacyManager.UsersOptOut.preface",e),this.prefaceComponents=e}});So.render=vo;var fo=So;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["MobileMessaging"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["MobileMessaging"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/MobileMessaging/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ReportParameters",(function(){return M})),n.d(t,"ManageSmsProvider",(function(){return T})),n.d(t,"SmsProviderCredentials",(function(){return F})),n.d(t,"DelegateMobileMessagingSettings",(function(){return R})),n.d(t,"ManageMobilePhoneNumbers",(function(){return je})),n.d(t,"SelectPhoneNumbers",(function(){return v})),n.d(t,"AdminPage",(function(){return Pe})),"undefined"!==typeof window){var o=window.document.currentScript,r=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var i=n("8bbf");const a={key:0};function l(e,t,n,o,r,l){const s=Object(i["resolveComponent"])("SelectPhoneNumbers");return e.report&&"mobile"===e.report.type?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",a,[Object(i["createVNode"])(s,{"phone-numbers":e.phoneNumbers,"with-introduction":!0,"model-value":e.report.phoneNumbers,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("change","phoneNumbers",t))},null,8,["phone-numbers","model-value"])])):Object(i["createCommentVNode"])("",!0)}const s={class:"mobile"},c={id:"mobilePhoneNumbersHelp",class:"inline-help-node"},d=Object(i["createElementVNode"])("span",{class:"icon-info",style:{"margin-right":"3.5px"}},null,-1),u={key:0,style:{"margin-right":"3.5px"}},m={key:1,style:{"margin-right":"3.5px"}},b=["href"];function p(e,t,n,o,r,a){const l=Object(i["resolveComponent"])("Field");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",s,[Object(i["createVNode"])(l,{uicontrol:"checkbox","var-type":"array",name:"phoneNumbers","model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t)),introduction:e.withIntroduction?e.translate("ScheduledReports_SendReportTo"):void 0,title:e.translate("MobileMessaging_PhoneNumbers"),disabled:0===e.phoneNumbers.length,options:e.phoneNumbers},{"inline-help":Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",c,[d,0===e.phoneNumbers.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",u,Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_NoPhoneNumbers")),1)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",m,Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_AdditionalPhoneNumbers")),1)),Object(i["createElementVNode"])("a",{href:e.linkTo({module:"MobileMessaging",action:"index",updated:null})},Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_MobileMessagingSettingsLink")),9,b)])]),_:1},8,["model-value","introduction","title","disabled","options"])])}var g=n("19dc"),h=n("a5a2"),j=Object(i["defineComponent"])({props:{modelValue:Array,phoneNumbers:{type:[Array,Object],required:!0},withIntroduction:Boolean},emits:["update:modelValue"],components:{Field:h["Field"]},methods:{linkTo(e){return"?"+g["MatomoUrl"].stringify(Object.assign(Object.assign({},g["MatomoUrl"].urlParsed.value),e))}}});j.render=p;var v=j;const O="mobile";var N=Object(i["defineComponent"])({props:{report:{type:Object,required:!0},phoneNumbers:{type:[Array,Object],required:!0}},components:{SelectPhoneNumbers:v},emits:["change"],created(){const{resetReportParametersFunctions:e,updateReportParametersFunctions:t,getReportParametersFunctions:n}=window;e[O]||(e[O]=e=>{e.phoneNumbers=[],e.formatmobile="sms"}),t[O]||(t[O]=e=>{null!==e&&void 0!==e&&e.parameters&&(e.parameters&&e.parameters.phoneNumbers&&(e.phoneNumbers=e.parameters.phoneNumbers),e.formatmobile="sms")}),n[O]||(n[O]=e=>{const t=e.phoneNumbers;return{phoneNumbers:t||[""]}})}});N.render=l;var M=N;const f=Object(i["createElementVNode"])("div",{id:"ajaxErrorManageSmsProviderSettings"},null,-1),C={key:0},S={key:0},y=Object(i["createElementVNode"])("br",null,null,-1),P={key:1},V=Object(i["createElementVNode"])("br",null,null,-1),A=["innerHTML"],E={key:1},_={id:"accountForm"},k=["innerHTML"];function B(e,t,n,o,r,a){const l=Object(i["resolveComponent"])("ActivityIndicator"),s=Object(i["resolveComponent"])("Alert"),c=Object(i["resolveComponent"])("Field"),d=Object(i["resolveComponent"])("SmsProviderCredentials"),u=Object(i["resolveComponent"])("SaveButton"),m=Object(i["resolveDirective"])("form");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createVNode"])(l,{loading:e.isDeletingAccount},null,8,["loading"]),f,e.credentialSupplied?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",C,[e.credentialError?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",S,[Object(i["createVNode"])(s,{severity:"danger"},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_CredentialInvalid",e.provider)),1),y,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.credentialError),1)]),_:1})])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",P,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_CredentialProvided",e.provider))+" "+Object(i["toDisplayString"])(e.creditLeft),1)),V,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.updateOrDeleteAccountText),onClick:t[0]||(t[0]=t=>e.onUpdateOrDeleteClick(t))},null,8,A)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",E,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PleaseSignUp")),1)),Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",_,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(c,{uicontrol:"select",name:"smsProviders",modelValue:e.smsProvider,"onUpdate:modelValue":t[1]||(t[1]=t=>e.smsProvider=t),title:e.translate("MobileMessaging_Settings_SMSProvider"),options:e.smsProviderOptions,value:e.provider},null,8,["modelValue","title","options","value"])]),Object(i["createVNode"])(d,{provider:e.smsProvider,modelValue:e.credentials,"onUpdate:modelValue":[t[2]||(t[2]=t=>e.credentials=t),t[3]||(t[3]=t=>{e.credentials=t})],"model-value":e.credentials},null,8,["provider","modelValue","model-value"]),Object(i["createVNode"])(u,{id:"apiAccountSubmit",disabled:!e.isUpdateAccountPossible,saving:e.isUpdatingAccount,onConfirm:t[4]||(t[4]=t=>e.updateAccount())},null,8,["disabled","saving"]),Object(i["createElementVNode"])("div",{class:"providerDescription",innerHTML:e.$sanitize(e.currentProviderDescription)},null,8,k)])),[[i["vShow"],!e.credentialSupplied||e.showAccountForm],[m]])])}const x={key:0};function w(e,t,n,o,r,a){const l=Object(i["resolveComponent"])("Field");return e.fields?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",x,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.fields,t=>{var n;return Object(i["openBlock"])(),Object(i["createBlock"])(l,{key:t.name,uicontrol:t.type,name:t.name,"model-value":null===(n=e.modelValue)||void 0===n?void 0:n[t.name],"onUpdate:modelValue":n=>e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{[t.name]:n})),title:e.translate(t.title)},null,8,["uicontrol","name","model-value","onUpdate:modelValue","title"])}),128))])):Object(i["createCommentVNode"])("",!0)}const U=Object(i["reactive"])({});var D=Object(i["defineComponent"])({props:{provider:{type:String,required:!0},modelValue:Object},emits:["update:modelValue"],components:{Field:h["Field"]},watch:{provider(){this.$emit("update:modelValue",null),this.getCredentialFields()}},created(){this.getCredentialFields()},methods:{getCredentialFields(){U[this.provider]?this.$emit("update:modelValue",Object.fromEntries(U[this.provider].map(e=>[e.name,null]))):g["AjaxHelper"].fetch({module:"MobileMessaging",action:"getCredentialFields",provider:this.provider}).then(e=>{this.$emit("update:modelValue",Object.fromEntries(e.map(e=>[e.name,null]))),U[this.provider]=e})}},computed:{fields(){return U[this.provider]}}});D.render=w;var F=D,H=Object(i["defineComponent"])({props:{credentialSupplied:Boolean,credentialError:String,provider:String,creditLeft:[Number,String],smsProviderOptions:{type:Object,required:!0},smsProviders:{type:Object,required:!0}},components:{Alert:g["Alert"],ActivityIndicator:g["ActivityIndicator"],Field:h["Field"],SaveButton:h["SaveButton"],SmsProviderCredentials:F},directives:{Form:h["Form"]},data(){return{isDeletingAccount:!1,isUpdatingAccount:!1,showAccountForm:!1,credentials:null,smsProvider:this.provider}},methods:{deleteApiAccount(){this.isDeletingAccount=!0,g["AjaxHelper"].fetch({method:"MobileMessaging.deleteSMSAPICredential"},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then(()=>{g["Matomo"].helper.redirect()}).finally(()=>{this.isDeletingAccount=!1})},showUpdateAccount(){this.showAccountForm=!0},updateAccount(){this.isUpdateAccountPossible&&(this.isUpdatingAccount=!0,g["AjaxHelper"].post({method:"MobileMessaging.setSMSAPICredential"},{provider:this.smsProvider,credentials:this.credentials},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then(()=>{g["Matomo"].helper.redirect()}).finally(()=>{this.isUpdatingAccount=!1}))},deleteAccount(){g["Matomo"].helper.modalConfirm("#confirmDeleteAccount",{yes:()=>{this.isDeletingAccount=!0,g["AjaxHelper"].fetch({method:"MobileMessaging.deleteSMSAPICredential"},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then(()=>{this.isDeletingAccount=!1,g["Matomo"].helper.redirect()}).finally(()=>{this.isDeletingAccount=!1})}})},onUpdateOrDeleteClick(e){const t=e.target;"displayAccountForm"===t.id?this.showUpdateAccount():"deleteAccount"===t.id&&this.deleteAccount()}},computed:{isUpdateAccountPossible(){return!!this.smsProvider&&null!==this.credentials&&Object.values(this.credentials).every(e=>!!e)},updateOrDeleteAccountText(){return Object(g["translate"])("MobileMessaging_Settings_UpdateOrDeleteAccount",'<a id="displayAccountForm">',"</a>",'<a id="deleteAccount">',"</a>")},currentProviderDescription(){return this.smsProvider&&this.smsProviders?this.smsProviders[this.smsProvider]:""}}});H.render=B;var T=H;function q(e,t,n,o,r,a){const l=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SaveButton");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"radio",name:"delegatedManagement",title:e.translate("MobileMessaging_Settings_LetUsersManageAPICredential"),modelValue:e.enabled,"onUpdate:modelValue":t[0]||(t[0]=t=>e.enabled=t),"full-width":!0,options:e.delegateManagementOptions},null,8,["title","modelValue","options"])]),Object(i["createVNode"])(s,{onConfirm:t[1]||(t[1]=t=>e.save()),saving:e.isLoading},null,8,["saving"])])}var L=Object(i["defineComponent"])({props:{delegateManagementOptions:{type:Array,required:!0},delegatedManagement:[Number,Boolean]},components:{Field:h["Field"],SaveButton:h["SaveButton"]},data(){return{isLoading:!1,enabled:this.delegatedManagement?1:0}},methods:{save(){this.isLoading=!0,g["AjaxHelper"].post({method:"MobileMessaging.setDelegatedManagement"},{delegatedManagement:this.enabled&&"0"!==this.enabled?"true":"false"}).then(()=>{const e=g["NotificationsStore"].show({message:Object(g["translate"])("CoreAdminHome_SettingsSaveSuccess"),id:"mobileMessagingSettings",type:"transient",context:"success"});g["NotificationsStore"].scrollToNotification(e),g["Matomo"].helper.redirect()}).finally(()=>{this.isLoading=!1})}}});L.render=q;var R=L;const I={key:0},$={class:"row"},G={class:"col s12"},Y={class:"form-group row"},z={class:"col s12 m6"},J={class:"col s12 m6 form-help"},K={class:"form-group row addPhoneNumber"},Q={class:"col s12 m6"},W={class:"countryCode left"},X=Object(i["createElementVNode"])("span",{class:"countryCodeSymbol"},"+",-1),Z={class:"phoneNumber left"},ee={class:"addNumber left valign-wrapper"},te={class:"col s12 m6 form-help"},ne={id:"ajaxErrorManagePhoneNumber",ref:"errorContainer"},oe=Object(i["createElementVNode"])("div",{id:"notificationManagePhoneNumber"},null,-1),re={key:1,class:"row"},ie={class:"col s12"},ae={class:"col s12 m6"},le={class:"phoneNumber"},se=["onUpdate:modelValue","placeholder"],ce={key:0,class:"form-help col s12 m6"},de=["onClick"],ue={class:"ui-confirm",id:"confirmDeletePhoneNumber"},me=["innerHTML"],be=["value"],pe=["value"];function ge(e,t,n,o,r,a){const l=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SaveButton"),c=Object(i["resolveComponent"])("Alert"),d=Object(i["resolveComponent"])("ActivityIndicator");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_Help")),1),e.isSuperUser?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",I,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DelegatedPhoneNumbersOnlyUsedByYou")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",$,[Object(i["createElementVNode"])("h3",G,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_Add")),1)]),Object(i["createElementVNode"])("div",Y,[Object(i["createElementVNode"])("div",z,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"select",name:"countryCodeSelect",title:e.translate("MobileMessaging_Settings_SelectCountry"),modelValue:e.countryCallingCode,"onUpdate:modelValue":t[0]||(t[0]=t=>e.countryCallingCode=t),"full-width":!0,options:e.countries},null,8,["title","modelValue","options"])])]),Object(i["createElementVNode"])("div",J,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_CountryCode_Help")),1)]),Object(i["createElementVNode"])("div",K,[Object(i["createElementVNode"])("div",Q,[Object(i["createElementVNode"])("div",W,[X,Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"text",name:"countryCallingCode",title:e.translate("MobileMessaging_Settings_CountryCode"),modelValue:e.countryCallingCode,"onUpdate:modelValue":t[1]||(t[1]=t=>e.countryCallingCode=t),"full-width":!0,maxlength:4},null,8,["title","modelValue"])])]),Object(i["createElementVNode"])("div",Z,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(l,{uicontrol:"text",name:"newPhoneNumber",modelValue:e.newPhoneNumber,"onUpdate:modelValue":t[2]||(t[2]=t=>e.newPhoneNumber=t),title:e.translate("MobileMessaging_Settings_PhoneNumber"),"full-width":!0,maxlength:80},null,8,["modelValue","title"])])]),Object(i["createElementVNode"])("div",ee,[Object(i["createVNode"])(s,{class:"valign",disabled:!e.canAddNumber||e.isUpdatingPhoneNumbers,onConfirm:t[3]||(t[3]=t=>e.addPhoneNumber()),value:e.translate("General_Add")},null,8,["disabled","value"])]),Object(i["withDirectives"])(Object(i["createVNode"])(c,{severity:"warning",id:"suspiciousPhoneNumber"},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_SuspiciousPhoneNumber","54184032")),1)]),_:1},512),[[i["vShow"],e.showSuspiciousPhoneNumber]])]),Object(i["createElementVNode"])("div",te,Object(i["toDisplayString"])(e.strHelpAddPhone),1)]),Object(i["createElementVNode"])("div",ne,null,512),oe,Object.keys(e.phoneNumbers||{}).length>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",re,[Object(i["createElementVNode"])("h3",ie,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_ManagePhoneNumbers")),1)])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(d,{loading:e.isUpdatingPhoneNumbers},null,8,["loading"]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.phoneNumbers||[],(t,n,o)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"form-group row",key:o},[Object(i["createElementVNode"])("div",ae,[Object(i["createElementVNode"])("span",le,Object(i["toDisplayString"])(n),1),t.verified?Object(i["createCommentVNode"])("",!0):Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("input",{key:0,type:"text",class:"verificationCode","onUpdate:modelValue":t=>e.validationCode[o]=t,placeholder:e.translate("MobileMessaging_Settings_EnterActivationCode"),style:{"margin-right":"3.5px"}},null,8,se)),[[i["vModelText"],e.validationCode[o]]]),t.verified?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:1,disabled:!e.validationCode[o]||e.isUpdatingPhoneNumbers,onConfirm:t=>e.validateActivationCode(n,o),value:e.translate("MobileMessaging_Settings_ValidatePhoneNumber")},null,8,["disabled","onConfirm","value"])),Object(i["createVNode"])(s,{disabled:e.isUpdatingPhoneNumbers,onConfirm:t=>e.removePhoneNumber(n),value:e.translate("General_Remove"),style:{"margin-left":"3.5px"}},null,8,["disabled","onConfirm","value"])]),t.verified?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ce,[Object(i["createElementVNode"])("div",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_VerificationCodeJustSent"))+" ",1),Object(i["createElementVNode"])("a",{onClick:t=>e.resendVerificationCode(n,o)},Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_ResendVerification")),9,de)]),Object(i["createTextVNode"])("   ")]))]))),128))]),Object(i["createElementVNode"])("div",ue,[Object(i["createElementVNode"])("h2",{innerHTML:e.$sanitize(e.removeNumberConfirmation)},null,8,me),Object(i["createElementVNode"])("input",{type:"button",role:"yes",value:e.translate("General_Yes")},null,8,be),Object(i["createElementVNode"])("input",{type:"button",role:"no",value:e.translate("General_No")},null,8,pe)])],64)}var he=Object(i["defineComponent"])({props:{isSuperUser:Boolean,defaultCallingCode:String,countries:{type:Array,required:!0},strHelpAddPhone:{type:String,required:!0}},components:{Field:h["Field"],SaveButton:h["SaveButton"],Alert:g["Alert"],ActivityIndicator:g["ActivityIndicator"]},data(){return{isUpdatingPhoneNumbers:!1,phoneNumbers:{},countryCallingCode:this.defaultCallingCode||"",newPhoneNumber:"",validationCode:{},numberToRemove:""}},mounted(){this.updatePhoneNumbers()},methods:{validateActivationCode(e,t){if(!this.validationCode[t])return;const n=this.validationCode[t];this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.validatePhoneNumber"},{phoneNumber:e,verificationCode:n},{errorElement:"#ajaxErrorManagePhoneNumber"}).then(e=>{let t;if(e&&e.value){const e=Object(g["translate"])("MobileMessaging_Settings_PhoneActivated");t=g["NotificationsStore"].show({message:e,placeat:"#notificationManagePhoneNumber",context:"success",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"}),this.updatePhoneNumbers()}else{const e=Object(g["translate"])("MobileMessaging_Settings_InvalidActivationCode");t=g["NotificationsStore"].show({message:e,placeat:"#notificationManagePhoneNumber",context:"error",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"})}g["NotificationsStore"].scrollToNotification(t)}).finally(()=>{this.validationCode[t]="",this.isUpdatingPhoneNumbers=!1})},resendVerificationCode(e){this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.resendVerificationCode"},{phoneNumber:e},{errorElement:"#ajaxErrorManagePhoneNumber"}).then(()=>{const e=Object(g["translate"])("MobileMessaging_Settings_NewVerificationCodeSent"),t=g["NotificationsStore"].show({message:e,placeat:"#notificationManagePhoneNumber",context:"success",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"});g["NotificationsStore"].scrollToNotification(t),this.updatePhoneNumbers()}).finally(()=>{this.isUpdatingPhoneNumbers=!1})},updatePhoneNumbers(){this.isUpdatingPhoneNumbers=!0,g["AjaxHelper"].post({method:"MobileMessaging.getPhoneNumbers"},{}).then(e=>{this.phoneNumbers=e,this.isUpdatingPhoneNumbers=!1})},removePhoneNumber(e){e&&(this.numberToRemove=e,this.clearNotifcationsAndErrorsContainer(),g["Matomo"].helper.modalConfirm("#confirmDeletePhoneNumber",{yes:()=>{this.isUpdatingPhoneNumbers=!0,g["AjaxHelper"].post({method:"MobileMessaging.removePhoneNumber"},{phoneNumber:e},{errorElement:"#ajaxErrorManagePhoneNumber"}).then(()=>{this.updatePhoneNumbers()}).finally(()=>{this.isUpdatingPhoneNumbers=!1,this.numberToRemove=""})}}))},addPhoneNumber(){const e=`+${this.countryCallingCode}${this.newPhoneNumber}`;this.canAddNumber&&e.length>1&&(this.isUpdatingPhoneNumbers=!0,this.clearNotifcationsAndErrorsContainer(),g["AjaxHelper"].post({method:"MobileMessaging.addPhoneNumber"},{phoneNumber:e},{errorElement:"#ajaxErrorManagePhoneNumber"}).then(()=>{this.updatePhoneNumbers(),this.countryCallingCode="",this.newPhoneNumber=""}).finally(()=>{this.isUpdatingPhoneNumbers=!1}))},clearNotifcationsAndErrorsContainer(){this.$refs.errorContainer.innerHTML="",g["NotificationsStore"].remove("MobileMessaging_ValidatePhoneNumber")}},computed:{showSuspiciousPhoneNumber(){return 0===this.newPhoneNumber.trim().lastIndexOf("0",0)},canAddNumber(){return!!this.newPhoneNumber&&""!==this.newPhoneNumber},removeNumberConfirmation(){return Object(g["translate"])("MobileMessaging_ConfirmRemovePhoneNumber",this.numberToRemove)}}});he.render=ge;var je=he;const ve={class:"manageMobileMessagingSettings"},Oe={key:0},Ne={key:0},Me={class:"ui-confirm",id:"confirmDeleteAccount"},fe=["value"],Ce=["value"];function Se(e,t,n,o,r,a){const l=Object(i["resolveComponent"])("DelegateMobileMessagingSettings"),s=Object(i["resolveComponent"])("ContentBlock"),c=Object(i["resolveComponent"])("ManageSmsProvider"),d=Object(i["resolveComponent"])("ManageMobilePhoneNumbers");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ve,[e.isSuperUser?(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:0,"content-title":e.translate("MobileMessaging_SettingsMenu")},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(l,{"delegate-management-options":e.delegateManagementOptions,"delegated-management":e.delegatedManagement},null,8,["delegate-management-options","delegated-management"])]),_:1},8,["content-title"])):Object(i["createCommentVNode"])("",!0),e.accountManagedByCurrentUser?(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:1,"content-title":e.translate("MobileMessaging_Settings_SMSProvider"),feature:"true"},{default:Object(i["withCtx"])(()=>[e.isSuperUser&&e.delegatedManagement?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",Oe,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DelegatedSmsProviderOnlyAppliesToYou")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(c,{"credential-supplied":e.credentialSupplied,"credential-error":e.credentialError,provider:e.provider,"credit-left":e.creditLeft,"sms-provider-options":e.smsProviderOptions,"sms-providers":e.smsProviders},null,8,["credential-supplied","credential-error","provider","credit-left","sms-provider-options","sms-providers"])]),_:1},8,["content-title"])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(s,{"content-title":e.translate("MobileMessaging_PhoneNumbers")},{default:Object(i["withCtx"])(()=>[e.credentialSupplied?(Object(i["openBlock"])(),Object(i["createBlock"])(d,{key:1,"is-super-user":e.isSuperUser,"default-calling-code":e.defaultCallingCode,countries:e.countries,"str-help-add-phone":e.strHelpAddPhone,"phone-numbers":e.phoneNumbers},null,8,["is-super-user","default-calling-code","countries","str-help-add-phone","phone-numbers"])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",Ne,Object(i["toDisplayString"])(e.accountManagedByCurrentUser?e.translate("MobileMessaging_Settings_CredentialNotProvided"):e.translate("MobileMessaging_Settings_CredentialNotProvidedByAdmin")),1))]),_:1},8,["content-title"]),Object(i["createElementVNode"])("div",Me,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DeleteAccountConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,fe),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Ce)])])}var ye=Object(i["defineComponent"])({props:{delegateManagementOptions:{type:Array,required:!0},delegatedManagement:[Number,Boolean],isSuperUser:Boolean,defaultCallingCode:String,countries:{type:Array,required:!0},strHelpAddPhone:{type:String,required:!0},phoneNumbers:Object,accountManagedByCurrentUser:Boolean,credentialSupplied:Boolean,credentialError:String,provider:String,creditLeft:[Number,String],smsProviderOptions:{type:Object,required:!0},smsProviders:{type:Object,required:!0}},components:{ContentBlock:g["ContentBlock"],DelegateMobileMessagingSettings:R,ManageMobilePhoneNumbers:je,ManageSmsProvider:T}});ye.render=Se;var Pe=ye;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["Morpheus"]=t(require("CoreHome"),require("vue")):e["Morpheus"]=t(e["CoreHome"],e["Vue"])})("undefined"!==typeof self?self:this,(function(e,t){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var c=t[o]={i:o,l:!1,exports:{}};return e[o].call(c.exports,c,c.exports,n),c.l=!0,c.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)n.d(o,c,function(t){return e[t]}.bind(null,c));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Morpheus/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"Demo",(function(){return B})),"undefined"!==typeof window){var o=window.document.currentScript,c=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);c&&(n.p=c[1])}var r=n("8bbf");const i=Object(r["createElementVNode"])("h2",null,"Icons",-1),l={id:"icons",class:"demo icons"},p={class:"row"},s=Object(r["createElementVNode"])("div",{class:"demo-code"},[Object(r["createElementVNode"])("pre",null,'<span class="icon-ok"></span>')],-1);function d(e,t,n,o,c,d){const a=Object(r["resolveComponent"])("DemoCodePair");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.demoSnippets,e=>(Object(r["openBlock"])(),Object(r["createBlock"])(a,{key:e.id,snippet:e},null,8,["snippet"]))),128)),i,Object(r["createElementVNode"])("div",l,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.icons,(e,t)=>(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:t},[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(t),1),Object(r["createElementVNode"])("div",p,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e,(e,t)=>(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"col s4 icon",key:t},[Object(r["createElementVNode"])("span",{class:Object(r["normalizeClass"])("icon-"+e)},null,2),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e),1)]))),128))])]))),128))]),s])}const a=["data-snippet"],u={key:0},b={key:1,class:"demo"},m={key:2,class:"demo-code"},j={key:3};function O(e,t,n,o,c,i){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{style:Object(r["normalizeStyle"])({"margin-top":e.snippet.noMargin?"-16px":void 0}),"data-snippet":e.snippet.id},[e.snippet.title?(Object(r["openBlock"])(),Object(r["createElementBlock"])("h2",u,Object(r["toDisplayString"])(e.snippet.title),1)):Object(r["createCommentVNode"])("",!0),e.snippet.vue_embed?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",b,[(Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])(e.vueEmbedComponent)))])):Object(r["createCommentVNode"])("",!0),e.snippet.code?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",m,[Object(r["createElementVNode"])("pre",null,Object(r["toDisplayString"])(e.processedSnippetCode),1)])):Object(r["createCommentVNode"])("",!0),e.snippet.desc?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",j,Object(r["toDisplayString"])(e.snippet.desc),1)):Object(r["createCommentVNode"])("",!0)],12,a)}var f=n("19dc"),v=Object(r["defineComponent"])({props:{snippet:{type:Object,required:!0}},computed:{vueEmbedComponent(){const e=this.snippet,t={};(e.components||[]).forEach(e=>{t[e.component]=Object(f["useExternalPluginComponent"])(e.plugin,e.component)});const n={};(e.directives||[]).forEach(e=>{n[e.directive]=window[e.plugin][e.directive]});const o=this.snippet.data||{};return Object(r["markRaw"])({template:this.snippet.vue_embed,components:t,directives:n,data(){return o}})},processedSnippetCode(){const{snippet:e}=this,t=e.code.indexOf("%vue_embed%"),n=e.code.lastIndexOf("\n",t),o=e.code.substring(n+1,t);return e.code.replaceAll("%vue_embed%",e.vue_embed.replaceAll("\n","\n"+o))}}});v.render=O;var y=v,k=Object(r["defineComponent"])({props:{demoSnippets:{type:Array,required:!0},icons:{type:Object,required:!0}},components:{DemoCodePair:y}});k.render=d;var B=k;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["Marketplace"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["Marketplace"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(l){if(t[l])return t[l].exports;var a=t[l]={i:l,l:!1,exports:{}};return e[l].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(l,a,function(t){return e[t]}.bind(null,a));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Marketplace/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"Marketplace",(function(){return on})),n.d(t,"ManageLicenseKey",(function(){return gn})),n.d(t,"GetNewPlugins",(function(){return fn})),n.d(t,"GetNewPluginsAdmin",(function(){return Fn})),n.d(t,"GetPremiumFeatures",(function(){return tl})),n.d(t,"MissingReqsNotice",(function(){return Yt})),n.d(t,"OverviewIntro",(function(){return cl})),n.d(t,"SubscriptionOverview",(function(){return Ll})),n.d(t,"RichMenuButton",(function(){return Il})),n.d(t,"PluginList",(function(){return ln})),"undefined"!==typeof window){var l=window.document.currentScript,a=l&&l.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);a&&(n.p=a[1])}var i=n("8bbf");const r={class:"row marketplaceActions",ref:"root"},o={class:"col s12 m6 l4"},c={class:"col s12 m6 l4"},s={key:0,class:"col s12 m12 l4"},u={class:"plugin-search"},d=Object(i["createElementVNode"])("span",{class:"icon-search"},null,-1);function p(e,t,n,l,a,p){var m;const b=Object(i["resolveComponent"])("Field"),g=Object(i["resolveComponent"])("PluginList"),O=Object(i["resolveComponent"])("ContentBlock"),j=Object(i["resolveComponent"])("MatomoLoader");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("div",r,[Object(i["createElementVNode"])("div",o,[Object(i["createVNode"])(b,{uicontrol:"select",name:"plugin_type","model-value":e.pluginTypeFilter,"onUpdate:modelValue":e.updateType,title:e.translate("Marketplace_Show"),"full-width":!0,options:e.pluginTypeOptions},null,8,["model-value","onUpdate:modelValue","title","options"])]),Object(i["createElementVNode"])("div",c,[Object(i["createVNode"])(b,{uicontrol:"select",name:"plugin_sort","model-value":e.pluginSort,"onUpdate:modelValue":e.updateSort,title:e.translate("Marketplace_Sort"),"full-width":!0,options:e.pluginSortOptions},null,8,["model-value","onUpdate:modelValue","title","options"])]),(null===(m=e.pluginsToShow)||void 0===m?void 0:m.length)>20||e.searchQuery?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",s,[Object(i["createElementVNode"])("div",u,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(b,{uicontrol:"text",name:"query",title:e.queryInputTitle,"full-width":!0,"model-value":e.searchQuery,"onUpdate:modelValue":e.updateQuery},null,8,["title","model-value","onUpdate:modelValue"])]),d])])):Object(i["createCommentVNode"])("",!0)],512),!e.loading&&e.pluginsToShow.length>0?(Object(i["openBlock"])(),Object(i["createBlock"])(g,{key:0,"plugins-to-show":e.pluginsToShow,"current-user-email":e.currentUserEmail,"is-auto-update-possible":e.isAutoUpdatePossible,"is-super-user":e.isSuperUser,"is-multi-server-environment":e.isMultiServerEnvironment,"has-some-admin-access":e.hasSomeAdminAccess,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-valid-consumer":e.isValidConsumer,"deactivate-nonce":e.deactivateNonce,"activate-nonce":e.activateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,"num-users":e.numUsers,onTriggerUpdate:t[0]||(t[0]=e=>this.updateMarketplace()),onStartTrialStart:t[1]||(t[1]=e=>this.$emit("startTrialStart")),onStartTrialStop:t[2]||(t[2]=e=>this.$emit("startTrialStop"))},null,8,["plugins-to-show","current-user-email","is-auto-update-possible","is-super-user","is-multi-server-environment","has-some-admin-access","is-plugins-admin-enabled","is-valid-consumer","deactivate-nonce","activate-nonce","install-nonce","update-nonce","num-users"])):Object(i["createCommentVNode"])("",!0),e.loading||0!=e.pluginsToShow.length?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(O,{key:1},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate(e.showThemes?"Marketplace_NoThemesFound":"Marketplace_NoPluginsFound")),1)]),_:1})),e.loading?(Object(i["openBlock"])(),Object(i["createBlock"])(O,{key:2},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(j),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.loadingMessage),1)]),_:1})):Object(i["createCommentVNode"])("",!0)],64)}var m=n("19dc"),b=n("a5a2");const g={key:0,class:"pluginListContainer row"},O=["onClick"],j={class:"card"},h={class:"card-content"},k=["src"],y={class:"content-container"},v={class:"card-content-top"},N={key:0,class:"matomo-badge matomo-badge-top",src:"plugins/Marketplace/images/matomo-badge.png","aria-label":"Matomo plugin",alt:""},V={class:"price"},S=["onClick"],E=Object(i["createElementVNode"])("div",{class:"card-focus"},null,-1),B={class:"card-title"},M=Object(i["createElementVNode"])("span",{class:"card-title-chevron"}," ›",-1),f={class:"card-description"},T={class:"card-content-bottom"},w={key:0,class:"downloads"},C={class:"owner"},P={key:0},D={key:1},A={class:"cta-container"},L={key:1,class:"matomo-badge matomo-badge-bottom",src:"plugins/Marketplace/images/matomo-badge.png","aria-label":"Matomo plugin",alt:""};function _(e,t,n,l,a,r){const o=Object(i["resolveComponent"])("RequestTrial"),c=Object(i["resolveComponent"])("StartFreeTrial"),s=Object(i["resolveComponent"])("PluginDetailsModal"),u=Object(i["resolveComponent"])("CTAContainer");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createVNode"])(o,{modelValue:e.showRequestTrialForPlugin,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showRequestTrialForPlugin=t),onTrialRequested:t[1]||(t[1]=e=>this.$emit("triggerUpdate"))},null,8,["modelValue"]),Object(i["createVNode"])(c,{"current-user-email":e.currentUserEmail,"is-valid-consumer":e.isValidConsumer,modelValue:e.showStartFreeTrialForPlugin,"onUpdate:modelValue":t[2]||(t[2]=t=>e.showStartFreeTrialForPlugin=t),onTrialStarted:t[3]||(t[3]=e=>{this.$emit("triggerUpdate")}),onStartTrialStart:t[4]||(t[4]=e=>{this.$emit("startTrialStart")}),onStartTrialStop:t[5]||(t[5]=e=>{this.$emit("startTrialStop")})},null,8,["current-user-email","is-valid-consumer","modelValue"]),Object(i["createVNode"])(s,{modelValue:e.showPluginDetailsForPlugin,"onUpdate:modelValue":t[6]||(t[6]=t=>e.showPluginDetailsForPlugin=t),"is-super-user":e.isSuperUser,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-multi-server-environment":e.isMultiServerEnvironment,"is-valid-consumer":e.isValidConsumer,"is-auto-update-possible":e.isAutoUpdatePossible,"has-some-admin-access":e.hasSomeAdminAccess,"deactivate-nonce":e.deactivateNonce,"activate-nonce":e.activateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,"num-users":e.numUsers,onRequestTrial:t[7]||(t[7]=e=>this.requestTrial(e)),onStartFreeTrial:t[8]||(t[8]=e=>this.startFreeTrial(e))},null,8,["modelValue","is-super-user","is-plugins-admin-enabled","is-multi-server-environment","is-valid-consumer","is-auto-update-possible","has-some-admin-access","deactivate-nonce","activate-nonce","install-nonce","update-nonce","num-users"]),e.pluginsToShow.length>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",g,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.pluginsToShow,t=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"col s12 m6 l4",key:t.name},[Object(i["createElementVNode"])("div",{class:Object(i["normalizeClass"])("card-holder "+(t.numDownloads>0?"card-with-downloads":"")),onClick:n=>e.clickCard(n,t)},[Object(i["createElementVNode"])("div",j,[Object(i["createElementVNode"])("div",h,[Object(i["createElementVNode"])("img",{src:t.coverImage+"?w=880&h=480",alt:"",class:"cover-image"},null,8,k),Object(i["createElementVNode"])("div",y,[Object(i["createElementVNode"])("div",v,["piwik"==t.owner||"matomo-org"==t.owner?(Object(i["openBlock"])(),Object(i["createElementBlock"])("img",N)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",V,[t.priceFrom?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_PriceFromPerPeriod",t.priceFrom.prettyPrice,t.priceFrom.period)),1)],64)):t.isFree?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:1},[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_Free")),1)],64)):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("a",{onClick:Object(i["withModifiers"])(n=>e.clickCard(n,t),["prevent"]),class:"card-title-link",href:"#",tabindex:"7"},[E,Object(i["createElementVNode"])("h2",B,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(t.displayName),1),M])],8,S),Object(i["createElementVNode"])("div",f,Object(i["toDisplayString"])(t.description),1)]),Object(i["createElementVNode"])("div",T,[t.numDownloads>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",w,Object(i["toDisplayString"])(t.numDownloadsPretty)+" "+Object(i["toDisplayString"])(e.translate("General_Downloads").toLowerCase()),1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",C,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_CreatedBy"))+" ",1),"piwik"===t.owner||"matomo-org"===t.owner?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",P," Matomo")):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",D,Object(i["toDisplayString"])(t.owner),1))]),Object(i["createElementVNode"])("div",A,[Object(i["createVNode"])(u,{"is-super-user":e.isSuperUser,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-multi-server-environment":e.isMultiServerEnvironment,"is-valid-consumer":e.isValidConsumer,"is-auto-update-possible":e.isAutoUpdatePossible,"activate-nonce":e.activateNonce,"deactivate-nonce":e.deactivateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,plugin:t,"in-modal":!1,onOpenDetailsModal:e=>this.openDetailsModal(t),onRequestTrial:e=>this.requestTrial(t),onStartFreeTrial:e=>this.startFreeTrial(t)},null,8,["is-super-user","is-plugins-admin-enabled","is-multi-server-environment","is-valid-consumer","is-auto-update-possible","activate-nonce","deactivate-nonce","install-nonce","update-nonce","plugin","onOpenDetailsModal","onRequestTrial","onStartFreeTrial"])]),"piwik"==t.owner||"matomo-org"==t.owner?(Object(i["openBlock"])(),Object(i["createElementBlock"])("img",L)):Object(i["createCommentVNode"])("",!0)])])])])],10,O)]))),128))])):Object(i["createCommentVNode"])("",!0)],64)}const U={key:0,class:"alert alert-danger alert-no-background"},q={key:0,style:{"white-space":"nowrap"}},x=["href"],F={key:2,class:"alert alert-danger alert-no-background"},R={key:0,style:{"white-space":"nowrap"}},$=["href"],I={key:1,class:"alert alert-warning alert-no-background"},H={key:0,style:{"white-space":"nowrap"}},K={key:4,class:"alert alert-success alert-no-background"},z=["href"],G=["href"],Q=["title"],W=["title","href"],J={key:8,class:"alert alert-warning alert-no-background"},Y={key:0,style:{"white-space":"nowrap"}},Z=["href"],X=["title"],ee=["title"];function te(e,t,n,l,a,r){const o=Object(i["resolveComponent"])("MoreDetailsAction"),c=Object(i["resolveComponent"])("DownloadButton");return e.isSuperUser?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[e.plugin.isMissingLicense?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",U,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_LicenseMissing"))+" ",1),e.inModal?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",q,[Object(i["createTextVNode"])("("),Object(i["createVNode"])(o,{onAction:t[0]||(t[0]=t=>e.$emit("openDetailsModal"))}),Object(i["createTextVNode"])(")")]))])):e.inModal&&e.plugin.hasExceededLicense&&e.plugin.consumer.loginUrl?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:1,class:"btn btn-block",tabindex:"7",target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink(e.plugin.consumer.loginUrl)},Object(i["toDisplayString"])(e.translate("Marketplace_UpgradeSubscription")),9,x)):e.plugin.hasExceededLicense?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",F,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_LicenseExceeded"))+" ",1),e.inModal?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",R,[Object(i["createTextVNode"])("("),Object(i["createVNode"])(o,{onAction:t[1]||(t[1]=t=>e.$emit("openDetailsModal"))}),Object(i["createTextVNode"])(")")]))])):e.plugin.canBeUpdated&&0==e.plugin.missingRequirements.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:3},[e.isAutoUpdatePossible&&e.isPluginsAdminEnabled?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,tabindex:"7",class:"btn btn-block",href:e.linkToUpdate(e.plugin.name)},Object(i["toDisplayString"])(e.translate("CoreUpdater_UpdateTitle")),9,$)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",I,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_CannotUpdate"))+" ",1),!e.inModal||0===e.plugin.missingRequirements.length&&e.plugin.isDownloadable&&!e.isAutoUpdatePossible?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",H,[Object(i["createTextVNode"])("("),e.inModal?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(o,{key:0,onAction:t[2]||(t[2]=t=>e.$emit("openDetailsModal"))})),Object(i["createVNode"])(c,{plugin:e.plugin,"show-or":!e.inModal,"is-auto-update-possible":e.isAutoUpdatePossible},null,8,["plugin","show-or","is-auto-update-possible"]),Object(i["createTextVNode"])(")")])):Object(i["createCommentVNode"])("",!0)]))],64)):e.plugin.isInstalled?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",K,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("General_Installed"))+" ",1),e.plugin.missingRequirements.length>0||!e.isAutoUpdatePossible?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createTextVNode"])(" ("),Object(i["createVNode"])(c,{plugin:e.plugin,"show-or":!1,"is-auto-update-possible":e.isAutoUpdatePossible},null,8,["plugin","is-auto-update-possible"]),Object(i["createTextVNode"])(") ")],64)):e.plugin.isInvalid||e.isMultiServerEnvironment||!e.isPluginsAdminEnabled?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:1},[Object(i["createTextVNode"])(" ("),e.plugin.isActivated?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,tabindex:"7",href:e.linkToDeactivate(e.plugin.name)},Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Deactivate")),9,z)):e.plugin.missingRequirements.length>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:1},[Object(i["createTextVNode"])(" - ")],64)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:2,tabindex:"7",href:e.linkToActivate(e.plugin.name)},Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Activate")),9,G)),Object(i["createTextVNode"])(") ")],64))])):e.plugin.isEligibleForFreeTrial&&!e.inModal&&e.isPluginsAdminEnabled?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:5,class:"btn btn-block purchaseable",title:e.translate("Marketplace_StartFreeTrial")},Object(i["toDisplayString"])(e.translate("Marketplace_StartFreeTrial")),9,Q)):e.plugin.isEligibleForFreeTrial&&e.inModal?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:6,class:"btn btn-block addToCartLink",target:"_blank",title:e.translate("Marketplace_ClickToCompletePurchase"),rel:"noreferrer noopener",href:e.shopVariationUrl},Object(i["toDisplayString"])(e.translate("Marketplace_AddToCart")),9,W)):e.inModal||e.plugin.isDownloadable||!(e.plugin.isPaid||e.plugin.missingRequirements.length>0)&&e.isAutoUpdatePossible?e.plugin.missingRequirements.length>0||!e.isAutoUpdatePossible?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",J,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_CannotInstall"))+" ",1),!e.inModal||0===e.plugin.missingRequirements.length&&e.plugin.isDownloadable&&!e.isAutoUpdatePossible?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Y,[Object(i["createTextVNode"])("("),e.inModal?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(o,{key:0,onAction:t[4]||(t[4]=t=>e.$emit("openDetailsModal"))})),Object(i["createVNode"])(c,{plugin:e.plugin,"show-or":!e.inModal,"is-auto-update-possible":e.isAutoUpdatePossible},null,8,["plugin","show-or","is-auto-update-possible"]),Object(i["createTextVNode"])(")")])):Object(i["createCommentVNode"])("",!0)])):e.isPluginsAdminEnabled&&e.plugin.hasDownloadLink?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:9,tabindex:"7",href:e.linkToInstall(e.plugin.name),class:"btn btn-block"},Object(i["toDisplayString"])(e.translate("Marketplace_ActionInstall")),9,Z)):(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:10},[e.inModal?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(o,{key:0,"show-as-button":!0,label:e.translate("General_MoreDetails"),onAction:t[5]||(t[5]=t=>e.$emit("openDetailsModal"))},null,8,["label"]))],64)):(Object(i["openBlock"])(),Object(i["createBlock"])(o,{key:7,"show-as-button":!0,label:e.translate("General_MoreDetails"),onAction:t[3]||(t[3]=t=>e.$emit("openDetailsModal"))},null,8,["label"]))],64)):e.plugin.isTrialRequested?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:1,tabindex:"7",class:"btn btn-block purchaseable disabled",href:"",title:e.translate("Marketplace_TrialRequested")},Object(i["toDisplayString"])(e.translate("Marketplace_TrialRequested")),9,X)):e.plugin.canTrialBeRequested&&!e.plugin.isMissingLicense?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:2,tabindex:"7",class:"btn btn-block purchaseable",href:"",onClick:t[6]||(t[6]=Object(i["withModifiers"])(e=>{this.$emit("requestTrial")},["prevent"])),title:e.translate("Marketplace_RequestTrial")},Object(i["toDisplayString"])(e.translate("Marketplace_RequestTrial")),9,ee)):(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:3},[e.inModal?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(o,{key:0,"show-as-button":!0,label:e.translate("General_MoreDetails"),onAction:t[7]||(t[7]=t=>e.$emit("openDetailsModal"))},null,8,["label"]))],64))}const ne={key:0,onclick:"$(this).css('display', 'none')"},le=["href"];function ae(e,t,n,l,a,r){return 0===e.plugin.missingRequirements.length&&e.plugin.isDownloadable&&!e.isAutoUpdatePossible?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",ne,[e.showOr?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_Or"))+" ",1)],64)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("a",{tabindex:"7",class:"plugin-details download",href:e.linkTo({module:"Marketplace",action:"download",pluginName:e.plugin.name,nonce:e.plugin.downloadNonce})},Object(i["toDisplayString"])(e.translate("General_Download")),9,le)])):Object(i["createCommentVNode"])("",!0)}var ie=Object(i["defineComponent"])({props:{plugin:{type:Object,required:!0},showOr:{type:Boolean,default:!1},isAutoUpdatePossible:{type:Boolean,required:!0}},methods:{linkTo(e){return"?"+m["MatomoUrl"].stringify(Object.assign(Object.assign({},m["MatomoUrl"].urlParsed.value),e))}}});ie.render=ae;var re=ie;const oe=["title"];function ce(e,t,n,l,a,r){return Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{tabindex:"7",class:Object(i["normalizeClass"])({"btn btn-block":e.showAsButton}),href:"",title:e.translate("General_MoreDetails"),onClick:t[0]||(t[0]=Object(i["withModifiers"])(t=>e.$emit("action"),["prevent"])),onKeyup:t[1]||(t[1]=Object(i["withKeys"])(t=>e.$emit("action"),["enter"]))},Object(i["toDisplayString"])(e.label?e.label:e.translate("General_Help")),43,oe)}var se=Object(i["defineComponent"])({props:{showAsButton:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1}},emits:["action"]});se.render=ce;var ue=se,de=Object(i["defineComponent"])({props:{plugin:{type:Object,required:!0},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},installNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},isAutoUpdatePossible:{type:Boolean,required:!0},isValidConsumer:{type:Boolean,required:!0},isMultiServerEnvironment:{type:Boolean,required:!0},isPluginsAdminEnabled:{type:Boolean,required:!0},isSuperUser:{type:Boolean,required:!0},inModal:{type:Boolean,required:!0},shopVariationUrl:{type:String,required:!1,default:""}},emits:["openDetailsModal","requestTrial","startFreeTrial"],components:{MoreDetailsAction:ue,DownloadButton:re},methods:{linkToActivate(e){return this.linkTo({module:"CorePluginsAdmin",action:"activate",redirectTo:"referrer",nonce:this.activateNonce,pluginName:e})},linkToDeactivate(e){return this.linkTo({module:"CorePluginsAdmin",action:"deactivate",redirectTo:"referrer",nonce:this.deactivateNonce,pluginName:e})},linkToInstall(e){return this.linkTo({module:"Marketplace",action:"installPlugin",nonce:this.installNonce,pluginName:e})},linkToUpdate(e){return this.linkTo({module:"Marketplace",action:"updatePlugin",nonce:this.updateNonce,pluginName:e})},linkTo(e){return"?"+m["MatomoUrl"].stringify(Object.assign(Object.assign({},m["MatomoUrl"].urlParsed.value),e))}}});de.render=te;var pe=de;const me={class:"ui-confirm",ref:"confirm"},be=["value"],ge=["value"];function Oe(e,t,n,l,a,r){var o;return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",me,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("Marketplace_RequestTrialConfirmTitle",null===(o=e.plugin)||void 0===o?void 0:o.displayName)),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("Marketplace_RequestTrialConfirmEmailWarning")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,be),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,ge)],512)}var je=Object(i["defineComponent"])({props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue","trialRequested"],watch:{modelValue(e){e&&m["Matomo"].helper.modalConfirm(this.$refs.confirm,{yes:()=>{this.requestTrial(e)}},{onCloseEnd:()=>{this.$emit("update:modelValue",null)}})}},computed:{plugin(){return this.modelValue}},methods:{requestTrial(e){m["AjaxHelper"].post({module:"API",method:"Marketplace.requestTrial"},{pluginName:e.name}).then(()=>{const t=m["NotificationsStore"].show({message:Object(m["translate"])("Marketplace_RequestTrialSubmitted",e.displayName),context:"success",id:"requestTrialSuccess",placeat:"#notificationContainer",type:"transient"});m["NotificationsStore"].scrollToNotification(t),this.$emit("trialRequested")})}}});je.render=Oe;var he=je;const ke={class:"modal",id:"startFreeTrial"},ye={key:0,class:"btn-close modal-close"},ve=Object(i["createElementVNode"])("i",{class:"icon-close"},null,-1),Ne=[ve],Ve={key:1,class:"modal-content trial-start-in-progress"},Se={class:"Piwik_Popover_Loading"},Ee={class:"Piwik_Popover_Loading_Name"},Be={key:2,class:"modal-content trial-start-error"},Me={class:"modal-text"},fe={key:3,class:"modal-content trial-start-no-license"},Te={class:"modal-text"},we=["innerHTML"],Ce=["innerHTML"],Pe=["disabled"],De=["innerHTML"];function Ae(e,t,n,l,a,r){const o=Object(i["resolveComponent"])("Field");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ke,[e.trialStartInProgress?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",ye,Ne)),e.trialStartInProgress?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ve,[Object(i["createElementVNode"])("div",Se,[Object(i["createElementVNode"])("div",Ee,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("Marketplace_TrialStartInProgressTitle")),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("Marketplace_TrialStartInProgressText")),1)])])])):e.trialStartError?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Be,[Object(i["createElementVNode"])("div",Me,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("Marketplace_TrialStartErrorTitle")),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.trialStartError),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("Marketplace_TrialStartErrorSupport")),1)])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",fe,[Object(i["createElementVNode"])("div",Te,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("Marketplace_TrialStartNoLicenseTitle")),1),Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("Marketplace_TrialStartNoLicenseText")),1),Object(i["createVNode"])(o,{uicontrol:"text",name:"email",modelValue:e.createAccountEmail,"onUpdate:modelValue":t[0]||(t[0]=t=>e.createAccountEmail=t),"full-width":!0,title:e.translate("UsersManager_Email")},null,8,["modelValue","title"]),e.createAccountError?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,class:"alert alert-danger",innerHTML:e.$sanitize(e.createAccountError)},null,8,we)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("p",{class:"trial-start-legal-hint",innerHTML:e.$sanitize(e.trialStartNoLicenseLegalHintText)},null,8,Ce),Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("button",{class:"btn",disabled:!e.createAccountEmail,onClick:t[1]||(t[1]=t=>e.createAccountAndStartFreeTrial())},Object(i["toDisplayString"])(e.translate("Marketplace_TrialStartNoLicenseCreateAccount")),9,Pe)]),Object(i["createElementVNode"])("p",{class:"add-existing-license",innerHTML:e.$sanitize(e.trialStartNoLicenseAddHereText)},null,8,De)])]))])}const{$:Le}=window;var _e=Object(i["defineComponent"])({components:{Field:b["Field"]},props:{modelValue:{type:Object,default:()=>({})},currentUserEmail:String,isValidConsumer:Boolean},data(){return{createAccountEmail:this.currentUserEmail||"",createAccountError:null,trialStartError:null,loadingModalCloseCallback:void 0,trialStartInProgress:!1,trialStartSuccessNotificationMessage:"",trialStartSuccessNotificationTitle:""}},emits:["update:modelValue","trialStarted","startTrialStart","startTrialStop"],watch:{modelValue(e){e&&(this.isValidConsumer?(this.trialStartSuccessNotificationMessage=Object(m["translate"])("CorePluginsAdmin_PluginFreeTrialStarted","<strong>","</strong>",this.plugin.displayName),this.startFreeTrial()):(this.trialStartSuccessNotificationTitle=Object(m["translate"])("CorePluginsAdmin_PluginFreeTrialStartedAccountCreatedTitle"),this.trialStartSuccessNotificationMessage=Object(m["translate"])("CorePluginsAdmin_PluginFreeTrialStartedAccountCreatedMessage",this.plugin.displayName),this.showLicenseDialog(!1)))}},computed:{plugin(){return this.modelValue},trialStartNoLicenseAddHereText(){const e="?"+m["MatomoUrl"].stringify({module:"Marketplace",action:"manageLicenseKey"});return Object(m["translate"])("Marketplace_TrialStartNoLicenseAddHere",`<a href="${e}">`,"</a>")},trialStartNoLicenseLegalHintText(){return Object(m["translate"])("Marketplace_TrialStartNoLicenseLegalHint",Object(m["externalLink"])("https://shop.matomo.org/terms-conditions/"),"</a>",Object(m["externalLink"])("https://matomo.org/privacy-policy/"),"</a>")}},methods:{closeModal(){Le("#startFreeTrial").modal("close")},createAccountAndStartFreeTrial(){this.createAccountEmail&&(this.showLoadingModal(!0),m["AjaxHelper"].post({module:"API",method:"Marketplace.createAccount"},{email:this.createAccountEmail},{createErrorNotification:!1}).then(()=>{this.startFreeTrial()}).catch(e=>{e.message.startsWith("Marketplace_CreateAccountError")?(this.showErrorModal(Object(m["translate"])(e.message)),this.trialStartInProgress=!1,this.$emit("update:modelValue",null)):(this.createAccountError=e.message,this.trialStartInProgress=!1,this.showLicenseDialog(!0))}))},showLicenseDialog(e){const t=e=>{const t=e.keyCode?e.keyCode:e.which;13===t&&(this.closeModal(),this.createAccountAndStartFreeTrial())},n={dismissible:!0,onOpenEnd:()=>{const e=".modal.open #email";Le(e).focus(),Le(e).off("keypress").keypress(t)},onCloseEnd:()=>{this.createAccountError=null,this.trialStartInProgress||this.$emit("update:modelValue",null)}};e&&(n.inDuration=0),Le("#startFreeTrial").modal(n).modal("open")},showErrorModal(e){this.trialStartError||(this.trialStartError=e,Le("#startFreeTrial").modal({dismissible:!0,inDuration:0,onCloseEnd:()=>{this.trialStartError=null}}).modal("open"))},showLoadingModal(e){this.trialStartInProgress||(this.trialStartInProgress=!0,this.loadingModalCloseCallback=void 0,Le("#startFreeTrial").modal({dismissible:!1,inDuration:e?0:void 0,onCloseEnd:()=>{this.loadingModalCloseCallback&&(this.loadingModalCloseCallback(),this.loadingModalCloseCallback=void 0)}}).modal("open"))},startFreeTrial(){this.showLoadingModal(!1),this.$emit("startTrialStart"),m["AjaxHelper"].post({module:"API",method:"Marketplace.startFreeTrial"},{pluginName:this.plugin.name},{createErrorNotification:!1}).then(()=>{this.loadingModalCloseCallback=this.startFreeTrialSuccess,this.closeModal()}).catch(e=>{this.showErrorModal(m["Matomo"].helper.htmlDecode(e.message)),this.trialStartInProgress=!1,this.$emit("startTrialStop")}).finally(()=>{this.$emit("update:modelValue",null)})},startFreeTrialSuccess(){const e=m["NotificationsStore"].show({message:this.trialStartSuccessNotificationMessage,title:this.trialStartSuccessNotificationTitle,context:"success",id:"startTrialSuccess",placeat:"#notificationContainer",type:"transient"});m["NotificationsStore"].scrollToNotification(e),this.trialStartInProgress=!1,this.$emit("trialStarted")}}});_e.render=Ae;var Ue=_e;const qe={ref:"root",class:"modal",id:"pluginDetailsModal"},xe={class:"modal-content__header"},Fe=Object(i["createElementVNode"])("span",{class:"btn-close modal-close"},[Object(i["createElementVNode"])("i",{class:"icon-close"})],-1),Re={key:0,class:"plugin-metadata-part1"},$e=Object(i["createElementVNode"])("h3",{class:"sr-only"},"Plugin details — part 1",-1),Ie={key:0,class:"pair"},He=Object(i["createElementVNode"])("img",{class:"star-icon reviews-icon",src:"plugins/Marketplace/images/star.svg",alt:""},null,-1),Ke={key:1,class:"pair"},ze={key:2,class:"pair"},Ge={key:3,class:"pair"},Qe={key:4,class:"pair"},We={class:"plugin-description"},Je={key:1,class:"alert alert-warning"},Ye={key:2,class:"alert alert-warning"},Ze={key:3,class:"alert alert-danger"},Xe={key:4,class:"alert alert-warning"},et=["innerHTML"],tt=["innerHTML"],nt=["innerHTML"],lt=["innerHTML"],at={class:"plugin-metadata-part2"},it=Object(i["createElementVNode"])("hr",null,null,-1),rt=Object(i["createElementVNode"])("h3",{class:"sr-only"},"Plugin details — part 2",-1),ot={key:0,class:"pair"},ct={key:1,class:"pair"},st={class:"pair"},ut=["href"],dt=["href"],pt={key:2},mt={key:3},bt={class:"pair"},gt=["href"],Ot=["href"],jt=["href"],ht={key:0,class:"pair"},kt={key:1,class:"pair"},yt=["href"],vt={key:1},Nt=["innerHTML"],Vt={key:0},St=["href"],Et={key:1},Bt=["href"],Mt=["innerHTML"],ft={key:0,class:"plugin-screenshots"},Tt=Object(i["createElementVNode"])("hr",null,null,-1),wt={class:"thumbnails"},Ct=["src"],Pt={key:1,class:"plugin-documentation"},Dt=Object(i["createElementVNode"])("hr",null,null,-1),At=["innerHTML"],Lt={key:2,class:"plugin-faq"},_t=Object(i["createElementVNode"])("hr",null,null,-1),Ut=["innerHTML"],qt={key:3,class:"plugin-reviews",id:"reviews"},xt=Object(i["createElementVNode"])("hr",null,null,-1),Ft=["id","src"],Rt={key:0,class:"matomo-badge matomo-badge-modal",src:"plugins/Marketplace/images/matomo-badge.png","aria-label":"Matomo plugin",alt:""},$t={class:"cta-container cta-container-modal"},It={key:0,class:"free-trial"},Ht={class:"free-trial-lead-in"},Kt=["title"],zt=["value","title"],Gt={key:1,class:"matomo-badge matomo-badge-modal",src:"plugins/Marketplace/images/matomo-badge.png","aria-label":"Matomo plugin",alt:""};function Qt(e,t,n,l,a,r){var o,c,s,u,d,p;const m=Object(i["resolveComponent"])("MissingReqsNotice"),b=Object(i["resolveComponent"])("CTAContainer");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",qe,[e.isLoading?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,class:Object(i["normalizeClass"])(["modal-content",{"modal-content--simple-header":!e.hasHeaderMetadata}])},[Object(i["createElementVNode"])("div",xe,[Fe,Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.plugin&&e.plugin.displayName?e.plugin.displayName:"Plugin details"),1),e.hasHeaderMetadata?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Re,[$e,Object(i["createElementVNode"])("dl",null,[e.showReviews?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ie,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("Marketplace_Reviews")),1),Object(i["createElementVNode"])("dd",null,[He,Object(i["createElementVNode"])("a",{onClick:t[0]||(t[0]=t=>e.scrollElementIntoView("#reviews"))},Object(i["toDisplayString"])(e.pluginReviews.averageRating),1)])])):Object(i["createCommentVNode"])("",!0),e.plugin.isBundle?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ke,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Version")),1),Object(i["createElementVNode"])("dd",null,Object(i["toDisplayString"])(e.plugin.latestVersion),1)])),e.plugin.numDownloads>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ze,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("General_Downloads")),1),Object(i["createElementVNode"])("dd",null,Object(i["toDisplayString"])(e.plugin.numDownloadsPretty),1)])):Object(i["createCommentVNode"])("",!0),e.plugin.lastUpdated&&!e.plugin.isBundle?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ge,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("Marketplace_LastUpdated")),1),Object(i["createElementVNode"])("dd",null,Object(i["toDisplayString"])(e.plugin.lastUpdated),1)])):Object(i["createCommentVNode"])("",!0),e.plugin.isBundle?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Qe,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("Marketplace_Developer")),1),Object(i["createElementVNode"])("dd",null,Object(i["toDisplayString"])(e.pluginOwner),1)]))])])):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("div",{class:Object(i["normalizeClass"])(["modal-content__main",{"modal-content__main--with-free-trial":e.showFreeTrialDropdown}])},[Object(i["createElementVNode"])("div",We,[e.showMissingRequirementsNoticeIfApplicable?(Object(i["openBlock"])(),Object(i["createBlock"])(m,{key:0,plugin:e.plugin},null,8,["plugin"])):Object(i["createCommentVNode"])("",!0),e.isMultiServerEnvironment?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Je,Object(i["toDisplayString"])(e.translate("Marketplace_MultiServerEnvironmentWarning")),1)):e.isAutoUpdatePossible?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ye,Object(i["toDisplayString"])(e.translate("Marketplace_AutoUpdateDisabledWarning","'[General]enable_auto_update=1'","'config/config.ini.php'")),1)),e.showMissingLicenseDescription?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ze,Object(i["toDisplayString"])(e.translate("Marketplace_PluginLicenseMissingDescription")),1)):e.showExceededLicenseDescription?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Xe,Object(i["toDisplayString"])(e.translate("Marketplace_PluginLicenseExceededDescription")),1)):"Pending"!==e.plugin.licenseStatus||e.isMultiServerEnvironment?"Cancelled"!==e.plugin.licenseStatus||e.isMultiServerEnvironment?e.plugin.hasDownloadLink||e.isMultiServerEnvironment||!e.plugin.licenseStatus&&e.plugin.isPaid?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:7,class:"alert alert-warning",innerHTML:e.$sanitize(e.getDownloadLinkMissingHelpText(e.plugin.displayName))},null,8,nt)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:6,class:"alert alert-warning",innerHTML:e.$sanitize(e.getCancelledLicenseHelpText(e.plugin.displayName))},null,8,tt)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:5,class:"alert alert-warning",innerHTML:e.$sanitize(e.getPendingLicenseHelpText(e.plugin.displayName))},null,8,et)),Object(i["createElementVNode"])("div",{innerHTML:e.$sanitize(e.pluginDescription)},null,8,lt)]),Object(i["createElementVNode"])("div",at,[it,rt,Object(i["createElementVNode"])("dl",null,[e.plugin.isBundle?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ot,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Version")),1),Object(i["createElementVNode"])("dd",null,Object(i["toDisplayString"])(e.plugin.latestVersion),1)])),e.pluginKeywords?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ct,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("Marketplace_PluginKeywords")),1),Object(i["createElementVNode"])("dd",null,Object(i["toDisplayString"])(e.pluginKeywords.join(", ")),1)])):Object(i["createCommentVNode"])("",!0),e.plugin.isBundle?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:2},[Object(i["createElementVNode"])("div",st,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("Marketplace_Authors")),1),Object(i["createElementVNode"])("dd",null,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.pluginAuthors,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:"author-"+n},[t.homepage?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,target:"_blank",rel:"noreferrer noopener",href:t.homepage},Object(i["toDisplayString"])(t.name),9,ut)):t.email&&e.isValidEmail(t.email)?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:1,href:"mailto:"+encodeURIComponent(t.email)},Object(i["toDisplayString"])(t.name),9,dt)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",pt,Object(i["toDisplayString"])(t.name),1)),n<e.pluginAuthors.length-1?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",mt,", ")):Object(i["createCommentVNode"])("",!0)],64))),128))])]),Object(i["createElementVNode"])("div",bt,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Websites")),1),Object(i["createElementVNode"])("dd",null,[e.plugin.homepage?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,target:"_blank",rel:"noreferrer noopener",href:e.plugin.homepage},Object(i["toDisplayString"])(e.translate("Marketplace_PluginWebsite")),9,gt)):Object(i["createCommentVNode"])("",!0),e.pluginChangelogUrl?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:1},[e.plugin.homepage?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createTextVNode"])(", ")],64)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink(e.pluginChangelogUrl)},Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Changelog")),9,Ot)],64)):Object(i["createCommentVNode"])("",!0),e.plugin.repositoryUrl?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:2},[e.plugin.homepage||e.pluginChangelogUrl?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createTextVNode"])(", ")],64)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink(e.plugin.repositoryUrl)},"GitHub",8,jt)],64)):Object(i["createCommentVNode"])("",!0)])]),e.pluginActivity&&e.pluginActivity.numCommits?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ht,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Activity")),1),Object(i["createElementVNode"])("dd",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.plugin.activity.numCommits)+" commits ",1),(null===(o=e.pluginActivity)||void 0===o?void 0:o.numContributors)>1?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createTextVNode"])(Object(i["toDisplayString"])(" "+e.translate("Marketplace_ByXDevelopers",e.pluginActivity.numContributors)),1)],64)):Object(i["createCommentVNode"])("",!0),null!==(c=e.pluginActivity)&&void 0!==c&&c.lastCommitDate?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:1},[Object(i["createTextVNode"])(Object(i["toDisplayString"])(" "+e.translate("Marketplace_LastCommitTime",e.pluginActivity.lastCommitDate)),1)],64)):Object(i["createCommentVNode"])("",!0)])])):Object(i["createCommentVNode"])("",!0),e.showLicenseName?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",kt,[Object(i["createElementVNode"])("dt",null,Object(i["toDisplayString"])(e.translate("Marketplace_License")),1),Object(i["createElementVNode"])("dd",null,[null!==(s=e.pluginLatestVersion.license)&&void 0!==s&&s.url?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,rel:"noreferrer noopener",href:null===(u=e.pluginLatestVersion.license)||void 0===u?void 0:u.url,target:"_blank"},Object(i["toDisplayString"])(null===(d=e.pluginLatestVersion.license)||void 0===d?void 0:d.name),9,yt)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",vt,Object(i["toDisplayString"])(null===(p=e.pluginLatestVersion.license)||void 0===p?void 0:p.name),1))])])):Object(i["createCommentVNode"])("",!0),e.pluginSupport.length?(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],{key:2},Object(i["renderList"])(e.pluginSupport,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"pair",key:"support-"+n},[t.name&&t.value?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createElementVNode"])("dt",{innerHTML:e.$sanitize(t.name)},null,8,Nt),this.isValidHttpUrl(t.value)?(Object(i["openBlock"])(),Object(i["createElementBlock"])("dd",Vt,[Object(i["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:e.externalRawLink(e.$sanitize(t.value))},Object(i["toDisplayString"])(e.$sanitize(t.value)),9,St)])):this.isValidEmail(t.value)?(Object(i["openBlock"])(),Object(i["createElementBlock"])("dd",Et,[Object(i["createElementVNode"])("a",{href:"mailto:"+encodeURIComponent(t.value)},Object(i["toDisplayString"])(e.$sanitize(t.value)),9,Bt)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("dd",{key:2,innerHTML:e.$sanitize(t.value)},null,8,Mt))],64)):Object(i["createCommentVNode"])("",!0)]))),128)):Object(i["createCommentVNode"])("",!0)],64))])]),e.pluginScreenshots.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ft,[Tt,Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("Marketplace_Screenshots")),1),Object(i["createElementVNode"])("div",wt,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.pluginScreenshots,e=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("figure",{key:"screenshot-"+e},[Object(i["createElementVNode"])("img",{src:e+"?w=800",width:"800",alt:""},null,8,Ct),Object(i["createElementVNode"])("figcaption",null,Object(i["toDisplayString"])(this.getScreenshotBaseName(e)),1)]))),128))])])):Object(i["createCommentVNode"])("",!0),e.pluginDocumentation?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Pt,[Dt,Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("General_Documentation")),1),Object(i["createElementVNode"])("div",{innerHTML:e.$sanitize(e.pluginDocumentation)},null,8,At)])):Object(i["createCommentVNode"])("",!0),e.pluginFaq?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Lt,[_t,Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("General_Faq")),1),Object(i["createElementVNode"])("div",{innerHTML:e.$sanitize(e.pluginFaq)},null,8,Ut)])):Object(i["createCommentVNode"])("",!0),e.showReviews?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",qt,[xt,Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("Marketplace_Reviews")),1),Object(i["createElementVNode"])("iframe",{class:"reviewIframe",style:Object(i["normalizeStyle"])(e.pluginReviews.height?`height: ${e.pluginReviews.height}px;`:""),id:e.pluginReviews.embedUrl.replace(/[\W_]+/g," "),src:e.pluginReviews.embedUrl},null,12,Ft)])):Object(i["createCommentVNode"])("",!0)],2),Object(i["createElementVNode"])("div",{class:Object(i["normalizeClass"])(["modal-content__footer",{"modal-content__footer--with-free-trial":e.showFreeTrialDropdown}])},[e.showFreeTrialDropdown&&e.isMatomoPlugin?(Object(i["openBlock"])(),Object(i["createElementBlock"])("img",Rt)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",$t,[e.showFreeTrialDropdown?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",It,[Object(i["createElementVNode"])("div",Ht,Object(i["toDisplayString"])(e.translate("Marketplace_TryFreeTrialTitle")),1),Object(i["withDirectives"])(Object(i["createElementVNode"])("select",{class:"free-trial-dropdown",title:`${e.translate("Marketplace_ShownPriceIsExclTax")} ${e.translate("Marketplace_CurrentNumPiwikUsers",e.numUsers)}`,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selectedPluginShopVariationUrl=t),onChange:t[2]||(t[2]=(...t)=>e.changeSelectedPluginShopVariationUrl&&e.changeSelectedPluginShopVariationUrl(...t))},[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.plugin.shop.variations,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("option",{key:"var-"+n,value:t.addToCartUrl,title:`${e.translate("Marketplace_PriceExclTax",t.price,t.currency)} ${e.translate("Marketplace_CurrentNumPiwikUsers",e.numUsers)}`},Object(i["toDisplayString"])(t.name)+" - "+Object(i["toDisplayString"])(t.prettyPrice)+" / "+Object(i["toDisplayString"])(t.period),9,zt))),128))],40,Kt),[[i["vModelSelect"],e.selectedPluginShopVariationUrl]])])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(b,{"is-super-user":e.isSuperUser,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-multi-server-environment":e.isMultiServerEnvironment,"is-valid-consumer":e.isValidConsumer,"is-auto-update-possible":e.isAutoUpdatePossible,"activate-nonce":e.activateNonce,"deactivate-nonce":e.deactivateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,plugin:e.plugin,"in-modal":!0,"shop-variation-url":e.selectedShopVariationUrl,onRequestTrial:t[3]||(t[3]=t=>e.emitTrialEvent("requestTrial")),onStartFreeTrial:t[4]||(t[4]=t=>e.emitTrialEvent("startFreeTrial"))},null,8,["is-super-user","is-plugins-admin-enabled","is-multi-server-environment","is-valid-consumer","is-auto-update-possible","activate-nonce","deactivate-nonce","install-nonce","update-nonce","plugin","shop-variation-url"])]),!e.showFreeTrialDropdown&&e.isMatomoPlugin?(Object(i["openBlock"])(),Object(i["createElementBlock"])("img",Gt)):Object(i["createCommentVNode"])("",!0)],2)],2))],512)}function Wt(e,t,n,l,a,r){return Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.plugin.missingRequirements||[],(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:n,class:"alert alert-danger"},Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_MissingRequirementsNotice",e.requirement(t.requirement),t.actualVersion,t.requiredVersion)),1))),128)}var Jt=Object(i["defineComponent"])({props:{plugin:{type:Object,required:!0}},methods:{requirement(e){return"php"===e?"PHP":`${e[0].toUpperCase()}${e.substr(1)}`}}});Jt.render=Wt;var Yt=Jt;const{$:Zt}=window;var Xt=Object(i["defineComponent"])({components:{MissingReqsNotice:Yt,CTAContainer:pe},props:{modelValue:{type:Object,default:()=>({})},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},installNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},isAutoUpdatePossible:{type:Boolean,required:!0},isValidConsumer:{type:Boolean,required:!0},isMultiServerEnvironment:{type:Boolean,required:!0},isPluginsAdminEnabled:{type:Boolean,required:!0},isSuperUser:{type:Boolean,required:!0},hasSomeAdminAccess:{type:Boolean,required:!0},numUsers:{type:Number,required:!0}},data(){return{isLoading:!0,currentPluginShopVariationUrl:""}},emits:["requestTrial","startFreeTrial","update:modelValue"],watch:{modelValue(e){e&&this.showPluginDetailsDialog()},isLoading(e){!1===e&&(this.applyExternalTarget(),this.applyIframeResize())}},computed:{plugin(){return this.modelValue},pluginLatestVersion(){const e=this.plugin.versions||[{}];return e[e.length-1]},pluginReadmeHtml(){var e;return(null===(e=this.pluginLatestVersion)||void 0===e?void 0:e.readmeHtml)||{}},pluginDescription(){var e;return(null===(e=this.pluginReadmeHtml)||void 0===e?void 0:e.description)||""},pluginDocumentation(){var e;return(null===(e=this.pluginReadmeHtml)||void 0===e?void 0:e.documentation)||""},pluginFaq(){var e;return(null===(e=this.pluginReadmeHtml)||void 0===e?void 0:e.faq)||""},pluginShop(){return this.plugin.shop},pluginShopVariations(){var e;return(null===(e=this.pluginShop)||void 0===e?void 0:e.variations)||[]},pluginReviews(){var e;return(null===(e=this.pluginShop)||void 0===e?void 0:e.reviews)||{}},pluginKeywords(){var e;return(null===(e=this.plugin)||void 0===e?void 0:e.keywords)||[]},pluginAuthors(){const e=this.plugin.authors||[];return e.filter(e=>e.name)},pluginActivity(){return this.plugin.activity||{}},pluginChangelogUrl(){return this.plugin.changelog.url||""},pluginSupport(){return this.plugin.support||[]},isMatomoPlugin(){return["piwik","matomo-org"].includes(this.plugin.owner)},pluginOwner(){return this.isMatomoPlugin?"Matomo":this.plugin.owner},showReviews(){return this.pluginReviews&&this.pluginReviews.embedUrl&&this.pluginReviews.averageRating},showMissingLicenseDescription(){return this.hasSomeAdminAccess&&this.plugin.isMissingLicense},showExceededLicenseDescription(){return this.hasSomeAdminAccess&&this.plugin.hasExceededLicense},showMissingRequirementsNoticeIfApplicable(){return this.isSuperUser&&(this.plugin.isDownloadable||this.plugin.isInstalled)},showLicenseName(){var e;const t=(null===(e=this.pluginLatestVersion)||void 0===e?void 0:e.license)||{};return!!t.name},showFreeTrialDropdown(){return this.isSuperUser&&!this.plugin.isMissingLicense&&!this.plugin.isInstalled&&!this.plugin.hasExceededLicense&&this.plugin.isEligibleForFreeTrial},pluginScreenshots(){return this.plugin.screenshots||[]},hasHeaderMetadata(){return this.showReviews||!this.plugin.isBundle||(this.plugin.numDownloads||0)>0||this.plugin.lastUpdated&&!this.plugin.isBundle},pluginShopVariationsPretty(){return this.pluginShopVariations.map(e=>`${e.name} - ${e.prettyPrice} / ${e.period}`)},pluginShopRecommendedVariation(){const e=this.pluginShopVariations.filter(e=>e.recommended),t=this.pluginShopVariations.length?this.pluginShopVariations[0]:null;return e.length?e[0]:t},selectedPluginShopVariationUrl(){var e;return this.currentPluginShopVariationUrl?this.currentPluginShopVariationUrl:(null===(e=this.pluginShopRecommendedVariation)||void 0===e?void 0:e.addToCartUrl)||""},selectedShopVariationUrl(){return this.selectedPluginShopVariationUrl||""}},methods:{changeSelectedPluginShopVariationUrl(e){e&&(this.currentPluginShopVariationUrl=e.target.value)},applyExternalTarget(){setTimeout(()=>{const e=this.$refs.root;Zt(".modal-content__main a",e).each((e,t)=>{const n=Zt(t).attr("href");n&&0===n.indexOf("http")&&Zt(t).attr("target","_blank")})})},scrollElementIntoView(e){setTimeout(()=>{const t=this.$refs.root,n=Zt(e,t);n.length&&n[0]&&n[0].scrollIntoView&&n[0].scrollIntoView({block:"nearest",behavior:"smooth"})})},isValidEmail(e){return e.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},isValidHttpUrl(e){try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(t){return!1}},getProtocolAndDomain(e){const t=new URL(e);return`${t.protocol}//${t.hostname}`},applyIframeResize(){setTimeout(()=>{const{iFrameResize:e}=window;this.pluginReviews&&Zt(()=>{const t=Zt("#pluginDetailsModal iframe.reviewIframe");for(let n=0;n<t.length;n+=1)e({checkOrigin:[this.getProtocolAndDomain(this.pluginReviews.embedUrl)]},t[n])})})},getScreenshotBaseName(e){const t=e.split("/").pop()||"";return t.substring(0,t.lastIndexOf(".")).split("_").join(" ")},emitTrialEvent(e){const{plugin:t}=this;Zt("#pluginDetailsModal").modal("close"),setTimeout(()=>{this.$emit(e,t)},250)},showPluginDetailsDialog(){Zt("#pluginDetailsModal").modal({dismissible:!0,onCloseEnd:()=>{m["MatomoUrl"].updateHash(Object.assign(Object.assign({},m["MatomoUrl"].hashParsed.value),{},{showPlugin:null})),this.$emit("update:modelValue",null),this.isLoading=!0}}).modal("open"),setTimeout(()=>{this.isLoading=!1},10)},getPendingLicenseHelpText(e){return Object(m["translate"])("Marketplace_PluginLicenseStatusPending",e,Object(m["externalLink"])("https://shop.matomo.org/my-account/"),"</a>")},getCancelledLicenseHelpText(e){return Object(m["translate"])("Marketplace_PluginLicenseStatusCancelled",e,Object(m["externalLink"])("https://shop.matomo.org/my-account/"),"</a>")},getDownloadLinkMissingHelpText(e){return Object(m["translate"])("Marketplace_PluginDownloadLinkMissingDescription",e,Object(m["externalLink"])("https://matomo.org/faq/plugins/faq_21/"),"</a>")}}});Xt.render=Qt;var en=Xt;const{$:tn}=window;var nn=Object(i["defineComponent"])({props:{currentUserEmail:String,pluginsToShow:{type:Array,required:!0},isAutoUpdatePossible:{type:Boolean,required:!0},isSuperUser:{type:Boolean,required:!0},isValidConsumer:{type:Boolean,required:!0},isMultiServerEnvironment:{type:Boolean,required:!0},isPluginsAdminEnabled:{type:Boolean,required:!0},hasSomeAdminAccess:{type:Boolean,required:!0},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},installNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},numUsers:{type:Number,required:!0}},data(){return{showRequestTrialForPlugin:null,showStartFreeTrialForPlugin:null,showPluginDetailsForPlugin:null}},components:{PluginDetailsModal:en,CTAContainer:pe,RequestTrial:he,StartFreeTrial:Ue},emits:["triggerUpdate","startTrialStart","startTrialStop"],watch:{pluginsToShow(e,t){e&&e!==t&&(this.shrinkDescriptionIfMultilineTitle(),this.parseShowPluginParameter())}},mounted(){tn(window).resize(()=>{this.shrinkDescriptionIfMultilineTitle()}),Object(i["watch"])(()=>m["MatomoUrl"].hashParsed.value.showPlugin,(e,t)=>{e&&e!==t&&this.parseShowPluginParameter()}),this.parseShowPluginParameter()},methods:{parseShowPluginParameter(){const{showPlugin:e,pluginType:t,query:n}=m["MatomoUrl"].hashParsed.value;if(!e)return;const l=this.pluginsToShow.filter(t=>t.name===e);if(1===l.length){const[e]=l;this.openDetailsModal(e),this.scrollPluginCardIntoView(e)}else""===t&&""===n||m["MatomoUrl"].updateHash(Object.assign(Object.assign({},m["MatomoUrl"].hashParsed.value),{},{pluginType:"plugins",query:null}))},shrinkDescriptionIfMultilineTitle(){const e=tn(".marketplace .card-holder");e&&e.length&&e.each((e,t)=>{const n=tn(t),l=n.find(".card-title"),a=n.find(".card-content-bottom .alert"),i=n.hasClass("card-with-downloads");let r=1;if(l.length){const e=+l.height(),t=+l.css("line-height").replace("px","");var o;if(t)r=null!==(o=Math.ceil(e/t))&&void 0!==o?o:1}let c=0;if(a.length){const e=+a.height(),t=+a.css("line-height").replace("px","");var s;if(t)c=null!==(s=Math.ceil(e/t))&&void 0!==s?s:1}const u=n.find(".card-description");if(u.length){const e=u[0];let t=0;i?((r>=2||c>2||r+c>=4)&&(t=2),r+c>=5&&(t=1)):r+c>=5&&(t=2),t?e.setAttribute("data-clamp",""+t):e.removeAttribute("data-clamp")}})},clickCard(e,t){tn(e.target).closest("a:not(.card-title-link)").length||(e.stopPropagation(),this.openDetailsModal(t))},openDetailsModal(e){this.showPluginDetailsForPlugin=e},scrollPluginCardIntoView(e){const t=tn(`.pluginListContainer .card-title:contains("${e.displayName}")`);if(1!==t.length)return;const n=t.parents(".card");1===n.length&&n[0].scrollIntoView&&n[0].scrollIntoView({block:"start",behavior:"smooth"})},requestTrial(e){this.showRequestTrialForPlugin=e},startFreeTrial(e){this.showStartFreeTrialForPlugin=e}}});nn.render=_;var ln=nn;const an=e=>`${e[0].toLowerCase()}${e.substring(1)}`;var rn=Object(i["defineComponent"])({props:{pluginTypeOptions:{type:Object,required:!0},defaultSort:{type:String,required:!0},pluginSortOptions:{type:Object,required:!0},numAvailablePluginsByType:{type:Object,required:!0},currentUserEmail:String,isValidConsumer:Boolean,isSuperUser:Boolean,isAutoUpdatePossible:Boolean,isPluginsAdminEnabled:Boolean,isMultiServerEnvironment:Boolean,hasSomeAdminAccess:Boolean,installNonce:{type:String,required:!0},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},numUsers:{type:Number,required:!0}},components:{ContentBlock:m["ContentBlock"],Field:b["Field"],MatomoLoader:m["MatomoLoader"],PluginList:ln},data(){return{loading:!1,fetchRequest:null,fetchRequestAbortController:null,pluginSort:this.defaultSort,pluginTypeFilter:"plugins",searchQuery:"",pluginsToShow:[]}},emits:["triggerUpdate","startTrialStart","startTrialStop"],mounted(){m["Matomo"].postEvent("Marketplace.Marketplace.mounted",{element:this.$refs.root}),Object(i["watch"])(()=>m["MatomoUrl"].hashParsed.value,()=>{this.updateValuesFromHash(!1)}),this.updateValuesFromHash(!0)},unmounted(){m["Matomo"].postEvent("Marketplace.Marketplace.unmounted",{element:this.$refs.root})},methods:{updateValuesFromHash(e){let t=e;const n=m["MatomoUrl"].hashParsed.value.query||"",l=m["MatomoUrl"].hashParsed.value.sort||"",a=m["MatomoUrl"].hashParsed.value.pluginType||"";(n||this.searchQuery)&&(t=t||n!==this.searchQuery,this.searchQuery=n),l&&(t=t||l!==this.pluginSort,this.pluginSort=l),a&&(t=t||a!==this.pluginTypeFilter,this.pluginTypeFilter=a),t&&this.fetchPlugins()},updateQuery(e){m["MatomoUrl"].updateHash(Object.assign(Object.assign({},m["MatomoUrl"].hashParsed.value),{},{query:e}))},updateType(e){m["MatomoUrl"].updateHash(Object.assign(Object.assign({},m["MatomoUrl"].hashParsed.value),{},{pluginType:e}))},updateSort(e){m["MatomoUrl"].updateHash(Object.assign(Object.assign({},m["MatomoUrl"].hashParsed.value),{},{sort:e}))},updateMarketplace(){this.fetchPlugins(()=>this.$emit("triggerUpdate"))},fetchPlugins(e){this.loading=!0,this.pluginsToShow=[],this.fetchRequestAbortController&&(this.fetchRequestAbortController.abort(),this.fetchRequestAbortController=null),this.fetchRequestAbortController=new AbortController,this.fetchRequest=m["AjaxHelper"].post({module:"Marketplace",action:"searchPlugins",format:"JSON"},{query:this.searchQuery,sort:this.pluginSort,themesOnly:this.showThemes,purchaseType:"premium"===this.pluginTypeFilter?"paid":""},{withTokenInUrl:!0,abortController:this.fetchRequestAbortController}).then(t=>{this.pluginsToShow=t,"function"===typeof e&&e()}).finally(()=>{this.loading=!1,this.fetchRequestAbortController=null})}},computed:{queryInputTitle(){const e=an(Object(m["translate"])("General_Plugins")),t=this.numAvailablePluginsByType[this.pluginTypeFilter]||0;return`${Object(m["translate"])("General_Search")} ${t} ${e}...`},loadingMessage(){return Object(m["translate"])("Mobile_LoadingReport",Object(m["translate"])(this.showThemes?"CorePluginsAdmin_Themes":"General_Plugins"))},showThemes(){return"themes"===this.pluginTypeFilter}}});rn.render=p;var on=rn;const cn=["innerHTML"],sn={class:"manage-license-key-input"},un={class:"ui-confirm",id:"confirmRemoveLicense",ref:"confirmRemoveLicense"},dn=["value"],pn=["value"];function mn(e,t,n,l,a,r){const o=Object(i["resolveComponent"])("InstallAllPaidPluginsButton"),c=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SaveButton"),u=Object(i["resolveComponent"])("ActivityIndicator"),d=Object(i["resolveComponent"])("ContentBlock");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createVNode"])(d,{"content-title":e.translate("Marketplace_LicenseKey"),class:"manage-license-key"},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",{class:"manage-license-key-intro",innerHTML:e.$sanitize(e.manageLicenseKeyIntro)},null,8,cn),Object(i["createVNode"])(o,{disabled:e.isUpdating},null,8,["disabled"]),Object(i["createElementVNode"])("div",sn,[Object(i["createVNode"])(c,{uicontrol:"text",name:"license_key",modelValue:e.licenseKey,"onUpdate:modelValue":t[0]||(t[0]=t=>e.licenseKey=t),placeholder:e.licenseKeyPlaceholder,"full-width":!0},null,8,["modelValue","placeholder"])]),Object(i["createVNode"])(s,{onConfirm:t[1]||(t[1]=t=>e.updateLicense()),value:e.saveButtonText,disabled:!e.licenseKey||e.isUpdating,id:"submit_license_key"},null,8,["value","disabled"]),e.hasValidLicense?(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:0,id:"remove_license_key",onConfirm:t[2]||(t[2]=t=>e.removeLicense()),disabled:e.isUpdating,value:e.translate("General_Remove")},null,8,["disabled","value"])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(u,{loading:e.isUpdating},null,8,["loading"])]),_:1},8,["content-title"]),Object(i["createElementVNode"])("div",un,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("Marketplace_ConfirmRemoveLicense")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,dn),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,pn)],512)],64)}var bn=Object(i["defineComponent"])({props:{hasValidLicenseKey:Boolean},components:{Field:b["Field"],ContentBlock:m["ContentBlock"],SaveButton:b["SaveButton"],ActivityIndicator:m["ActivityIndicator"],InstallAllPaidPluginsButton:b["InstallAllPaidPluginsButton"]},data(){return{licenseKey:"",hasValidLicense:this.hasValidLicenseKey,isUpdating:!1}},methods:{updateLicenseKey(e,t,n){m["NotificationsStore"].remove("ManageLicenseKeySuccess"),m["AjaxHelper"].post({module:"API",method:"Marketplace."+e,format:"JSON"},{licenseKey:this.licenseKey},{withTokenInUrl:!0}).then(t=>{this.isUpdating=!1,t&&t.value&&(m["NotificationsStore"].show({id:"ManageLicenseKeySuccess",message:n,context:"success",type:"toast"}),this.hasValidLicense="deleteLicenseKey"!==e,this.licenseKey="")},()=>{this.isUpdating=!1})},removeLicense(){m["Matomo"].helper.modalConfirm(this.$refs.confirmRemoveLicense,{yes:()=>{this.isUpdating=!0,this.updateLicenseKey("deleteLicenseKey","",Object(m["translate"])("Marketplace_LicenseKeyDeletedSuccess"))}})},updateLicense(){this.isUpdating=!0,this.updateLicenseKey("saveLicenseKey",this.licenseKey,Object(m["translate"])("Marketplace_LicenseKeyActivatedSuccess"))}},computed:{manageLicenseKeyIntro(){const e="?"+m["MatomoUrl"].stringify(Object.assign(Object.assign({},m["MatomoUrl"].urlParsed.value),{},{module:"Marketplace",action:"overview"}));return Object(m["translate"])("Marketplace_ManageLicenseKeyIntro",`<a href="${e}">`,"</a>",Object(m["externalLink"])("https://shop.matomo.org/my-account"),"</a>")},licenseKeyPlaceholder(){return this.hasValidLicense?Object(m["translate"])("Marketplace_LicenseKeyIsValidShort"):Object(m["translate"])("Marketplace_LicenseKey")},saveButtonText(){return this.hasValidLicense?Object(m["translate"])("CoreUpdater_UpdateTitle"):Object(m["translate"])("Marketplace_ActivateLicenseKey")}}});bn.render=mn;var gn=bn;const On={class:"getNewPlugins"},jn={class:"row"},hn={class:"pluginName"},kn=Object(i["createElementVNode"])("br",null,null,-1),yn={key:0},vn=Object(i["createElementVNode"])("br",null,null,-1),Nn=Object(i["createElementVNode"])("br",null,null,-1),Vn=[vn,Nn],Sn={class:"widgetBody"},En=["href"];function Bn(e,t,n,l,a,r){const o=Object(i["resolveDirective"])("plugin-name");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",On,[Object(i["createElementVNode"])("div",jn,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.plugins,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"col s12",key:t.name},[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("h3",hn,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(t.displayName),1)])),[[o,{pluginName:t.name}]]),Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(t.description)+" ",1),kn,Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("a",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("General_MoreDetails")),1)])),[[o,{pluginName:t.name}]])]),n<e.plugins.length-1?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",yn,Vn)):Object(i["createCommentVNode"])("",!0)]))),128))]),Object(i["createElementVNode"])("div",Sn,[Object(i["createElementVNode"])("a",{href:e.overviewLink},Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_ViewAllMarketplacePlugins")),9,En)])])}var Mn=Object(i["defineComponent"])({props:{plugins:{type:Array,required:!0}},directives:{PluginName:b["PluginName"]},computed:{overviewLink(){return"?"+m["MatomoUrl"].stringify(Object.assign(Object.assign({},m["MatomoUrl"].urlParsed.value),{},{module:"Marketplace",action:"overview"}))}}});Mn.render=Bn;var fn=Mn;const Tn={class:"getNewPlugins isAdminPage",ref:"root"},wn={class:"row"},Cn=["title"],Pn=["title"],Dn={key:0},An=Object(i["createElementVNode"])("br",null,null,-1),Ln=["src"],_n={class:"widgetBody"},Un=["href"];function qn(e,t,n,l,a,r){const o=Object(i["resolveDirective"])("plugin-name");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Tn,[Object(i["createElementVNode"])("div",wn,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.plugins,e=>{var t;return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"col s12 m4",key:e.name},[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("h3",{class:"pluginName",title:e.description},[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.displayName),1)],8,Cn)),[[o,{pluginName:e.name}]]),Object(i["createElementVNode"])("p",{class:"description",title:e.description},Object(i["toDisplayString"])(e.description),9,Pn),null!==(t=e.screenshots)&&void 0!==t&&t.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Dn,[An,Object(i["withDirectives"])(Object(i["createElementVNode"])("img",{class:"screenshot",src:e.screenshots[0]+"?w=600",style:{width:"100%"},alt:""},null,8,Ln),[[o,{pluginName:e.name}]])])):Object(i["createCommentVNode"])("",!0)])}),128))]),Object(i["createElementVNode"])("div",_n,[Object(i["createElementVNode"])("a",{href:e.marketplaceOverviewLink},Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_ViewAllMarketplacePlugins")),9,Un)])],512)}var xn=Object(i["defineComponent"])({props:{plugins:{type:Array,required:!0}},directives:{PluginName:b["PluginName"]},computed:{marketplaceOverviewLink(){return"?"+m["MatomoUrl"].stringify({module:"Marketplace",action:"overview"})}}});xn.render=qn;var Fn=xn;const Rn={class:"getNewPlugins getPremiumFeatures widgetBody"},$n={key:0,class:"col s12 m12"},In=["innerHTML"],Hn={style:{"margin-bottom":"28px",color:"#5bb75b"}},Kn=Object(i["createElementVNode"])("i",{class:"icon-heart red-text"},null,-1),zn={class:"pluginName"},Gn={key:0,class:"pluginSubtitle"},Qn={class:"pluginBody"},Wn=Object(i["createElementVNode"])("br",null,null,-1),Jn={class:"pluginMoreDetails"},Yn={class:"widgetBody"},Zn=["href"];function Xn(e,t,n,l,a,r){const o=Object(i["resolveDirective"])("plugin-name");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Rn,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.pluginRows,(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"row",key:n},[0===n?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",$n,[Object(i["createElementVNode"])("h3",{style:{"font-weight":"bold",color:"#5bb75b"},innerHTML:e.$sanitize(e.trialHintsText)},null,8,In),Object(i["createElementVNode"])("h3",Hn,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_SupportMatomoThankYou"))+" ",1),Kn])])):Object(i["createCommentVNode"])("",!0),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t,t=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"col s12 m4",key:t.name},[Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("h3",zn,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(t.displayName),1)])),[[o,{pluginName:t.name}]]),t.specialOffer?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Gn,[Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translate("Marketplace_SpecialOffer"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(t.specialOffer),1)])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("span",Qn,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(t.isBundle?e.translate("Marketplace_SpecialOffer")+": ":"")+Object(i["toDisplayString"])(t.description)+" ",1),Wn,Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("a",Jn,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("General_MoreDetails")),1)])),[[o,{pluginName:t.name}]])])]))),128))]))),128)),Object(i["createElementVNode"])("div",Yn,[Object(i["createElementVNode"])("a",{href:e.overviewLink},Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_ViewAllMarketplacePlugins")),9,Zn)])])}var el=Object(i["defineComponent"])({props:{plugins:{type:Array,required:!0}},directives:{PluginName:b["PluginName"]},computed:{trialHintsText(){const e=Object(m["externalRawLink"])("https://shop.matomo.org/free-trial/"),t="color:#5bb75b;text-decoration: underline;";return Object(m["translate"])("Marketplace_TrialHints",`<a style="${t}" href="${e}" target="_blank" rel="noreferrer noopener">`,"</a>")},pluginRows(){const e=[];return this.plugins.forEach((t,n)=>{const l=Math.floor(n/3);e[l]=e[l]||[],e[l].push(t)}),e},overviewLink(){const e=m["MatomoUrl"].stringify({module:"Marketplace",action:"overview"}),t=m["MatomoUrl"].stringify({pluginType:"premium"});return`?${e}#?${t}`}}});el.render=Xn;var tl=el;const nl={class:"marketplaceIntro"},ll={key:0},al={key:1},il={key:0,class:"installAllPaidPlugins"};function rl(e,t,n,l,a,r){const o=Object(i["resolveComponent"])("EnrichedHeadline"),c=Object(i["resolveComponent"])("InstallAllPaidPluginsButton"),s=Object(i["resolveComponent"])("Marketplace"),u=Object(i["resolveDirective"])("content-intro");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("h2",null,[Object(i["createVNode"])(o,{"feature-name":e.translate("CorePluginsAdmin_Marketplace")},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_Marketplace")),1)]),_:1},8,["feature-name"])]),Object(i["createElementVNode"])("div",nl,[e.isSuperUser?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",al,Object(i["toDisplayString"])(e.translate("Marketplace_IntroSuperUser")),1)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",ll,Object(i["toDisplayString"])(e.translate("Marketplace_Intro")),1))]),e.installAllPaidPluginsVisible?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",il,[Object(i["createVNode"])(c,{disabled:e.installDisabled},null,8,["disabled"])])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(s,{"plugin-type-options":e.pluginTypeOptions,"default-sort":e.defaultSort,"plugin-sort-options":e.pluginSortOptions,"num-available-plugins-by-type":e.numAvailablePluginsByType,"current-user-email":e.currentUserEmail,"is-auto-update-possible":e.isAutoUpdatePossible,"is-super-user":e.isSuperUser,"is-multi-server-environment":e.isMultiServerEnvironment,"is-plugins-admin-enabled":e.isPluginsAdminEnabled,"is-valid-consumer":e.getIsValidConsumer,"deactivate-nonce":e.deactivateNonce,"activate-nonce":e.activateNonce,"install-nonce":e.installNonce,"update-nonce":e.updateNonce,"has-some-admin-access":e.hasSomeAdminAccess,"num-users":e.numUsers,onTriggerUpdate:t[0]||(t[0]=e=>this.updateOverviewData()),onStartTrialStart:t[1]||(t[1]=e=>this.disableInstallAllPlugins(!0)),onStartTrialStop:t[2]||(t[2]=e=>this.disableInstallAllPlugins(!1))},null,8,["plugin-type-options","default-sort","plugin-sort-options","num-available-plugins-by-type","current-user-email","is-auto-update-possible","is-super-user","is-multi-server-environment","is-plugins-admin-enabled","is-valid-consumer","deactivate-nonce","activate-nonce","install-nonce","update-nonce","has-some-admin-access","num-users"])])),[[u]])}var ol=Object(i["defineComponent"])({props:{currentUserEmail:String,inReportingMenu:Boolean,isValidConsumer:Boolean,isSuperUser:Boolean,isAutoUpdatePossible:Boolean,isPluginsAdminEnabled:Boolean,isMultiServerEnvironment:Boolean,hasSomeAdminAccess:Boolean,installNonce:{type:String,required:!0},activateNonce:{type:String,required:!0},deactivateNonce:{type:String,required:!0},updateNonce:{type:String,required:!0},isPluginUploadEnabled:Boolean,uploadLimit:[String,Number],pluginTypeOptions:{type:Object,required:!0},defaultSort:{type:String,required:!0},pluginSortOptions:{type:Object,required:!0},numAvailablePluginsByType:{type:Object,required:!0},numUsers:{type:Number,required:!0}},components:{InstallAllPaidPluginsButton:b["InstallAllPaidPluginsButton"],EnrichedHeadline:m["EnrichedHeadline"],Marketplace:on},directives:{ContentIntro:m["ContentIntro"]},data(){return{updating:!1,fetchRequest:null,fetchRequestAbortController:null,updateData:null,installDisabled:!1,installLoading:!1}},computed:{getIsValidConsumer(){return this.updateData&&"undefined"!==typeof this.updateData.isValidConsumer?this.updateData.isValidConsumer:this.isValidConsumer},installAllPaidPluginsVisible(){return this.getIsValidConsumer&&this.isSuperUser&&this.isAutoUpdatePossible&&this.isPluginsAdminEnabled||this.installDisabled&&this.installLoading},showThemes(){return"themes"===m["MatomoUrl"].hashParsed.value.pluginType}},methods:{disableInstallAllPlugins(e){this.installDisabled=!0,this.installLoading=e},enableInstallAllPlugins(){this.installDisabled=!1,this.installLoading=!1},updateOverviewData(){this.updating=!0,this.isSuperUser&&this.disableInstallAllPlugins(!0),this.fetchRequestAbortController&&(this.fetchRequestAbortController.abort(),this.fetchRequestAbortController=null),this.fetchRequestAbortController=new AbortController,this.fetchRequest=m["AjaxHelper"].post({module:"Marketplace",action:"updateOverview",format:"JSON"},{},{withTokenInUrl:!0,abortController:this.fetchRequestAbortController}).then(e=>{this.updateData=e}).finally(()=>{this.updating=!1,this.fetchRequestAbortController=null,this.enableInstallAllPlugins()})}}});ol.render=rl;var cl=ol;const sl={key:0},ul=["href"],dl=Object(i["createElementVNode"])("br",null,null,-1),pl=Object(i["createElementVNode"])("br",null,null,-1),ml=["innerHTML"],bl=Object(i["createElementVNode"])("br",null,null,-1),gl={class:"subscriptionName"},Ol=["href"],jl={key:1},hl={class:"subscriptionType"},kl=["title"],yl={key:0,class:"icon-error"},vl={key:1,class:"icon-warning"},Nl={key:2,class:"icon-error"},Vl={key:3,class:"icon-ok"},Sl=["title"],El=Object(i["createElementVNode"])("span",{class:"icon-error"},null,-1),Bl={key:0},Ml={colspan:"6"},fl={class:"tableActionBar"},Tl=["href"],wl=Object(i["createElementVNode"])("span",{class:"icon-table"},null,-1),Cl={key:1},Pl=["innerHTML"];function Dl(e,t,n,l,a,r){const o=Object(i["resolveComponent"])("ContentBlock"),c=Object(i["resolveDirective"])("content-table");return Object(i["openBlock"])(),Object(i["createBlock"])(o,{"content-title":e.translate("Marketplace_OverviewPluginSubscriptions"),class:"subscriptionOverview"},{default:Object(i["withCtx"])(()=>[e.hasLicenseKey?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",sl,[Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("Marketplace_PluginSubscriptionsList"))+" ",1),e.loginUrl?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,target:"_blank",rel:"noreferrer noopener",href:e.loginUrl},Object(i["toDisplayString"])(e.translate("Marketplace_OverviewPluginSubscriptionsAllDetails")),9,ul)):Object(i["createCommentVNode"])("",!0),dl,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("Marketplace_OverviewPluginSubscriptionsMissingInfo"))+" ",1),pl,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("Marketplace_NoValidSubscriptionNoUpdates"))+" ",1),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("Marketplace_CurrentNumPiwikUsers",`<strong>${e.numUsers}</strong>`))},null,8,ml)]),bl,Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("table",null,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_Name")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("Marketplace_SubscriptionType")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("Marketplace_SubscriptionStartDate")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("Marketplace_SubscriptionEndDate")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("Marketplace_SubscriptionNextPaymentDate")),1)])]),Object(i["createElementVNode"])("tbody",null,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.subscriptions||[],(t,n)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{key:n},[Object(i["createElementVNode"])("td",gl,[t.plugin.htmlUrl?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,href:t.plugin.htmlUrl,rel:"noreferrer noopener",target:"_blank"},Object(i["toDisplayString"])(t.plugin.displayName),9,Ol)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",jl,Object(i["toDisplayString"])(t.plugin.displayName),1))]),Object(i["createElementVNode"])("td",hl,Object(i["toDisplayString"])(t.productType),1),Object(i["createElementVNode"])("td",{class:"subscriptionStatus",title:e.getSubscriptionStatusTitle(t)},[t.isValid?t.isExpiredSoon?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",vl)):""!==t.status&&"Active"!==t.status?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Nl)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Vl)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",yl)),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(t.status)+" ",1),t.isExceeded?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:4,class:"errorMessage",title:e.translate("Marketplace_LicenseExceededPossibleCause")},[El,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("Marketplace_Exceeded")),1)],8,Sl)):Object(i["createCommentVNode"])("",!0)],8,kl),Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.start),1),Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.isValid&&t.nextPayment?e.translate("Marketplace_LicenseRenewsNextPaymentDate"):t.end),1),Object(i["createElementVNode"])("td",null,Object(i["toDisplayString"])(t.nextPayment),1)]))),128)),e.subscriptions.length?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",Bl,[Object(i["createElementVNode"])("td",Ml,Object(i["toDisplayString"])(e.translate("Marketplace_NoSubscriptionsFound")),1)]))])])),[[c]]),Object(i["createElementVNode"])("div",fl,[Object(i["createElementVNode"])("a",{href:e.marketplaceOverviewLink,class:""},[wl,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("Marketplace_BrowseMarketplace")),1)],8,Tl)])])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Cl,[Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.missingLicenseText)},null,8,Pl)]))]),_:1},8,["content-title"])}var Al=Object(i["defineComponent"])({props:{loginUrl:{type:String,required:!0},numUsers:{type:Number,required:!0},hasLicenseKey:Boolean,subscriptions:{type:Array,required:!0}},components:{ContentBlock:m["ContentBlock"]},directives:{ContentTable:m["ContentTable"]},methods:{getSubscriptionStatusTitle(e){return e.isValid?e.isExpiredSoon?Object(m["translate"])("Marketplace_SubscriptionExpiresSoon"):void 0:Object(m["translate"])("Marketplace_SubscriptionInvalid")}},computed:{marketplaceOverviewLink(){return"?"+m["MatomoUrl"].stringify({module:"Marketplace",action:"overview"})},licenseKeyLink(){return"?"+m["MatomoUrl"].stringify({module:"Marketplace",action:"manageLicenseKey"})},missingLicenseText(){return Object(m["translate"])("Marketplace_OverviewPluginSubscriptionsMissingLicenseMessage",`<a href="${this.licenseKeyLink}">`,"</a>",`<a href="${this.marketplaceOverviewLink}">`,"</a>")}}});Al.render=Dl;var Ll=Al;const _l={class:"richMarketplaceMenuButton"},Ul=Object(i["createElementVNode"])("hr",null,null,-1),ql={class:"intro"},xl={class:"cta"},Fl=Object(i["createElementVNode"])("span",{class:"icon-marketplace"}," ",-1);function Rl(e,t,n,l,a,r){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",_l,[Ul,Object(i["createElementVNode"])("p",ql,Object(i["toDisplayString"])(e.translate("Marketplace_RichMenuIntro")),1),Object(i["createElementVNode"])("p",xl,[Object(i["createElementVNode"])("a",{class:"btn btn-outline",tabindex:"5",href:"",onClick:t[0]||(t[0]=Object(i["withModifiers"])(t=>e.$emit("action"),["prevent"])),onKeyup:t[1]||(t[1]=Object(i["withKeys"])(t=>e.$emit("action"),["enter"]))},[Fl,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("Marketplace_Marketplace")),1)],32)])])}var $l=Object(i["defineComponent"])({});$l.render=Rl;var Il=$l;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["ProfessionalServices"]=t(require("CoreHome")):e["ProfessionalServices"]=t(e["CoreHome"])})("undefined"!==typeof self?self:this,(function(e){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/ProfessionalServices/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"DismissPromoWidget",(function(){return s})),"undefined"!==typeof window){var r=window.document.currentScript,n=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(o.p=n[1])}var i=o("19dc");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function a(e,t){const{widgetName:o}=e.value,r=i["ReportingMenuStore"].activeCategory.value;return t.preventDefault(),i["Matomo"].helper.showAjaxLoading(),i["AjaxHelper"].post({method:"ProfessionalServices.dismissWidget"},{widgetName:o}).catch(e=>{throw i["Matomo"].helper.hideAjaxLoading(),e}).then(()=>{i["ReportingMenuStore"].reloadMenuItems().then(()=>{i["Matomo"].helper.hideAjaxLoading(),i["MatomoUrl"].updateHash("category=Dashboard_Dashboard&subcategory=1"),i["NotificationsStore"].show({id:"ProfessionalServices_PromoWidgetDismissed",animate:!1,context:"info",noclear:!0,message:Object(i["translate"])("ProfessionalServices_DismissedNotification",Object(i["translate"])(r)),type:"toast"})})})}var s={mounted(e,t){const{widgetName:o}=t.value;o&&(t.value.onClickHandler=a.bind(null,t),e.addEventListener("click",t.value.onClickHandler))},unmounted(e,t){e.removeEventListener("click",t.value.onClickHandler)}};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["CustomDimensions"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["CustomDimensions"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/CustomDimensions/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"CustomDimensionsStore",(function(){return r})),n.d(t,"Edit",(function(){return U})),n.d(t,"List",(function(){return ne})),n.d(t,"Manage",(function(){return be})),"undefined"!==typeof window){var i=window.document.currentScript,o=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var s=n("8bbf"),a=n("19dc");function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class l{constructor(){c(this,"privateState",Object(s["reactive"])({customDimensions:[],availableScopes:[],extractionDimensions:[],isLoading:!1,isUpdating:!1})),c(this,"state",Object(s["computed"])(()=>Object(s["readonly"])(this.privateState))),c(this,"isLoading",Object(s["computed"])(()=>this.state.value.isLoading)),c(this,"isUpdating",Object(s["computed"])(()=>this.state.value.isUpdating)),c(this,"extractionDimensions",Object(s["computed"])(()=>this.state.value.extractionDimensions)),c(this,"extractionDimensionsOptions",Object(s["computed"])(()=>this.extractionDimensions.value.map(e=>({key:e.value,value:e.name})))),c(this,"availableScopes",Object(s["computed"])(()=>this.state.value.availableScopes)),c(this,"customDimensions",Object(s["computed"])(()=>this.state.value.customDimensions)),c(this,"customDimensionsById",Object(s["computed"])(()=>{const e={};return this.customDimensions.value.forEach(t=>{e[""+t.idcustomdimension]=t}),e})),c(this,"reloadPromise",null)}reload(){return this.privateState.customDimensions=[],this.privateState.availableScopes=[],this.privateState.extractionDimensions=[],this.reloadPromise=null,this.fetch()}fetch(){return this.reloadPromise||(this.privateState.isLoading=!0,this.reloadPromise=Promise.all([this.fetchConfiguredCustomDimensions(),this.fetchAvailableExtractionDimensions(),this.fetchAvailableScopes()]).finally(()=>{this.privateState.isLoading=!1})),this.reloadPromise}fetchConfiguredCustomDimensions(){return a["AjaxHelper"].fetch({method:"CustomDimensions.getConfiguredCustomDimensions",filter_limit:"-1"}).then(e=>{this.privateState.customDimensions=e})}fetchAvailableExtractionDimensions(){return a["AjaxHelper"].fetch({method:"CustomDimensions.getAvailableExtractionDimensions",filter_limit:"-1"}).then(e=>{this.privateState.extractionDimensions=e})}fetchAvailableScopes(){return a["AjaxHelper"].fetch({method:"CustomDimensions.getAvailableScopes",filter_limit:"-1"}).then(e=>{this.privateState.availableScopes=e})}createOrUpdateDimension(e,t){return this.privateState.isUpdating=!0,a["AjaxHelper"].post({method:t,scope:e.scope,idDimension:e.idcustomdimension,idSite:e.idsite,name:e.name,active:e.active?"1":"0",caseSensitive:e.case_sensitive?"1":"0"},{extractions:e.extractions}).finally(()=>{this.privateState.isUpdating=!1})}}var r=new l;const m={class:"editCustomDimension"},d={class:"loadingPiwik"},u={class:"row form-group"},p={class:"col s12"},b={class:"col s12 m6"},j={class:"row"},O={class:"col s12 m6"},h={class:"col s12 m6"},v={class:"col s12"},D=["onClick"],C={class:"row"},f={class:"col s12"},V={class:"col s12 m6 form-help"},E=["value","disabled"],g=["value","disabled"],S={class:"btn cancel",type:"button",href:"#list"},N={class:"alert alert-info howToTrackInfo"},x=["innerHTML"],y=["innerHTML"],k=["innerHTML"],w=["innerHTML"];function _(e,t,n,i,o,a){const c=Object(s["resolveComponent"])("MatomoLoader"),l=Object(s["resolveComponent"])("Field"),r=Object(s["resolveComponent"])("ContentBlock"),_=Object(s["resolveDirective"])("copy-to-clipboard");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",m,[Object(s["createVNode"])(r,{"content-title":e.contentTitleText},{default:Object(s["withCtx"])(()=>{var n;return[Object(s["withDirectives"])(Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("span",d,[Object(s["createVNode"])(c),Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[s["vShow"],e.isLoading||e.isUpdating]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",null,[Object(s["createElementVNode"])("form",{onSubmit:t[4]||(t[4]=Object(s["withModifiers"])(t=>e.edit?e.updateCustomDimension():e.createCustomDimension(),["prevent"]))},[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(l,{uicontrol:"text",name:"name",modelValue:e.dimension.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.dimension.name=t),maxlength:255,required:!0,title:e.translate("General_Name"),"inline-help":e.translate("CustomDimensions_NameAllowedCharacters")},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(l,{uicontrol:"checkbox",name:"active",modelValue:e.dimension.active,"onUpdate:modelValue":t[1]||(t[1]=t=>e.dimension.active=t),title:e.translate("CorePluginsAdmin_Active"),"inline-help":e.translate("CustomDimensions_CannotBeDeleted")},null,8,["modelValue","title","inline-help"])]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",u,[Object(s["createElementVNode"])("h3",p,Object(s["toDisplayString"])(e.translate("CustomDimensions_ExtractValue")),1),Object(s["createElementVNode"])("div",b,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.dimension.extractions,(n,i)=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{class:Object(s["normalizeClass"])("extraction"+i),key:i},[Object(s["createElementVNode"])("div",j,[Object(s["createElementVNode"])("div",O,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(l,{uicontrol:"select",name:"dimension"+i,modelValue:n.dimension,"onUpdate:modelValue":e=>n.dimension=e,"full-width":!0,options:e.extractionDimensionsOptions},null,8,["name","modelValue","onUpdate:modelValue","options"])])]),Object(s["createElementVNode"])("div",h,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(l,{uicontrol:"text",name:"pattern"+i,modelValue:n.pattern,"onUpdate:modelValue":e=>n.pattern=e,"full-width":!0,title:"urlparam"===n.dimension?e.translate("CustomDimensions_UrlQueryStringParameter"):"eg. /blog/(.*)/"},null,8,["name","modelValue","onUpdate:modelValue","title"])])]),Object(s["createElementVNode"])("div",v,[Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"icon-plus",onClick:t[2]||(t[2]=t=>e.addExtraction())},null,512),[[s["vShow"],n.pattern]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"icon-minus",onClick:t=>e.removeExtraction(i)},null,8,D),[[s["vShow"],e.dimension.extractions.length>1]])])])],2))),128)),Object(s["createElementVNode"])("div",C,[Object(s["createElementVNode"])("div",f,[Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createVNode"])(l,{uicontrol:"checkbox",name:"casesensitive",modelValue:e.dimension.case_sensitive,"onUpdate:modelValue":t[3]||(t[3]=t=>e.dimension.case_sensitive=t),title:e.translate("Goals_CaseSensitive")},null,8,["modelValue","title"]),[[s["vShow"],null===(n=e.dimension.extractions[0])||void 0===n?void 0:n.pattern]])])])])]),Object(s["createElementVNode"])("div",V,Object(s["toDisplayString"])(e.translate("CustomDimensions_ExtractionsHelp")),1)],512),[[s["vShow"],e.doesScopeSupportExtraction]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{class:"btn update",type:"submit",value:e.translate("General_Update"),disabled:e.isUpdating,style:{"margin-right":"3.5px"}},null,8,E),[[s["vShow"],e.edit]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{class:"btn create",type:"submit",value:e.translate("General_Create"),disabled:e.isUpdating,style:{"margin-right":"3.5px"}},null,8,g),[[s["vShow"],e.create]]),Object(s["createElementVNode"])("a",S,Object(s["toDisplayString"])(e.translate("General_Cancel")),1)],32),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",N,[Object(s["createElementVNode"])("strong",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyTitle")),1),Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaJs")),1),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("pre",null,[Object(s["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCodeViaJs(e.dimension))},null,8,x)])),[[_,{}]])]),Object(s["createElementVNode"])("p",{innerHTML:e.$sanitize(e.howToTrackManuallyText)},null,8,y),Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaPhp")),1),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("pre",null,[Object(s["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCodeViaPhp(e.dimension))},null,8,k)])),[[_,{}]])]),Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaHttp")),1),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("pre",null,[Object(s["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCode)},null,8,w)])),[[_,{}]])])],512),[[s["vShow"],e.edit]])],512),[[s["vShow"],!e.isLoading]])]}),_:1},8,["content-title"])])}var T=n("a5a2");
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function M(e){return`${e[0].toUpperCase()}${e.slice(1)}`}const B="customdimensions";var L=Object(s["defineComponent"])({props:{dimensionId:Number,dimensionScope:{type:String,required:!0}},components:{ContentBlock:a["ContentBlock"],Field:T["Field"],MatomoLoader:a["MatomoLoader"]},directives:{CopyToClipboard:a["CopyToClipboard"]},data(){return{dimension:{extractions:[]},isUpdatingDim:!1}},created(){this.init()},watch:{dimensionId(){this.init()}},methods:{removeAnyCustomDimensionNotification(){a["NotificationsStore"].remove(B)},showNotification(e,t){a["NotificationsStore"].show({message:e,context:t,id:B,type:"transient"})},init(){null!==this.dimensionId&&this.removeAnyCustomDimensionNotification(),r.fetch().then(()=>{if(this.edit&&this.dimensionId){const e=r.customDimensionsById.value[this.dimensionId];if(!e)return void a["MatomoUrl"].updateHashToUrl("/list");this.dimension=Object(a["clone"])(e),this.dimension&&!this.dimension.extractions.length&&this.addExtraction()}else this.create&&(this.dimension={idsite:a["Matomo"].idSite,name:"",active:!0,extractions:[],scope:this.dimensionScope,case_sensitive:!0},this.addExtraction())})},removeExtraction(e){e>-1&&this.dimension.extractions.splice(e,1)},addExtraction(){this.doesScopeSupportExtraction&&this.dimension.extractions.push({dimension:"url",pattern:""})},createCustomDimension(){this.isUpdatingDim=!0,r.createOrUpdateDimension(this.dimension,"CustomDimensions.configureNewCustomDimension").then(()=>{this.showNotification(Object(a["translate"])("CustomDimensions_DimensionCreated"),"success"),r.reload(),a["MatomoUrl"].updateHashToUrl("/list")}).finally(()=>{this.isUpdatingDim=!1})},updateCustomDimension(){this.isUpdatingDim=!0,r.createOrUpdateDimension(this.dimension,"CustomDimensions.configureExistingCustomDimension").then(()=>{this.showNotification(Object(a["translate"])("CustomDimensions_DimensionUpdated"),"success"),r.reload(),a["MatomoUrl"].updateHashToUrl("/list")}).finally(()=>{this.isUpdatingDim=!1})},manuallyTrackCodeViaJs(e){return`_paq.push(['setCustomDimension', ${e.idcustomdimension}, '${Object(a["translate"])("CustomDimensions_ExampleValue")}']);`},manuallyTrackCodeViaPhp(e){return`$tracker->setCustomDimension('${e.idcustomdimension}', '${Object(a["translate"])("CustomDimensions_ExampleValue")}');`}},computed:{isLoading(){return r.isLoading.value},isUpdating(){return r.isUpdating.value||this.isUpdatingDim},create(){return 0===this.dimensionId},edit(){return!this.create},extractionDimensionsOptions(){return r.extractionDimensionsOptions.value},availableScopes(){return r.availableScopes.value},doesScopeSupportExtraction(){var e;if(null===(e=this.dimension)||void 0===e||!e.scope||!this.availableScopes)return!1;const t=this.availableScopes.find(e=>e.value===this.dimension.scope);return null===t||void 0===t?void 0:t.supportsExtractions},contentTitleText(){var e;return Object(a["translate"])("CustomDimensions_ConfigureDimension",M(this.dimensionScope),""+((null===(e=this.dimension)||void 0===e?void 0:e.index)||""))},howToTrackManuallyText(){const e="https://developer.piwik.org/guides/tracking-javascript-guide#custom-dimensions";return Object(a["translate"])("CustomDimensions_HowToTrackManuallyViaJsDetails",`<a target=_blank href="${e}" rel="noreferrer noopener">`,"</a>")},manuallyTrackCode(){const e=Object(a["translate"])("CustomDimensions_ExampleValue");return`&dimension${this.dimension.idcustomdimension}=${e}`}}});L.render=_;var U=L;const H=["innerHTML"],A={class:"loadingPiwik"},I={class:"index"},P={class:"name"},$={class:"active"},q={class:"action"},z={colspan:"5"},G={class:"index"},F={class:"name"},J={class:"extractions"},Q={class:"active"},X={class:"action"},Y=["href"],K={class:"tableActionBar"},R=["disabled","onClick"],W=Object(s["createElementVNode"])("span",{class:"icon-add"},null,-1),Z={class:"info"};function ee(e,t,n,i,o,a){const c=Object(s["resolveComponent"])("EnrichedHeadline"),l=Object(s["resolveComponent"])("MatomoLoader"),r=Object(s["resolveComponent"])("ContentBlock"),m=Object(s["resolveDirective"])("content-intro"),d=Object(s["resolveDirective"])("content-table");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",null,[Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("div",null,[Object(s["createElementVNode"])("h2",null,[Object(s["createVNode"])(c,null,{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("CustomDimensions_CustomDimensions")),1)]),_:1})]),Object(s["createElementVNode"])("p",{innerHTML:e.$sanitize(e.contentIntroText)},null,8,H),Object(s["withDirectives"])(Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("span",A,[Object(s["createVNode"])(l),Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[s["vShow"],e.isLoading]])])),[[m]]),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.availableScopes,t=>Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{key:t.value,class:Object(s["normalizeClass"])("scope-"+t.value)},[Object(s["createVNode"])(r,{"content-title":e.translate("CustomDimensions_ScopeTitle"+e.ucfirst(t.value))},{default:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_ScopeDescription"+e.ucfirst(t.value)))+" "+Object(s["toDisplayString"])(e.translate(`CustomDimensions_ScopeDescription${e.ucfirst(t.value)}MoreInfo`)),1),Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("table",null,[Object(s["createElementVNode"])("thead",null,[Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("th",I,Object(s["toDisplayString"])(e.translate("General_Id")),1),Object(s["createElementVNode"])("th",P,Object(s["toDisplayString"])(e.translate("General_Name")),1),Object(s["withDirectives"])(Object(s["createElementVNode"])("th",{class:"extractions"},Object(s["toDisplayString"])(e.translate("CustomDimensions_Extractions")),513),[[s["vShow"],t.supportsExtractions]]),Object(s["createElementVNode"])("th",$,Object(s["toDisplayString"])(e.translate("CorePluginsAdmin_Active")),1),Object(s["createElementVNode"])("th",q,Object(s["toDisplayString"])(e.translate("General_Action")),1)])]),Object(s["createElementVNode"])("tbody",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("td",z,Object(s["toDisplayString"])(e.translate("CustomDimensions_NoCustomDimensionConfigured")),1)],512),[[s["vShow"],0===t.numSlotsUsed&&!e.isLoading]]),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.sortedCustomDimensionsByScope[t.value],e=>{var n;return Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",{class:Object(s["normalizeClass"])(["customdimension","customdimension-"+e.idcustomdimension]),key:e.idcustomdimension},[Object(s["createElementVNode"])("td",G,Object(s["toDisplayString"])(e.idcustomdimension),1),Object(s["createElementVNode"])("td",F,Object(s["toDisplayString"])(e.name),1),Object(s["withDirectives"])(Object(s["createElementVNode"])("td",J,[Object(s["createElementVNode"])("span",{class:Object(s["normalizeClass"])({"icon-ok":null===(n=e.extractions[0])||void 0===n?void 0:n.pattern})},null,2)],512),[[s["vShow"],t.supportsExtractions]]),Object(s["createElementVNode"])("td",Q,[Object(s["createElementVNode"])("span",{class:Object(s["normalizeClass"])({"icon-ok":e.active})},null,2)]),Object(s["createElementVNode"])("td",X,[Object(s["createElementVNode"])("a",{class:"table-action icon-edit",href:`#?idDimension=${e.idcustomdimension}&scope=${t.value}`},null,8,Y)])],2)}),128))])])),[[d]]),Object(s["createElementVNode"])("div",K,[Object(s["withDirectives"])(Object(s["createElementVNode"])("button",{class:"btn",disabled:!t.numSlotsLeft,onClick:n=>e.addDimension(t.value)},[W,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("CustomDimensions_ConfigureNewDimension"))+" ",1),Object(s["createElementVNode"])("span",Z,"("+Object(s["toDisplayString"])(e.translate("CustomDimensions_XofYLeft",t.numSlotsLeft,t.numSlotsAvailable))+")",1)],8,R),[[s["vShow"],!e.isLoading]])])]),_:2},1032,["content-title"])],2)),[[s["vShow"],!e.isLoading]])),128))])}var te=Object(s["defineComponent"])({name:"listcustomdimensions",components:{MatomoLoader:a["MatomoLoader"],EnrichedHeadline:a["EnrichedHeadline"],ContentBlock:a["ContentBlock"]},directives:{ContentIntro:a["ContentIntro"],ContentTable:a["ContentTable"]},created(){r.fetch()},methods:{ucfirst(e){return M(e)},addDimension(e){a["MatomoUrl"].updateHashToUrl("/?idDimension=0&scope="+e)}},computed:{isLoading(){return r.isLoading.value},availableScopes(){return r.availableScopes.value},contentIntroText(){const e=Object(a["translate"])("CustomDimensions_CustomDimensionsIntroNext",'<a target=_blank href="https://piwik.org/docs/custom-variables">',"</a>",'<a target=_blank href="https://piwik.org/faq/general/faq_21117">',"</a>"),t=Object(a["translate"])("CustomDimensions_CustomDimensionsIntro",'<a target=_blank href="https://piwik.org/docs/custom-dimensions">',"</a>",this.siteName);return`${e}${t}`},customDimensions(){return r.customDimensions.value},sortedCustomDimensions(){const e=[...this.customDimensions];return e.sort((e,t)=>{const n=parseInt(""+e.idcustomdimension,10),i=parseInt(""+t.idcustomdimension,10);return n-i}),e},sortedCustomDimensionsByScope(){const e={};return this.sortedCustomDimensions.reduce((e,t)=>(e[t.scope]=e[t.scope]||[],e[t.scope].push(t),e),e),e},siteName(){return a["Matomo"].helper.htmlEntities(a["Matomo"].helper.htmlDecode(a["Matomo"].siteName))}}});te.render=ee;var ne=te;const ie={class:"manageCustomDimensions"},oe={key:0},se=Object(s["createElementVNode"])("br",null,null,-1),ae=Object(s["createElementVNode"])("br",null,null,-1),ce=Object(s["createElementVNode"])("br",null,null,-1),le=Object(s["createElementVNode"])("br",null,null,-1),re=["textContent"],me=["textContent"],de={key:1};function ue(e,t,n,i,o,a){const c=Object(s["resolveComponent"])("CustomDimensionsList"),l=Object(s["resolveComponent"])("ContentBlock"),r=Object(s["resolveComponent"])("CustomDimensionsEdit"),m=Object(s["resolveDirective"])("copy-to-clipboard");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",ie,[e.editMode?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",oe,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c)]),Object(s["createVNode"])(l,{id:"customDimensionsCreateMoreDimensions","content-title":e.translate("CustomDimensions_IncreaseAvailableCustomDimensionsTitle")},{default:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("p",null,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("CustomDimensions_IncreaseAvailableCustomDimensionsTakesLong"))+" ",1),se,ae,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToCreateCustomDimension"))+" ",1),ce,le]),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("pre",null,[Object(s["createElementVNode"])("code",{textContent:Object(s["toDisplayString"])(e.addCustomDimCode)},null,8,re)])),[[m,{}]])]),Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("CustomDimensions_HowToManyCreateCustomDimensions"))+" "+Object(s["toDisplayString"])(e.translate("CustomDimensions_ExampleCreateCustomDimensions",5)),1),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("pre",null,[Object(s["createElementVNode"])("code",{textContent:Object(s["toDisplayString"])(e.addMultipleCustomDimCode)},null,8,me)])),[[m,{}]])])]),_:1},8,["content-title"])])),e.editMode?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",de,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(r,{"dimension-id":e.dimensionId,"dimension-scope":e.dimensionScope},null,8,["dimension-id","dimension-scope"])])])):Object(s["createCommentVNode"])("",!0)])}var pe=Object(s["defineComponent"])({components:{CustomDimensionsList:ne,ContentBlock:a["ContentBlock"],CustomDimensionsEdit:U},directives:{CopyToClipboard:a["CopyToClipboard"]},data(){return{editMode:!1,dimensionId:null,dimensionScope:""}},created(){Object(s["watch"])(()=>a["MatomoUrl"].hashParsed.value,()=>{this.initState()}),this.initState()},methods:{getValidDimensionScope(e){return-1!==["action","visit"].indexOf(e)?e:""},initState(){const e=a["MatomoUrl"].hashParsed.value.idDimension;if(e){const t=this.getValidDimensionScope(a["MatomoUrl"].hashParsed.value.scope);if("0"===e){const e={isAllowed:!0,scope:t};if(a["Matomo"].postEvent("CustomDimensions.initAddDimension",e),e&&!e.isAllowed)return this.editMode=!1,this.dimensionId=null,void(this.dimensionScope="")}this.editMode=!0,this.dimensionId=parseInt(e,10),this.dimensionScope=t}else this.editMode=!1,this.dimensionId=null,this.dimensionScope="";a["Matomo"].helper.lazyScrollToContent()}},computed:{addCustomDimCode(){return"./console customdimensions:add-custom-dimension --scope=action\n./console customdimensions:add-custom-dimension --scope=visit"},addMultipleCustomDimCode(){return"./console customdimensions:add-custom-dimension --scope=action --count=5"}}});pe.render=ue;var be=pe;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["JsTrackerInstallCheck"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["JsTrackerInstallCheck"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,s){return function(e){var t={};function s(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="plugins/JsTrackerInstallCheck/vue/dist/",s(s.s="fae3")}({"19dc":function(t,s){t.exports=e},"8bbf":function(e,s){e.exports=t},a5a2:function(e,t){e.exports=s},fae3:function(e,t,s){"use strict";if(s.r(t),s.d(t,"JsTrackerInstallCheck",(function(){return O})),"undefined"!==typeof window){var n=window.document.currentScript,r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(s.p=r[1])}var i=s("8bbf");const c={class:"jsTrackerInstallCheck"},o={class:"row testInstallFields"},a={class:"col s2"},l={class:"col s10"},u=["disabled","value"],d={class:"system-success success-message"},h=Object(i["createElementVNode"])("span",{class:"icon-ok"},null,-1),p={class:"system-errors test-error"},m=Object(i["createElementVNode"])("span",{class:"icon-warning"},null,-1),T=["innerHTML"];function b(e,t,s,n,r,b){const f=Object(i["resolveComponent"])("Field"),k=Object(i["resolveComponent"])("ActivityIndicator");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translate("JsTrackerInstallCheck_OptionalTestInstallationDescription")),1),Object(i["createElementVNode"])("div",c,[Object(i["createElementVNode"])("div",o,[Object(i["createElementVNode"])("div",a,[Object(i["createVNode"])(f,{uicontrol:"url",name:"baseUrl",placeholder:"https://example.com",modelValue:e.baseUrl,"onUpdate:modelValue":t[0]||(t[0]=t=>e.baseUrl=t),"full-width":!0,disabled:e.isTesting},null,8,["modelValue","disabled"])]),Object(i["createElementVNode"])("div",l,[Object(i["createElementVNode"])("input",{type:"button",class:"btn testInstallBtn",onClick:t[1]||(t[1]=(...t)=>e.initiateTrackerTest&&e.initiateTrackerTest(...t)),disabled:!e.baseUrl||e.isTesting,value:e.translate("JsTrackerInstallCheck_TestInstallationBtnText")},null,8,u)])]),Object(i["createVNode"])(k,{loading:e.isTesting,loadingMessage:e.translate("General_Testing")},null,8,["loading","loadingMessage"]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",d,[h,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("JsTrackerInstallCheck_JsTrackingCodeInstallCheckSuccessMessage")),1)],512),[[i["vShow"],e.isTestSuccess]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",p,[m,Object(i["createTextVNode"])("  "),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.getTestFailureMessage)},null,8,T)],512),[[i["vShow"],e.isTestComplete&&!e.isTestSuccess]])])],64)}var f=s("19dc"),k=s("a5a2");const g=10,C=1e3;var j=Object(i["defineComponent"])({components:{Field:k["Field"],ActivityIndicator:f["ActivityIndicator"]},data(){return{checkNonce:"",isTesting:!1,isTestComplete:!1,isTestSuccess:!1,testTimeoutCount:0,baseUrl:""}},props:{site:{type:Object,required:!0},isWordpress:{type:Boolean,required:!1,default:!1}},created(){this.checkWhetherSuccessWasRecorded()},watch:{site(){this.onSiteChange()}},methods:{onSiteChange(){this.checkNonce="",this.isTesting=!1,this.isTestComplete=!1,this.isTestSuccess=!1,this.testTimeoutCount=0,this.checkWhetherSuccessWasRecorded()},initiateTrackerTest(){this.isTesting=!0,this.isTestComplete=!1,this.isTestSuccess=!1,this.testTimeoutCount=0;const e=this.site,t={idSite:e.id,url:""};this.baseUrl&&(t.url=this.baseUrl),f["AjaxHelper"].post({module:"API",method:"JsTrackerInstallCheck.initiateJsTrackerInstallTest"},t).then(e=>{const t=e&&e.url&&e.nonce;if(t){this.checkNonce=e.nonce;const t=window.open(e.url);this.setCheckInTime(),setTimeout(()=>{t&&!t.closed&&(t.close(),this.testTimeoutCount=g)},g*C)}}).catch(()=>{this.isTesting=!1})},setCheckInTime(){setTimeout(this.checkWhetherSuccessWasRecorded,C)},checkWhetherSuccessWasRecorded(){const e=this.site,t={idSite:e.id,nonce:""};this.checkNonce&&(t.nonce=this.checkNonce),f["AjaxHelper"].post({module:"API",method:"JsTrackerInstallCheck.wasJsTrackerInstallTestSuccessful"},t).then(e=>{if(e&&e.mainUrl&&!this.baseUrl&&(this.baseUrl=e.mainUrl),this.isTestSuccess=e&&e.isSuccess,this.checkNonce&&!this.isTestSuccess&&this.testTimeoutCount<g)return this.testTimeoutCount+=1,void this.setCheckInTime();this.isTestComplete=!!this.checkNonce,this.isTesting=!1}).catch(()=>{this.isTesting=!1})}},computed:{getTestFailureMessage(){const e=Object(f["externalLink"])("https://matomo.org/faq/troubleshooting/faq_58/"),t="</a>";return this.isWordpress?Object(f["translate"])("JsTrackerInstallCheck_JsTrackingCodeInstallCheckFailureMessageWordpress",'<a target="_blank" rel="noreferrer noopener" href="https://wordpress.org/plugins/wp-piwik/">WP-Matomo Integration (WP-Piwik)</a>',e,t):Object(f["translate"])("JsTrackerInstallCheck_JsTrackingCodeInstallCheckFailureMessage",e,t)}}});j.render=b;var O=j;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 